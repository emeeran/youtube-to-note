# Contributing Guide

Thank you for your interest in contributing to YouTubeClipper! This guide will help you get started.

## Code of Conduct

- Be respectful and inclusive
- Provide constructive feedback
- Focus on the code, not the person
- Help others learn and grow

## How to Contribute

### Reporting Bugs

1. **Check existing issues** first to avoid duplicates
2. **Open a new issue** with:
   - Clear title describing the bug
   - Steps to reproduce
   - Expected behavior
   - Actual behavior
   - Screenshots if applicable
   - Your environment (OS, Obsidian version, plugin version)

**Good bug report example:**
```
Title: Custom prompt not persisting after modal close

Steps to reproduce:
1. Open plugin modal
2. Select "Custom" format
3. Enter text in custom prompt input
4. Close modal without processing

Expected: Custom prompt field remembers input on next open
Actual: Custom prompt field is empty

Environment: macOS 13.5, Obsidian 1.4.14, Plugin v1.3.0
```

### Suggesting Features

1. **Check discussions** for existing feature requests
2. **Open a new discussion** with:
   - Clear title
   - Use case/motivation
   - Proposed solution (optional)
   - Examples or mockups (if applicable)

**Good feature request example:**
```
Title: Support for batch processing multiple URLs

Use Case:
I have a list of 10 YouTube videos I want to process at once.
Currently I need to open the modal and paste each URL individually.

Proposed Solution:
Add a "Batch Process" mode that accepts:
- Text input with one URL per line
- File upload with URLs
- Auto-process all with selected format

Benefits:
- Save time for users with multiple videos
- Enable workflow automation
```

### Submitting Code Changes

#### Prerequisites
- Fork the repository
- Clone your fork
- Create a feature branch: `git checkout -b feature/your-feature-name`

#### Development Setup
```bash
npm install
npm run dev  # Start watch mode
```

#### Making Changes

1. **Create feature branch** from `main`:
   ```bash
   git checkout -b feature/add-custom-format
   ```

2. **Write code** following project conventions:
   - Use TypeScript with proper types
   - Follow naming conventions (see Developer Guide)
   - Add JSDoc comments for public APIs
   - Handle errors gracefully
   - Use existing utilities (`ErrorHandler`, `ValidationUtils`, etc.)

3. **Test your changes**:
   - Rebuild: `npm run build`
   - Copy to test vault
   - Test in Obsidian
   - Check browser console for errors

4. **Write commit messages** following convention:
   ```
   feat: add custom prompt session-only support
   ^--- Type: feat, fix, docs, style, refactor, test, chore
   
   Optionally add body with more details:
   - Custom prompts now stored in modal state
   - Not persisted to settings
   - Cleared after successful processing
   
   Closes #123
   ```

   **Types**:
   - `feat`: New feature
   - `fix`: Bug fix
   - `docs`: Documentation changes
   - `style`: Formatting (no logic changes)
   - `refactor`: Code reorganization
   - `test`: Test additions/changes
   - `chore`: Dependencies, tooling

5. **Push to your fork**:
   ```bash
   git push origin feature/add-custom-format
   ```

6. **Open a Pull Request**:
   - Go to original repo
   - Click "New Pull Request"
   - Select your feature branch
   - Fill in PR template:

```markdown
## Description
Brief summary of changes

## Type of Change
- [ ] Bug fix (non-breaking change fixing issue)
- [ ] New feature (non-breaking change adding feature)
- [ ] Breaking change (fix or feature causing existing functionality to change)
- [ ] Documentation update

## Related Issues
Closes #123

## Testing
Describe how you tested changes:
- [ ] Manual testing in Obsidian
- [ ] Tested with Gemini API
- [ ] Tested with Groq API
- [ ] Tested with custom prompts

## Checklist
- [ ] My code follows project style guidelines
- [ ] I've tested changes in Obsidian
- [ ] No new warnings generated by `npm run build`
- [ ] I've updated relevant documentation
- [ ] New/changed functionality has comments/docs
```

### Code Review Process

1. **Review checklist**:
   - Code quality and style
   - Tests and test coverage
   - Documentation completeness
   - Breaking changes
   - Performance implications

2. **Reviewer feedback**:
   - Constructive comments
   - Approval or request for changes
   - Merge when approved

3. **Your responsibility**:
   - Respond to feedback
   - Make requested changes
   - Re-request review after updates
   - Communicate if you disagree

## Development Best Practices

### Before Starting

1. Check recent discussions for planned features
2. Discuss major changes before coding
3. Verify no one else is working on the same feature

### While Coding

1. **Keep commits atomic**: One logical change per commit
2. **Write meaningful messages**: Future developers will thank you
3. **Don't mix concerns**: Don't refactor while adding features
4. **Test early**: Don't wait until the end
5. **Keep PRs focused**: One feature per PR if possible

### Common Issues & Solutions

| Issue | Solution |
|-------|----------|
| **PR has merge conflicts** | Rebase on latest main: `git rebase origin/main` |
| **TypeScript errors** | Run `npm run build` to see full error list |
| **Changes not showing** | Ensure dev watcher is running: `npm run dev` |
| **Plugin not loading** | Copy main.js and manifest.json, then reload Obsidian |
| **API key errors** | Verify key in settings and API quota in console |

## Areas for Contribution

### High Priority
- [ ] Additional AI providers (Claude, LLaMA, etc.)
- [ ] Batch processing of multiple videos
- [ ] Custom template system
- [ ] Performance improvements
- [ ] Mobile support enhancements

### Medium Priority
- [ ] Additional output formats
- [ ] Prompt customization UI improvements
- [ ] Caching strategy optimization
- [ ] More comprehensive error recovery
- [ ] Accessibility improvements

### Low Priority (Always Welcome)
- [ ] Documentation improvements
- [ ] Example projects
- [ ] Tutorial content
- [ ] Testing improvements
- [ ] Code style/refactoring

## Feature Implementation Checklist

Before submitting a feature PR, ensure:

- [ ] **Core functionality works** in isolated testing
- [ ] **TypeScript compiles** without errors: `npm run build`
- [ ] **Types are properly defined** in `src/interfaces/types.ts`
- [ ] **Error handling** follows `ErrorHandler` pattern
- [ ] **User-facing text** added to `src/constants/messages.ts`
- [ ] **UI components** follow existing patterns
- [ ] **Settings UI updated** if adding configuration
- [ ] **Services wired** through `ServiceContainer`
- [ ] **Tests written** (or at least E2E tested in Obsidian)
- [ ] **Documentation updated** or created
- [ ] **Commit message** follows convention
- [ ] **No console warnings** when building

## Bug Fix Checklist

Before submitting a bug fix PR:

- [ ] **Issue reproduced** following steps
- [ ] **Root cause identified** and documented
- [ ] **Fix is minimal** (don't refactor unrelated code)
- [ ] **Related edge cases** considered
- [ ] **Tests added** to prevent regression
- [ ] **Tested thoroughly** in multiple scenarios
- [ ] **Commit message** clearly explains the fix
- [ ] **Related issues linked** in commit

## Documentation Checklist

For documentation changes:

- [ ] **Clear and concise** language
- [ ] **Accurate** and up-to-date
- [ ] **Examples** for complex topics
- [ ] **Links** to related sections
- [ ] **Searchable keywords** in headings
- [ ] **Formatted consistently** with existing docs
- [ ] **Spell-checked**
- [ ] **Screenshots/diagrams** if helpful

## Style Guidelines

### TypeScript Style

```typescript
// âœ“ Good: Clear intent, proper types
async function processVideo(
  url: string,
  format: OutputFormat
): Promise<string> {
  const validation = ValidationUtils.validateYouTubeUrl(url);
  const metadata = await videoService.extractMetadata(url);
  return formatContent(metadata, format);
}

// âœ— Avoid: Unclear types, poor naming
async function process(u: any): Promise<any> {
  const v = validate(u);
  return doSomething(v);
}
```

### File Organization

- **One class per file** (except closely related utilities)
- **Related classes in subdirectories** (e.g., `/ai/` for providers)
- **Interfaces in separate file** or at top of primary class
- **Exports at end** of file

### Naming Conventions

| Item | Convention | Example |
|------|-----------|---------|
| Class | PascalCase | `YouTubeUrlModal` |
| File | kebab-case | `youtube-url-modal.ts` |
| Method | camelCase | `extractVideoId()` |
| Property | camelCase | `videoId` |
| Constant | UPPER_SNAKE_CASE | `API_TIMEOUT` |
| Interface | I-prefix or `Type` suffix | `IProvider` or `VideoDataType` |

### Comments & Documentation

```typescript
/**
 * Process a YouTube video and generate structured notes
 * 
 * @param url - Full YouTube URL (http/https)
 * @param format - Output format preference
 * @returns File path to created note
 * @throws Error if URL invalid or processing fails
 * 
 * @example
 * const filePath = await processVideo(
 *   'https://youtube.com/watch?v=abc123',
 *   'executive-summary'
 * );
 */
async function processVideo(
  url: string,
  format: OutputFormat
): Promise<string> {
  // Validate input
  if (!ValidationUtils.isValidYouTubeUrl(url)) {
    throw new Error(`Invalid URL: ${url}`);
  }

  // ... rest of implementation
}
```

## Testing

### Types of Tests

1. **Unit Tests**: Individual service/function testing
2. **Integration Tests**: Component interaction testing
3. **E2E Tests**: Full workflow in Obsidian

### Testing Requirements

- Bug fixes should include regression tests
- New features should have tests
- Aim for >80% code coverage
- Run tests before submitting PR

### Running Tests

```bash
npm test              # Run all tests
npm test -- --watch  # Watch mode
npm test -- --coverage  # Coverage report
```

## Communication

- **GitHub Issues**: Bug reports and feature requests
- **GitHub Discussions**: General questions and ideas
- **Obsidian Discord**: Community chat and support
- **Pull Request Comments**: Code review discussion

## Recognition

Contributors will be:
- Listed in `CONTRIBUTORS.md`
- Mentioned in release notes
- Given appropriate credit

## Questions?

- Check [Developer Guide](DEVELOPER_GUIDE.md)
- Review [Architecture](ARCHITECTURE.md)
- Look at existing code for examples
- Ask in GitHub Discussions

---

Happy coding! ðŸš€

