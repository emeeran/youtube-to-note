/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/styles.ts
var MODAL_STYLES, INPUT_STYLES;
var init_styles = __esm({
  "src/styles.ts"() {
    MODAL_STYLES = {
      zIndex: "10000",
      display: "flex",
      header: {
        marginBottom: "15px",
        color: "var(--text-accent)"
      },
      message: {
        marginBottom: "20px",
        lineHeight: "1.5"
      },
      buttonContainer: {
        marginTop: "20px",
        display: "flex",
        gap: "10px",
        justifyContent: "flex-end"
      },
      button: {
        padding: "8px 16px",
        minWidth: "100px"
      }
    };
    INPUT_STYLES = {
      width: "100%",
      marginTop: "8px",
      padding: "8px",
      border: "1px solid var(--background-modifier-border)",
      borderRadius: "4px"
    };
  }
});

// src/dom.ts
var DOMUtils;
var init_dom = __esm({
  "src/dom.ts"() {
    init_styles();
    DOMUtils = class {
      /**
       * Apply styles to an HTML element
       */
      static applyStyles(element, styles) {
        Object.assign(element.style, styles);
      }
      /**
       * Create a standardized button container
       */
      static createButtonContainer(parent) {
        const container = parent.createDiv();
        this.applyStyles(container, MODAL_STYLES.buttonContainer);
        return container;
      }
      /**
       * Create a styled button with consistent appearance
       */
      static createStyledButton(container, text, isPrimary = false, onClick) {
        const button = container.createEl("button", { text });
        if (isPrimary) {
          button.classList.add("mod-cta");
        }
        this.applyStyles(button, MODAL_STYLES.button);
        if (onClick) {
          button.addEventListener("click", onClick);
        }
        return button;
      }
      /**
       * Create a styled input field
       */
      static createStyledInput(container, type, placeholder, value = "") {
        const input = container.createEl("input", {
          type,
          placeholder,
          value
        });
        this.applyStyles(input, INPUT_STYLES);
        return input;
      }
      /**
       * Set up modal base styling for consistency
       */
      static setupModalStyling(modalEl) {
        this.applyStyles(modalEl, {
          zIndex: MODAL_STYLES.zIndex,
          display: MODAL_STYLES.display
        });
      }
      /**
       * Create a header element with consistent styling
       */
      static createModalHeader(parent, text) {
        const header = parent.createEl("h2", { text });
        this.applyStyles(header, MODAL_STYLES.header);
        return header;
      }
      /**
       * Create a message paragraph with consistent styling
       */
      static createModalMessage(parent, text) {
        const message = parent.createEl("p");
        message.setText(text);
        this.applyStyles(message, MODAL_STYLES.message);
        return message;
      }
      /**
       * Set up keyboard event handlers for modals
       */
      static setupModalKeyHandlers(element, onEnter, onEscape) {
        element.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            e.stopPropagation();
            onEnter();
          }
          if (e.key === "Escape" && onEscape) {
            e.preventDefault();
            e.stopPropagation();
            onEscape();
          }
        });
      }
      // Instance methods implementing interface
      applyStyles(element, styles) {
        DOMUtils.applyStyles(element, styles);
      }
      createButtonContainer(parent) {
        return DOMUtils.createButtonContainer(parent);
      }
      createStyledButton(container, text, isPrimary = false, onClick) {
        return DOMUtils.createStyledButton(container, text, isPrimary, onClick);
      }
    };
  }
});

// src/api.ts
var API_ENDPOINTS, AI_MODELS, PROVIDER_MODEL_OPTIONS, PROVIDER_MODEL_LIST_URLS, PROVIDER_MODEL_REGEX, API_LIMITS, TIMEOUTS;
var init_api = __esm({
  "src/api.ts"() {
    API_ENDPOINTS = {
      GEMINI: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent",
      GROQ: "https://api.groq.com/openai/v1/chat/completions",
      YOUTUBE_OEMBED: "https://www.youtube.com/oembed",
      CORS_PROXY: "https://api.allorigins.win/raw"
    };
    AI_MODELS = {
      GEMINI: "gemini-2.5-pro",
      // Set Gemini model to gemini-2.5-pro
      GROQ: "llama-3.3-70b-versatile"
    };
    PROVIDER_MODEL_OPTIONS = {
      "Google Gemini": [
        // Gemini 2.5 series (latest, all support multimodal video analysis)
        { name: "gemini-2.5-pro", supportsAudioVideo: true },
        { name: "gemini-2.5-pro-tts", supportsAudioVideo: true },
        { name: "gemini-2.5-flash", supportsAudioVideo: true },
        { name: "gemini-2.5-flash-lite", supportsAudioVideo: true },
        // Gemini 2.0 series (video support via native API, but no explicit multimodal flag)
        { name: "gemini-2.0-pro", supportsAudioVideo: true },
        { name: "gemini-2.0-flash" },
        { name: "gemini-2.0-flash-lite" },
        // Gemini 1.5 series (available, supports video via File API)
        { name: "gemini-1.5-pro" },
        { name: "gemini-1.5-flash" }
      ],
      "Groq": [
        // Latest models (Nov 2024 - Nov 2025)
        // Note: Groq models prioritize speed/text; for multimodal video, Gemini is recommended
        { name: "llama-4-maverick-17b-128e-instruct" },
        { name: "llama-4-scout-17b-16e-instruct" },
        // Llama 3.x series
        { name: "llama-3.3-70b-versatile" },
        { name: "llama-3.1-8b-instant" }
      ]
    };
    PROVIDER_MODEL_LIST_URLS = {
      "Google Gemini": "https://developers.generativeai.google/models",
      "Groq": "https://groq.com"
    };
    PROVIDER_MODEL_REGEX = {
      "Google Gemini": /gemini[-_\.]?\d+(?:\.\d+)?(?:-[a-z0-9\-]+)?/gi,
      "Groq": /llama[-_\.]?\d+(?:\.\d+)?(?:-[a-z0-9\-]+)?/gi
    };
    API_LIMITS = {
      MAX_TOKENS: 8e3,
      // Increased from 2000 to handle comprehensive tutorials
      TEMPERATURE: 0.7,
      DESCRIPTION_MAX_LENGTH: 1e3,
      TITLE_MAX_LENGTH: 100
    };
    TIMEOUTS = {
      FILE_CREATION_WAIT: 300,
      MODAL_DELAY: 100,
      FALLBACK_MODAL_CHECK: 500,
      FOCUS_DELAY: 150,
      REPAINT_DELAY: 50
    };
  }
});

// src/confirmation-modal.ts
var confirmation_modal_exports = {};
__export(confirmation_modal_exports, {
  ConfirmationModal: () => ConfirmationModal
});
var ConfirmationModal;
var init_confirmation_modal = __esm({
  "src/confirmation-modal.ts"() {
    init_base_modal();
    ConfirmationModal = class extends BaseModal {
      constructor(app, options) {
        super(app);
        this.options = options;
        this.result = false;
      }
      onOpen() {
        this.createModalContent();
        this.setupEventHandlers();
        this.focusConfirmButton();
      }
      /**
       * Create modal content with accessible structure
       */
      createModalContent() {
        const header = this.createHeader(this.options.title);
        header.setAttribute("id", "confirmation-modal-title");
        const messageContainer = this.contentEl.createDiv("confirmation-message");
        messageContainer.setAttribute("id", "confirmation-modal-description");
        messageContainer.textContent = this.options.message;
        const buttonContainer = this.createButtonContainer();
        buttonContainer.style.marginTop = "20px";
        const confirmText = this.options.confirmText || "Confirm";
        const cancelText = this.options.cancelText || "Cancel";
        const isDangerous = this.options.isDangerous || false;
        if (isDangerous) {
          this.cancelButton = this.createButton(
            buttonContainer,
            cancelText,
            false,
            () => this.handleCancel()
          );
          this.cancelButton.setAttribute("aria-label", `Cancel: ${cancelText}`);
          this.confirmButton = this.createButton(
            buttonContainer,
            confirmText,
            true,
            () => this.handleConfirm()
          );
          this.confirmButton.setAttribute("aria-label", `Confirm: ${confirmText}`);
        } else {
          this.confirmButton = this.createButton(
            buttonContainer,
            confirmText,
            true,
            () => this.handleConfirm()
          );
          this.confirmButton.setAttribute("aria-label", `Confirm: ${confirmText}`);
          this.cancelButton = this.createButton(
            buttonContainer,
            cancelText,
            false,
            () => this.handleCancel()
          );
          this.cancelButton.setAttribute("aria-label", `Cancel: ${cancelText}`);
        }
        this.contentEl.setAttribute("aria-labelledby", "confirmation-modal-title");
        this.contentEl.setAttribute("aria-describedby", "confirmation-modal-description");
        this.contentEl.setAttribute("role", "alertdialog");
      }
      /**
       * Set up keyboard event handlers (Enter to confirm, Escape to cancel)
       */
      setupEventHandlers() {
        this.scope.register([], "Enter", () => {
          this.handleConfirm();
          return false;
        });
        this.scope.register([], "Escape", () => {
          this.handleCancel();
          return false;
        });
      }
      /**
       * Focus the confirm button by default
       */
      focusConfirmButton() {
        if (this.confirmButton) {
          setTimeout(() => {
            this.confirmButton.focus();
          }, 50);
        }
      }
      /**
       * Handle confirmation (Confirm button or Enter key)
       */
      handleConfirm() {
        this.result = true;
        if (this.resolver) {
          this.resolver(true);
        }
        this.close();
      }
      /**
       * Handle cancellation (Cancel button or Escape key)
       */
      handleCancel() {
        this.result = false;
        if (this.resolver) {
          this.resolver(false);
        }
        this.close();
      }
      /**
       * Open modal and wait for user response
       * Returns promise that resolves to true if confirmed, false if cancelled
       */
      openAndWait() {
        return new Promise((resolve) => {
          this.resolver = resolve;
          this.open();
        });
      }
      /**
       * Get the result (synchronous if already closed)
       */
      getResult() {
        return this.result;
      }
    };
  }
});

// src/base-modal.ts
var import_obsidian3, MODAL_CSS_CLASSES, BaseModal;
var init_base_modal = __esm({
  "src/base-modal.ts"() {
    import_obsidian3 = require("obsidian");
    init_dom();
    init_styles();
    init_api();
    MODAL_CSS_CLASSES = {
      modal: "ytc-modal",
      header: "ytc-modal-header",
      content: "ytc-modal-content",
      button: "ytc-modal-button",
      input: "ytc-modal-input"
    };
    BaseModal = class extends import_obsidian3.Modal {
      constructor(app) {
        super(app);
        this.events = {};
        this.isDisposed = false;
        this.setupModalStyling();
        this.setupConflictPrevention();
      }
      /**
       * Set up base modal styling for consistency
       */
      setupModalStyling() {
        DOMUtils.setupModalStyling(this.modalEl);
        this.modalEl.addClass(MODAL_CSS_CLASSES.modal);
        this.contentEl.addClass(MODAL_CSS_CLASSES.content);
      }
      /**
       * Set up conflict prevention measures
       */
      setupConflictPrevention() {
        this.modalEl.setAttribute("data-plugin", "youtube-clipper");
        this.modalEl.style.zIndex = "9999";
      }
      /**
       * Create standardized modal header with conflict prevention
       */
      createHeader(text) {
        const header = DOMUtils.createModalHeader(this.contentEl, text);
        header.addClass(MODAL_CSS_CLASSES.header);
        return header;
      }
      /**
       * Create standardized modal message
       */
      createMessage(text) {
        return DOMUtils.createModalMessage(this.contentEl, text);
      }
      /**
       * Create standardized button container
       */
      createButtonContainer() {
        return DOMUtils.createButtonContainer(this.contentEl);
      }
      /**
      * Create standardized button with conflict prevention and accessibility
      */
      createButton(container, text, isPrimary = false, onClick) {
        const button = DOMUtils.createStyledButton(container, text, isPrimary, onClick);
        button.addClass(MODAL_CSS_CLASSES.button);
        button.setAttribute("data-plugin", "youtube-clipper");
        button.setAttribute("role", "button");
        if (!button.getAttribute("aria-label")) {
          button.setAttribute("aria-label", text);
        }
        return button;
      }
      /**
       * Create standardized input with conflict prevention and accessibility
       */
      createInput(container, type, placeholder) {
        const input = container.createEl("input", {
          type,
          placeholder
        });
        DOMUtils.applyStyles(input, INPUT_STYLES);
        input.addClass(MODAL_CSS_CLASSES.input);
        input.setAttribute("data-plugin", "youtube-clipper");
        if (placeholder) {
          input.setAttribute("aria-label", placeholder);
        }
        return input;
      }
      /**
       * Set up keyboard event handlers
       */
      setupKeyHandlers(onEnter, onEscape) {
        const wrappedOnEnter = async () => {
          try {
            await onEnter();
          } catch (error) {
            console.error("Enter key handler error:", error);
          }
        };
        const wrappedOnEscape = onEscape ? async () => {
          try {
            await onEscape();
          } catch (error) {
            console.error("Escape key handler error:", error);
          }
        } : void 0;
        DOMUtils.setupModalKeyHandlers(this.contentEl, wrappedOnEnter, wrappedOnEscape);
      }
      /**
       * Focus element with delay for better UX
       */
      focusElement(element, delay = TIMEOUTS.FOCUS_DELAY) {
        setTimeout(() => {
          element.focus();
        }, delay);
      }
      /**
       * Set up event handlers
       */
      setEvents(events) {
        this.events = events;
      }
      /**
       * Show custom styled confirmation dialog before closing
       * This uses our custom ConfirmationModal instead of the native browser confirm()
       * for better accessibility and UX.
       * 
       * Note: This is now synchronous for backwards compatibility with existing callers,
       * but returns a boolean immediately. For async confirmation with proper modal,
       * use showConfirmationModal() instead.
       */
      confirmClose(message) {
        return confirm(message);
      }
      /**
       * Show a custom accessible confirmation modal and wait for user response.
       * Preferred method for confirmation dialogs (async, fully accessible).
       */
      async showConfirmationModal(title, message, confirmText = "Confirm", cancelText = "Cancel", isDangerous = false) {
        const { ConfirmationModal: ConfirmationModal2 } = await Promise.resolve().then(() => (init_confirmation_modal(), confirmation_modal_exports));
        const modal = new ConfirmationModal2(this.app, {
          title,
          message,
          confirmText,
          cancelText,
          isDangerous
        });
        return modal.openAndWait();
      }
      /**
       * Force modal visibility (for stubborn modals)
       */
      forceVisible() {
        setTimeout(() => {
          DOMUtils.setupModalStyling(this.modalEl);
        }, TIMEOUTS.REPAINT_DELAY);
      }
      /**
       * Clean up on close with proper disposal
       */
      onClose() {
        if (this.isDisposed) {
          return;
        }
        console.log("[youtube-clipper] Cleaning up modal");
        this.isDisposed = true;
        const { contentEl } = this;
        contentEl.empty();
        this.modalEl.removeClass(MODAL_CSS_CLASSES.modal);
        this.modalEl.removeAttribute("data-plugin");
        console.log("[youtube-clipper] Modal cleanup complete");
      }
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => YoutubeClipperPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/conflict-prevention.ts
var ConflictPrevention = class {
  /**
   * Check if another plugin might be conflicting
   */
  static checkForPotentialConflicts() {
    const warnings = [];
    const suspiciousElements = [
      'div[data-plugin="web-clipper"]',
      ".web-clipper-modal",
      ".clipper-button",
      '[id*="clipper"]',
      '[class*="clip"]'
    ];
    suspiciousElements.forEach((selector) => {
      const elements = document.querySelectorAll(selector);
      if (elements.length > 0) {
        warnings.push(`Detected potential plugin conflict: ${selector}`);
      }
    });
    return warnings;
  }
  /**
   * Add conflict prevention attributes to an element
   */
  static markElement(element, type) {
    element.setAttribute("data-plugin", this.PLUGIN_ID);
    element.setAttribute("data-ytc-type", type);
    element.addClass(`${this.CSS_PREFIX}-${type}`);
  }
  /**
   * Remove conflict prevention attributes
   */
  static unmarkElement(element) {
    element.removeAttribute("data-plugin");
    element.removeAttribute("data-ytc-type");
    const classes = Array.from(element.classList);
    classes.forEach((className) => {
      if (className.startsWith(this.CSS_PREFIX)) {
        element.removeClass(className);
      }
    });
  }
  /**
   * Create a namespaced ID to prevent conflicts
   */
  static createUniqueId(base) {
    return `${this.CSS_PREFIX}-${base}-${Date.now()}`;
  }
  /**
   * Clean up all plugin elements from DOM
   */
  static cleanupAllElements() {
    const elements = document.querySelectorAll(`[data-plugin="${this.PLUGIN_ID}"]`);
    elements.forEach((element) => {
      if (element instanceof HTMLElement) {
        this.unmarkElement(element);
      }
    });
  }
  /**
   * Get safe storage key with namespace
   */
  static getStorageKey(key) {
    return `${this.PLUGIN_ID}-${key}`;
  }
  /**
   * Log plugin activity with namespace
   */
  static log(message, level = "info") {
    const timestamp = new Date().toISOString();
    const logMessage = `[${this.PLUGIN_ID}] ${timestamp} - ${message}`;
    switch (level) {
      case "warn":
        console.warn(logMessage);
        break;
      case "error":
        console.error(logMessage);
        break;
      default:
        console.log(logMessage);
    }
  }
  /**
   * Check if plugin is safe to operate
   */
  static isSafeToOperate() {
    const conflicts = this.checkForPotentialConflicts();
    if (conflicts.length > 0) {
      this.log(`Potential conflicts detected: ${conflicts.join(", ")}`, "warn");
      return false;
    }
    return true;
  }
  /**
   * Wrap async operations with conflict checking
   */
  static async safeOperation(operation, operationName) {
    if (!this.isSafeToOperate()) {
      this.log(`Skipping ${operationName} due to potential conflicts`, "warn");
      return null;
    }
    try {
      this.log(`Starting ${operationName}`);
      const result = await operation();
      this.log(`Completed ${operationName}`);
      return result;
    } catch (error) {
      this.log(`Error in ${operationName}: ${error}`, "error");
      throw error;
    }
  }
};
ConflictPrevention.PLUGIN_ID = "youtube-clipper";
ConflictPrevention.CSS_PREFIX = "ytc";

// src/messages.ts
var MESSAGES = {
  PROCESSING: "Processing YouTube video...",
  SUCCESS: (title) => `Successfully processed: ${title}`,
  OPENED_FILE: (filename) => `Opened: ${filename}`,
  ERRORS: {
    INVALID_URL: "Invalid YouTube URL. Please provide a valid YouTube video URL (e.g., https://www.youtube.com/watch?v=VIDEO_ID)",
    MISSING_API_KEYS: "No valid Gemini or Groq API key configured. Please set one in plugin settings.",
    GEMINI_INVALID_KEY: "Gemini API key is invalid or missing. Please check your key.",
    GROQ_MODEL_NOT_FOUND: "Groq API error: Model not found or you do not have access. Please check your API key and model name.",
    FETCH_VIDEO_DATA: (status) => `Failed to fetch video metadata: ${status}`,
    SAVE_FILE: (message) => `Failed to save file: ${message}`,
    AI_PROCESSING: (message) => `AI processing failed: ${message}`,
    FILE_NOT_EXISTS: "File no longer exists",
    COULD_NOT_OPEN: (message) => `Could not open file: ${message}`,
    ENTER_URL: "Please enter a YouTube URL",
    VIDEO_ID_EXTRACTION: "Could not extract video ID from URL. Please check the URL format.",
    NETWORK_ERROR: "Network error occurred. Please check your internet connection and try again."
  },
  WARNINGS: {
    CORS_RESTRICTIONS: "Description not available due to CORS restrictions",
    EXTRACTION_FAILED: "Description extraction failed",
    AUTO_EXTRACTION: "Video description could not be extracted automatically."
  },
  MODALS: {
    YOUTUBE_PROCESSED: "YouTube Video Processed",
    CONFIRM_OPEN: (filename) => `Successfully processed YouTube video and saved as "${filename}". Would you like to open the note now?`,
    CLOSE_CONFIRMATION: "Close without opening the note?",
    PROCESS_VIDEO: "Process YouTube Video",
    YES_OPEN: "Yes, open note",
    NO_THANKS: "No, thanks",
    CANCEL: "Cancel",
    PROCESS: "Process"
  },
  PLACEHOLDERS: {
    YOUTUBE_URL: "https://www.youtube.com/watch?v=...",
    GEMINI_KEY: "AIza...",
    GROQ_KEY: "gsk_...",
    OUTPUT_PATH: "YouTube/Processed Videos"
  }
};

// src/validation.ts
var ValidationUtils = class {
  /**
   * Clean and normalize YouTube URL
   */
  static cleanYouTubeUrl(url) {
    if (!url || typeof url !== "string") {
      return "";
    }
    let cleanUrl = url.trim();
    cleanUrl = cleanUrl.replace(/[\u200B-\u200D\uFEFF]/g, "");
    if (!cleanUrl.startsWith("http://") && !cleanUrl.startsWith("https://")) {
      cleanUrl = "https://" + cleanUrl;
    }
    if (cleanUrl.startsWith("http://youtube.com") || cleanUrl.startsWith("http://www.youtube.com")) {
      cleanUrl = cleanUrl.replace("http://", "https://");
    }
    return cleanUrl;
  }
  /**
   * Extract YouTube video ID from URL (memoized for performance)
   * Enhanced extraction with better error handling
   */
  static extractVideoId(url) {
    if (!url || typeof url !== "string")
      return null;
    if (this.URL_CACHE.has(url)) {
      return this.URL_CACHE.get(url);
    }
    const cleanUrl = this.cleanYouTubeUrl(url);
    let result = null;
    let match = cleanUrl.match(this.URL_PATTERNS[0]);
    if ((match == null ? void 0 : match[1]) && this.VIDEO_ID_REGEX.test(match[1])) {
      result = match[1];
    } else {
      for (let i = 1; i < this.URL_PATTERNS.length && !result; i++) {
        match = cleanUrl.match(this.URL_PATTERNS[i]);
        if ((match == null ? void 0 : match[1]) && this.VIDEO_ID_REGEX.test(match[1])) {
          result = match[1];
        }
      }
    }
    if (this.URL_CACHE.size > 100) {
      this.URL_CACHE.clear();
    }
    this.URL_CACHE.set(url, result);
    if (!result) {
      console.warn("Failed to extract video ID from URL:", url);
    }
    return result;
  }
  /**
   * Validate YouTube URL format
   */
  static isValidYouTubeUrl(url) {
    return this.extractVideoId(url) !== null;
  }
  /**
   * Sanitize filename for file system compatibility
   */
  static sanitizeFilename(filename, maxLength = 100) {
    return filename.replace(/[<>:"/\\|?*]/g, "").replace(/\s+/g, " ").trim().substring(0, maxLength);
  }
  /**
   * Validate API key format
   */
  static isValidAPIKey(key, provider) {
    if (!key || typeof key !== "string") {
      return false;
    }
    switch (provider) {
      case "gemini":
        return key.startsWith("AIza") && key.length > 10;
      case "groq":
        return key.startsWith("gsk_") && key.length > 10;
      default:
        return false;
    }
  }
  /**
   * Validate settings configuration
   */
  static validateSettings(settings) {
    const errors = [];
    const usingEnv = Boolean(settings.useEnvironmentVariables);
    const hasDirectKey = this.isNonEmptyString(settings.geminiApiKey) || this.isNonEmptyString(settings.groqApiKey);
    if (!hasDirectKey && !usingEnv) {
      errors.push(MESSAGES.ERRORS.MISSING_API_KEYS);
    }
    if (this.isNonEmptyString(settings.geminiApiKey) && !this.isValidAPIKey(settings.geminiApiKey, "gemini")) {
      errors.push("Invalid Gemini API key format");
    }
    if (this.isNonEmptyString(settings.groqApiKey) && !this.isValidAPIKey(settings.groqApiKey, "groq")) {
      errors.push("Invalid Groq API key format");
    }
    if (usingEnv && !this.isNonEmptyString(settings.environmentPrefix)) {
      errors.push("Environment variable prefix is required when using environment variables");
    }
    if (!settings.outputPath || typeof settings.outputPath !== "string") {
      errors.push("Output path is required");
    }
    return {
      isValid: errors.length === 0,
      errors
    };
  }
  /**
   * Validate file path
   */
  static isValidPath(path) {
    return typeof path === "string" && path.trim().length > 0;
  }
  /**
   * Validate that a string is not empty
   */
  static isNonEmptyString(value) {
    return typeof value === "string" && value.trim().length > 0;
  }
  /**
   * Truncate text to specified length with ellipsis
   */
  static truncateText(text, maxLength) {
    if (text.length <= maxLength) {
      return text;
    }
    return text.substring(0, maxLength - 3) + "...";
  }
  /**
   * Clean HTML entities and escape sequences from text
   */
  static cleanText(text) {
    return text.replace(/\\n/g, "\n").replace(/\\"/g, '"').replace(/\\'/g, "'").replace(
      /\\u([0-9a-fA-F]{4})/g,
      (match, code) => String.fromCharCode(parseInt(code, 16))
    );
  }
};
/**
 * YouTube URL patterns for validation (ordered by frequency for performance)
 * Enhanced patterns to handle various YouTube URL formats
 */
ValidationUtils.URL_PATTERNS = [
  // Standard youtube.com/watch?v= format (most common)
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})(?:&.*)?$/,
  // youtu.be short format (second most common)
  /(?:https?:\/\/)?(?:www\.)?youtu\.be\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // youtube.com/embed format
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/embed\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // youtube.com/v format
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/v\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // Mobile youtube.com format
  /(?:https?:\/\/)?(?:m\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})(?:&.*)?$/
];
// Memoized regex for video ID validation (hot path optimization)
ValidationUtils.VIDEO_ID_REGEX = /^[a-zA-Z0-9_-]{11}$/;
ValidationUtils.URL_CACHE = /* @__PURE__ */ new Map();

// src/services/error-handler.ts
var import_obsidian = require("obsidian");
var ErrorHandler = class {
  /**
   * Handle errors with consistent logging and user feedback
   */
  static handle(error, context, showNotice = true) {
    const errorMessage = `${context}: ${error.message}`;
    console.error(errorMessage, error);
    if (showNotice) {
      new import_obsidian.Notice(`Error: ${error.message}`);
    }
  }
  /**
   * Execute an operation with automatic error handling
   */
  static async withErrorHandling(operation, context, showNotice = true) {
    try {
      return await operation();
    } catch (error) {
      this.handle(error, context, showNotice);
      return null;
    }
  }
  /**
   * Execute a synchronous operation with error handling
   */
  static withSyncErrorHandling(operation, context, showNotice = true) {
    try {
      return operation();
    } catch (error) {
      this.handle(error, context, showNotice);
      return null;
    }
  }
  /**
   * Create a standardized error for API responses
   */
  static createAPIError(provider, status, statusText, details) {
    const message = `${provider} API error: ${status} ${statusText}${details ? `. ${details}` : ""}`;
    return new Error(message);
  }
  /**
   * Handle API response errors with consistent format
   */
  static async handleAPIError(response, provider, fallbackMessage) {
    var _a;
    let errorDetails = fallbackMessage || "";
    try {
      const errorData = await response.json();
      errorDetails = ((_a = errorData.error) == null ? void 0 : _a.message) || errorData.message || fallbackMessage || "";
    } catch (e) {
    }
    throw this.createAPIError(provider, response.status, response.statusText, errorDetails);
  }
  /**
   * Validate required configuration and throw descriptive errors
   */
  static validateConfiguration(config, requiredFields) {
    const missing = requiredFields.filter((field) => !config[field]);
    if (missing.length > 0) {
      throw new Error(`Missing required configuration: ${missing.join(", ")}`);
    }
  }
  /**
   * Create a user-friendly error message for common scenarios
   */
  static createUserFriendlyError(error, operation) {
    const message = `Failed to ${operation}: ${error.message}`;
    return new Error(message);
  }
  // Instance methods implementing interface
  handle(error, context, showNotice = true) {
    ErrorHandler.handle(error, context, showNotice);
  }
  async withErrorHandling(operation, context) {
    return ErrorHandler.withErrorHandling(operation, context);
  }
};

// src/save-confirmation-modal.ts
var import_obsidian2 = require("obsidian");
var SaveConfirmationModal = class extends import_obsidian2.Modal {
  constructor(app, file, onConfirm) {
    super(app);
    this.file = file;
    this.onConfirm = onConfirm;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    try {
      contentEl.createEl("h2", { text: "Note created successfully. Open now?" });
      const buttonContainer = contentEl.createDiv("save-confirmation-buttons");
      new import_obsidian2.Setting(buttonContainer).addButton((btn) => btn.setButtonText("Open Note").setCta().onClick(() => {
        this.close();
        this.onConfirm(true);
      })).addButton((btn) => btn.setButtonText("Dismiss").onClick(() => {
        this.close();
        this.onConfirm(false);
      }));
      setTimeout(() => {
        const openButton = buttonContainer.querySelector("button");
        if (openButton) {
          openButton.focus();
        }
      }, 100);
    } catch (error) {
      console.error("[SaveConfirmationModal] Error in onOpen:", error);
      contentEl.createEl("h2", { text: "File Saved" });
      contentEl.createEl("p", { text: `File "${this.file.name}" has been saved successfully.` });
      contentEl.createEl("button", { text: "OK" }).onclick = () => this.close();
    }
  }
  /**
   * Get human-readable file size
   */
  getFileSize() {
    try {
      const stat = this.app.vault.adapter.stat(this.file.path);
      if (stat && typeof stat === "object" && "size" in stat) {
        const bytes = stat.size;
        if (bytes < 1024)
          return `${bytes} bytes`;
        if (bytes < 1024 * 1024)
          return `${(bytes / 1024).toFixed(1)} KB`;
        return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;
      }
    } catch (error) {
    }
    return "";
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  /**
   * Add custom styles for the modal
   */
  addStyles() {
    var _a;
    const { contentEl } = this;
    contentEl.addClass("ytp-save-confirmation-modal");
    const style = document.createElement("style");
    style.textContent = `
            .ytp-save-confirmation-modal {
                min-width: 450px;
                max-width: 650px;
            }
            
            .save-confirmation-message {
                margin: 20px 0 30px 0;
                text-align: left;
                line-height: 1.6;
            }
            
            .save-confirmation-filename {
                font-weight: bold;
                font-size: 1.1em;
                margin-bottom: 15px;
                color: var(--text-accent);
                text-align: center;
            }
            
            .save-confirmation-location-container,
            .save-confirmation-size-container {
                margin-bottom: 10px;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            
            .save-confirmation-location {
                font-family: var(--font-monospace);
                background: var(--background-secondary);
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.9em;
                word-break: break-all;
                color: var(--text-muted);
                flex: 1;
            }
            
            .save-confirmation-size {
                font-family: var(--font-monospace);
                background: var(--background-modifier-success);
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.9em;
                color: var(--text-on-accent);
            }
            
            .save-confirmation-buttons {
                text-align: center;
                margin-top: 20px;
                display: flex;
                justify-content: center;
                gap: 15px;
            }
            
            .save-confirmation-buttons .setting-item {
                border: none;
                padding: 0;
                margin: 0;
                display: flex;
                gap: 10px;
            }
            
            .save-confirmation-buttons button {
                min-width: 100px;
                padding: 8px 20px;
                font-size: 1em;
            }
            
            .save-confirmation-buttons button:first-child {
                /* Open File button - primary action */
                background-color: var(--interactive-accent);
                color: var(--text-on-accent);
            }
            
            .save-confirmation-buttons button:last-child {
                /* OK button - secondary action */
                background-color: var(--background-modifier-border);
                color: var(--text-normal);
            }
        `;
    document.head.appendChild(style);
    (_a = this.modalEl) == null ? void 0 : _a.setAttribute("data-style-id", "ytp-save-confirmation-style");
  }
};

// src/youtube-url-modal.ts
var import_obsidian4 = require("obsidian");
init_base_modal();
init_api();
var YouTubeUrlModal = class extends BaseModal {
  constructor(app, options) {
    super(app);
    this.options = options;
    this.url = "";
    this.format = "executive-summary";
    this.fetchInProgress = false;
    this.progressSteps = [];
    this.currentStepIndex = 0;
    this.isProcessing = false;
    // Performance settings
    this.performanceMode = "balanced";
    this.enableParallelProcessing = false;
    this.preferMultimodal = false;
    this.url = options.initialUrl || "";
    this.performanceMode = options.performanceMode || "balanced";
    this.enableParallelProcessing = options.enableParallelProcessing || false;
    this.preferMultimodal = options.preferMultimodal || false;
  }
  onOpen() {
    this.createModalContent();
    this.setupEventHandlers();
    if (this.options.initialUrl) {
      if (this.url.trim() === this.options.initialUrl.trim()) {
        console.debug("YouTubeUrlModal: Same URL already set, preventing cycle");
      } else {
        this.setUrl(this.options.initialUrl);
      }
      this.updateProcessButtonState();
      const isValid = ValidationUtils.isValidYouTubeUrl((this.options.initialUrl || "").trim());
      if (isValid && this.processButton) {
        this.processButton.focus();
        return;
      }
    }
    this.focusUrlInput();
  }
  /**
   * Create modal content
   */
  createModalContent() {
    this.headerEl = this.createHeader(MESSAGES.MODALS.PROCESS_VIDEO);
    this.createUrlInputSection();
    this.createPerformanceSection();
    this.createFormatSelectionSection();
    this.createProviderSelectionSection();
    this.createProgressSection();
    this.createActionButtons();
  }
  /**
   * Create compact performance and speed settings section
   */
  createPerformanceSection() {
    const container = this.contentEl.createDiv();
    container.className = "ytc-performance-section";
    container.style.marginTop = "12px";
    container.style.padding = "10px";
    container.style.backgroundColor = "var(--background-secondary)";
    container.style.borderRadius = "6px";
    container.style.border = "1px solid var(--interactive-accent)";
    const headerContainer = container.createDiv();
    headerContainer.style.display = "flex";
    headerContainer.style.alignItems = "center";
    headerContainer.style.justifyContent = "space-between";
    headerContainer.style.marginBottom = "10px";
    const sectionHeader = headerContainer.createEl("h3");
    sectionHeader.textContent = "\u26A1 Performance";
    sectionHeader.style.margin = "0";
    sectionHeader.style.fontSize = "0.9rem";
    sectionHeader.style.fontWeight = "600";
    sectionHeader.style.color = "var(--text-accent)";
    sectionHeader.style.display = "flex";
    sectionHeader.style.alignItems = "center";
    sectionHeader.style.gap = "6px";
    const modeContainer = container.createDiv();
    modeContainer.style.marginBottom = "8px";
    this.performanceModeSelect = modeContainer.createEl("select");
    this.performanceModeSelect.style.width = "100%";
    this.performanceModeSelect.style.padding = "6px 8px";
    this.performanceModeSelect.style.borderRadius = "4px";
    this.performanceModeSelect.style.border = "1px solid var(--background-modifier-border)";
    this.performanceModeSelect.style.backgroundColor = "var(--background-primary)";
    this.performanceModeSelect.style.color = "var(--text-normal)";
    this.performanceModeSelect.style.fontSize = "0.85rem";
    this.performanceModeSelect.style.cursor = "pointer";
    const fastOption = this.performanceModeSelect.createEl("option");
    fastOption.value = "fast";
    fastOption.textContent = "\u26A1 Fast (10-30s)";
    const balancedOption = this.performanceModeSelect.createEl("option");
    balancedOption.value = "balanced";
    balancedOption.textContent = "\u2696\uFE0F Balanced (30-60s)";
    const qualityOption = this.performanceModeSelect.createEl("option");
    qualityOption.value = "quality";
    qualityOption.textContent = "\u{1F3AF} Quality (60-120s)";
    this.performanceModeSelect.value = this.performanceMode;
    this.performanceModeSelect.addEventListener("change", () => {
      this.performanceMode = this.performanceModeSelect.value;
      this.handlePerformanceSettingsChange();
    });
    const togglesContainer = container.createDiv();
    togglesContainer.style.display = "flex";
    togglesContainer.style.gap = "16px";
    togglesContainer.style.marginTop = "6px";
    const parallelContainer = togglesContainer.createDiv();
    const parallelLabel = parallelContainer.createEl("label");
    parallelLabel.style.display = "flex";
    parallelLabel.style.alignItems = "center";
    parallelLabel.style.gap = "4px";
    parallelLabel.style.fontSize = "0.8rem";
    parallelLabel.style.cursor = "pointer";
    parallelLabel.style.color = "var(--text-normal)";
    const parallelToggle = parallelLabel.createEl("input");
    parallelToggle.type = "checkbox";
    parallelToggle.id = "parallel-toggle";
    parallelToggle.checked = this.enableParallelProcessing;
    parallelToggle.addEventListener("change", () => {
      this.enableParallelProcessing = parallelToggle.checked;
      this.handlePerformanceSettingsChange();
    });
    parallelLabel.appendChild(document.createTextNode("\u{1F504} Parallel"));
    parallelContainer.appendChild(parallelLabel);
    const multimodalContainer = togglesContainer.createDiv();
    const multimodalLabel = multimodalContainer.createEl("label");
    multimodalLabel.style.display = "flex";
    multimodalLabel.style.alignItems = "center";
    multimodalLabel.style.gap = "4px";
    multimodalLabel.style.fontSize = "0.8rem";
    multimodalLabel.style.cursor = "pointer";
    multimodalLabel.style.color = "var(--text-normal)";
    const multimodalToggle = multimodalLabel.createEl("input");
    multimodalToggle.type = "checkbox";
    multimodalToggle.id = "multimodal-toggle";
    multimodalToggle.checked = this.preferMultimodal;
    multimodalToggle.addEventListener("change", () => {
      this.preferMultimodal = multimodalToggle.checked;
      this.handlePerformanceSettingsChange();
    });
    multimodalLabel.appendChild(document.createTextNode("\u{1F3A5} Multimodal"));
    multimodalContainer.appendChild(multimodalLabel);
  }
  /**
   * Create enhanced performance toggle component
   */
  createPerformanceToggle(container, id, icon, label, checked, onChange, description) {
    const toggleContainer = container.createDiv();
    toggleContainer.style.padding = "12px";
    toggleContainer.style.backgroundColor = "var(--background-primary)";
    toggleContainer.style.borderRadius = "6px";
    toggleContainer.style.border = "1px solid var(--background-modifier-border)";
    toggleContainer.style.transition = "all 0.2s ease";
    toggleContainer.style.cursor = "pointer";
    const toggleHeader = toggleContainer.createDiv();
    toggleHeader.style.display = "flex";
    toggleHeader.style.alignItems = "center";
    toggleHeader.style.justifyContent = "space-between";
    toggleHeader.style.marginBottom = "4px";
    const labelContainer = toggleHeader.createEl("div");
    labelContainer.style.display = "flex";
    labelContainer.style.alignItems = "center";
    labelContainer.style.gap = "8px";
    const iconSpan = labelContainer.createEl("span");
    iconSpan.textContent = icon;
    iconSpan.style.fontSize = "1rem";
    const labelText = labelContainer.createEl("span");
    labelText.textContent = label;
    labelText.style.fontWeight = "500";
    labelText.style.color = "var(--text-normal)";
    const toggle = toggleContainer.createEl("input");
    toggle.type = "checkbox";
    toggle.id = id;
    toggle.checked = checked;
    toggle.style.width = "20px";
    toggle.style.height = "20px";
    toggle.style.cursor = "pointer";
    const descriptionText = toggleContainer.createEl("div");
    descriptionText.textContent = description;
    descriptionText.style.fontSize = "0.8rem";
    descriptionText.style.color = "var(--text-muted)";
    descriptionText.style.marginTop = "4px";
    descriptionText.style.lineHeight = "1.3";
    toggleContainer.addEventListener("mouseenter", () => {
      toggleContainer.style.backgroundColor = "var(--background-modifier-hover)";
      toggleContainer.style.borderColor = "var(--interactive-accent)";
      toggleContainer.style.transform = "translateY(-2px)";
      toggleContainer.style.boxShadow = "0 4px 12px rgba(0,0,0,0.1)";
    });
    toggleContainer.addEventListener("mouseleave", () => {
      toggleContainer.style.backgroundColor = "var(--background-primary)";
      toggleContainer.style.borderColor = "var(--background-modifier-border)";
      toggleContainer.style.transform = "translateY(0)";
      toggleContainer.style.boxShadow = "none";
    });
    toggle.addEventListener("change", () => onChange(toggle.checked));
  }
  /**
   * Add performance preview with mode descriptions
   */
  addPerformancePreview(container) {
    const previewContainer = container.createDiv();
    previewContainer.style.marginTop = "16px";
    previewContainer.style.padding = "12px";
    previewContainer.style.backgroundColor = "var(--background-modifier-hover)";
    previewContainer.style.borderRadius = "6px";
    previewContainer.style.border = "1px dashed var(--interactive-accent)";
    const previewTitle = previewContainer.createEl("div");
    previewTitle.textContent = "\u{1F4CB} Current Configuration";
    previewTitle.style.fontWeight = "600";
    previewTitle.style.marginBottom = "8px";
    previewTitle.style.color = "var(--text-accent)";
    const previewText = previewContainer.createEl("div");
    previewText.className = "ytc-performance-preview";
    previewText.style.fontSize = "0.85rem";
    previewText.style.lineHeight = "1.4";
    previewText.style.color = "var(--text-muted)";
    this.updatePerformancePreview(previewText);
  }
  /**
   * Update performance preview text
   */
  updatePerformancePreview(previewElement) {
    const modeText = this.performanceMode === "fast" ? "\u26A1 Fast Mode" : this.performanceMode === "balanced" ? "\u2696\uFE0F Balanced Mode" : "\u{1F3AF} Quality Mode";
    const parallelText = this.enableParallelProcessing ? "\u{1F504} Enabled" : "\u23F8\uFE0F Disabled";
    const multimodalText = this.preferMultimodal ? "\u{1F3A5} Enabled" : "\u{1F4C4} Text Only";
    previewElement.innerHTML = `
            <strong>Mode:</strong> ${modeText}<br>
            <strong>Parallel Processing:</strong> ${parallelText}<br>
            <strong>Multimodal Analysis:</strong> ${multimodalText}
        `;
  }
  /**
   * Add subtle animation when performance mode changes
   */
  addPerformanceModeAnimation() {
    const previewElement = document.querySelector(".ytc-performance-preview");
    if (previewElement) {
      previewElement.style.transition = "all 0.3s ease";
      previewElement.style.transform = "scale(1.02)";
      setTimeout(() => {
        previewElement.style.transform = "scale(1)";
      }, 200);
    }
  }
  /**
   * Handle performance settings change
   */
  async handlePerformanceSettingsChange() {
    if (this.options.onPerformanceSettingsChange) {
      await this.options.onPerformanceSettingsChange(
        this.performanceMode,
        this.enableParallelProcessing,
        this.preferMultimodal
      );
    }
  }
  createProviderSelectionSection() {
    const container = this.contentEl.createDiv();
    container.style.marginTop = "10px";
    const label = container.createEl("label", { text: "AI Provider & Model:" });
    label.setAttribute("for", "ytc-provider-select");
    const row = container.createDiv();
    row.style.display = "flex";
    row.style.gap = "8px";
    row.style.alignItems = "center";
    this.providerSelect = document.createElement("select");
    this.providerSelect.id = "ytc-provider-select";
    this.providerSelect.setAttribute("aria-label", "AI Provider");
    this.providerSelect.style.flex = "1";
    this.providerSelect.style.padding = "6px";
    this.providerSelect.style.borderRadius = "6px";
    this.providerSelect.style.border = "1px solid var(--background-modifier-border)";
    row.appendChild(this.providerSelect);
    this.modelSelect = document.createElement("select");
    this.modelSelect.id = "ytc-model-select";
    this.modelSelect.setAttribute("aria-label", "AI Model");
    this.modelSelect.style.width = "220px";
    this.modelSelect.style.padding = "6px";
    this.modelSelect.style.borderRadius = "6px";
    this.modelSelect.style.border = "1px solid var(--background-modifier-border)";
    row.appendChild(this.modelSelect);
    const providers = this.options.providers || [];
    const modelOptions = this.options.modelOptions || {};
    const autoOpt = document.createElement("option");
    autoOpt.value = "";
    autoOpt.text = "Auto (fallback)";
    this.providerSelect.appendChild(autoOpt);
    providers.forEach((p) => {
      const opt = document.createElement("option");
      opt.value = p;
      opt.text = p;
      this.providerSelect.appendChild(opt);
    });
    const refreshBtn = this.createInlineButton(row, "Refresh models", () => {
      void this.handleRefreshModels();
    });
    this.refreshSpinner = document.createElement("span");
    this.refreshSpinner.style.display = "none";
    this.refreshSpinner.style.marginLeft = "8px";
    this.refreshSpinner.style.width = "16px";
    this.refreshSpinner.style.height = "16px";
    this.refreshSpinner.style.border = "2px solid var(--background-modifier-border)";
    this.refreshSpinner.style.borderTop = "2px solid var(--interactive-accent)";
    this.refreshSpinner.style.borderRadius = "50%";
    this.refreshSpinner.style.animation = "ytp-spin 1s linear infinite";
    row.appendChild(this.refreshSpinner);
    this.providerSelect.addEventListener("change", () => {
      this.selectedProvider = this.providerSelect.value || void 0;
      this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
    });
    if (this.options.defaultProvider) {
      this.providerSelect.value = this.options.defaultProvider;
      this.selectedProvider = this.options.defaultProvider;
    }
    this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
  }
  async handleRefreshModels() {
    if (!this.options.fetchModels) {
      this.setValidationMessage("Model refresh not available.", "error");
      return;
    }
    this.setValidationMessage("Refreshing model lists\u2026", "info");
    if (this.refreshSpinner)
      this.refreshSpinner.style.display = "inline-block";
    try {
      const map = await this.options.fetchModels();
      const providers = Object.keys(map);
      if (this.providerSelect) {
        const current = this.providerSelect.value;
        this.providerSelect.innerHTML = "";
        const autoOpt = document.createElement("option");
        autoOpt.value = "";
        autoOpt.text = "Auto (fallback)";
        this.providerSelect.appendChild(autoOpt);
        providers.forEach((p) => {
          const opt = document.createElement("option");
          opt.value = p;
          opt.text = p;
          this.providerSelect.appendChild(opt);
        });
        if (current && Array.from(this.providerSelect.options).some((o) => o.value === current)) {
          this.providerSelect.value = current;
          this.selectedProvider = current;
        }
      }
      const modelOptions = map;
      this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
      this.setValidationMessage("Model lists refreshed.", "success");
    } catch (error) {
      this.setValidationMessage("Failed to refresh models. Using cached options.", "error");
    } finally {
      if (this.refreshSpinner)
        this.refreshSpinner.style.display = "none";
    }
  }
  populateModelsForProvider(providerName, modelOptions, defaultModel) {
    if (!this.modelSelect)
      return;
    this.modelSelect.innerHTML = "";
    const models = modelOptions[providerName] || [];
    if (models.length === 0) {
      const opt = document.createElement("option");
      opt.value = "";
      opt.text = "Default model";
      this.modelSelect.appendChild(opt);
      this.selectedModel = "";
      return;
    }
    models.forEach((m) => {
      const opt = document.createElement("option");
      opt.value = m;
      let label = m;
      try {
        const providerModels = PROVIDER_MODEL_OPTIONS[providerName] || [];
        const match = providerModels.find((pm) => {
          const name = typeof pm === "string" ? pm : pm && pm.name ? pm.name : "";
          return String(name).toLowerCase() === String(m).toLowerCase();
        });
        if (match && match.supportsAudioVideo) {
          label = `${m}  \u{1F3A5}`;
          opt.title = "Supports multimodal audio/video tokens";
        }
      } catch (err) {
      }
      opt.text = label;
      this.modelSelect.appendChild(opt);
    });
    if (defaultModel && models.includes(defaultModel)) {
      this.modelSelect.value = defaultModel;
      this.selectedModel = defaultModel;
    } else {
      this.modelSelect.selectedIndex = 0;
      this.selectedModel = this.modelSelect.value;
    }
    this.modelSelect.addEventListener("change", () => {
      this.selectedModel = this.modelSelect.value;
    });
  }
  /**
   * Create URL input section
   */
  createUrlInputSection() {
    const container = this.contentEl.createDiv();
    const label = container.createEl("label", { text: "YouTube URL:" });
    label.setAttribute("for", "ytc-url-input");
    const inputRow = container.createDiv();
    inputRow.style.display = "flex";
    inputRow.style.gap = "8px";
    inputRow.style.alignItems = "center";
    this.urlInput = this.createInput(
      inputRow,
      "url",
      MESSAGES.PLACEHOLDERS.YOUTUBE_URL + " (Press Enter to process)"
    );
    this.urlInput.id = "ytc-url-input";
    this.urlInput.setAttribute("aria-label", "YouTube URL");
    this.urlInput.setAttribute("aria-describedby", "ytc-url-hint");
    this.urlInput.style.flex = "1";
    this.urlInput.style.transition = "border-color 0.2s ease, box-shadow 0.2s ease";
    this.pasteButton = this.createInlineButton(inputRow, "Paste", () => {
      void this.handlePasteFromClipboard();
    });
    this.pasteButton.setAttribute("aria-label", "Paste YouTube URL from clipboard");
    this.clearButton = this.createInlineButton(inputRow, "Clear", () => {
      this.handleClearUrl();
    });
    this.clearButton.setAttribute("aria-label", "Clear YouTube URL input");
    if (this.options.initialUrl) {
      this.urlInput.value = this.options.initialUrl;
      this.url = this.options.initialUrl;
    }
    this.urlInput.addEventListener("input", (e) => {
      this.url = e.target.value;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
    });
    this.validationMessage = container.createDiv();
    this.validationMessage.id = "ytc-url-hint";
    this.validationMessage.style.marginTop = "6px";
    this.validationMessage.style.fontSize = "0.85rem";
    this.validationMessage.style.color = "var(--text-muted)";
    this.validationMessage.setAttribute("role", "status");
    this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
    const preview = container.createDiv();
    preview.style.display = "flex";
    preview.style.gap = "8px";
    preview.style.alignItems = "center";
    preview.style.marginTop = "6px";
    this.thumbnailEl = preview.createEl("img");
    this.thumbnailEl.setAttribute("aria-label", "Video thumbnail");
    this.thumbnailEl.style.width = "90px";
    this.thumbnailEl.style.height = "50px";
    this.thumbnailEl.style.objectFit = "cover";
    this.thumbnailEl.style.borderRadius = "4px";
    this.thumbnailEl.style.display = "none";
    this.metadataContainer = preview.createDiv();
    this.metadataContainer.setAttribute("aria-label", "Video metadata");
    this.metadataContainer.style.display = "none";
    this.metadataContainer.style.fontSize = "0.9rem";
    this.metadataContainer.style.color = "var(--text-normal)";
    this.metadataContainer.createDiv({ cls: "yt-preview-title" });
    this.metadataContainer.createDiv({ cls: "yt-preview-channel" });
    this.setUrlInputState("idle");
    this.updateQuickActionsState();
  }
  /**
   * Create compact format selection section
   */
  createFormatSelectionSection() {
    const container = this.contentEl.createDiv();
    container.className = "ytc-format-section";
    container.style.marginTop = "12px";
    container.style.padding = "8px";
    container.style.backgroundColor = "var(--background-secondary)";
    container.style.borderRadius = "6px";
    container.style.border = "1px solid var(--background-modifier-border)";
    const label = container.createEl("label", { text: "\u{1F4DD} Format" });
    label.id = "format-group-label";
    label.style.display = "block";
    label.style.marginBottom = "8px";
    label.style.fontSize = "0.9rem";
    label.style.fontWeight = "600";
    label.style.color = "var(--text-normal)";
    const radioContainer = container.createDiv();
    radioContainer.setAttribute("role", "group");
    radioContainer.setAttribute("aria-labelledby", "format-group-label");
    radioContainer.style.display = "grid";
    radioContainer.style.gridTemplateColumns = "repeat(4, 1fr)";
    radioContainer.style.gap = "8px";
    try {
      this.createCompactFormatRadio(radioContainer, "executive-radio", "executive-summary", "Executive", "", this.format === "executive-summary");
      this.createCompactFormatRadio(radioContainer, "tutorial-radio", "detailed-guide", "Tutorial", "", this.format === "detailed-guide");
      this.createCompactFormatRadio(radioContainer, "brief-radio", "brief", "Brief", "", this.format === "brief");
      this.createCompactFormatRadio(radioContainer, "custom-radio", "custom", "Custom", "", this.format === "custom");
    } catch (error) {
      console.error("Error creating compact format radio buttons:", error);
      this.createFormatRadio(radioContainer, "executive-radio", "executive-summary", "Executive", "Quick insights with action items", this.format === "executive-summary");
      this.createFormatRadio(radioContainer, "tutorial-radio", "detailed-guide", "Tutorial", "\u{1F4DA} Step-by-step walkthrough", this.format === "detailed-guide");
      this.createFormatRadio(radioContainer, "brief-radio", "brief", "Brief", "\u{1F4CB} Key points and takeaways", this.format === "brief");
      this.createFormatRadio(radioContainer, "custom-radio", "custom", "Custom", "\u270F\uFE0F Your custom analysis", this.format === "custom");
    }
    this.customPromptContainer = container.createDiv();
    this.customPromptContainer.style.marginTop = "12px";
    this.customPromptContainer.style.padding = "12px";
    this.customPromptContainer.style.backgroundColor = "var(--background-modifier-hover)";
    this.customPromptContainer.style.borderRadius = "4px";
    this.customPromptContainer.style.display = "none";
    const customPromptLabel = this.customPromptContainer.createEl("label", {
      text: "Custom Prompt (this session only):"
    });
    customPromptLabel.setAttribute("for", "custom-prompt-input");
    customPromptLabel.style.display = "block";
    customPromptLabel.style.marginBottom = "6px";
    customPromptLabel.style.fontWeight = "600";
    customPromptLabel.style.fontSize = "0.95rem";
    this.customPromptInput = this.customPromptContainer.createEl("textarea");
    this.customPromptInput.id = "custom-prompt-input";
    this.customPromptInput.setAttribute("aria-label", "Custom AI prompt");
    this.customPromptInput.setAttribute("placeholder", "Enter your custom prompt here. Available placeholders: __VIDEO_TITLE__, __VIDEO_DESCRIPTION__, __VIDEO_URL__");
    this.customPromptInput.style.width = "100%";
    this.customPromptInput.style.height = "100px";
    this.customPromptInput.style.padding = "8px";
    this.customPromptInput.style.fontFamily = "monospace";
    this.customPromptInput.style.fontSize = "12px";
    this.customPromptInput.style.border = "1px solid var(--background-modifier-border)";
    this.customPromptInput.style.borderRadius = "4px";
    this.customPromptInput.style.resize = "vertical";
    this.customPromptInput.style.marginBottom = "6px";
    const helpText = this.customPromptContainer.createEl("small");
    helpText.textContent = "Placeholders: __VIDEO_TITLE__, __VIDEO_DESCRIPTION__, __VIDEO_URL__, __VIDEO_ID__, __EMBED_URL__, __DATE__, __TIMESTAMP__";
    helpText.style.display = "block";
    helpText.style.marginTop = "4px";
    helpText.style.color = "var(--text-muted)";
    helpText.style.fontSize = "11px";
  }
  /**
   * Create enhanced format radio button
   */
  createFormatRadio(container, id, value, title, description, isChecked) {
    const radioContainer = container.createDiv();
    radioContainer.style.padding = "12px";
    radioContainer.style.border = "2px solid var(--background-modifier-border)";
    radioContainer.style.borderRadius = "8px";
    radioContainer.style.backgroundColor = "var(--background-primary)";
    radioContainer.style.cursor = "pointer";
    radioContainer.style.transition = "all 0.2s ease";
    radioContainer.style.textAlign = "center";
    const radio = radioContainer.createEl("input");
    radio.type = "radio";
    radio.name = "outputFormat";
    radio.value = value;
    radio.id = id;
    radio.checked = isChecked;
    radio.style.marginBottom = "8px";
    const icon = radioContainer.createEl("div");
    icon.style.fontSize = "1.5rem";
    icon.style.marginBottom = "4px";
    if (value === "executive-summary") {
      icon.textContent = "\u{1F3AF}";
    } else if (value === "detailed-guide") {
      icon.textContent = "\u{1F4DA}";
    } else if (value === "brief") {
      icon.textContent = "\u{1F4CB}";
    } else if (value === "custom") {
      icon.textContent = "\u270F\uFE0F";
    }
    const titleElement = radioContainer.createEl("div");
    titleElement.textContent = title;
    titleElement.style.fontWeight = "600";
    titleElement.style.fontSize = "0.9rem";
    titleElement.style.marginBottom = "2px";
    const descElement = radioContainer.createEl("div");
    descElement.textContent = description;
    descElement.style.fontSize = "0.75rem";
    descElement.style.color = "var(--text-muted)";
    if (isChecked) {
      radioContainer.style.borderColor = "var(--interactive-accent)";
      radioContainer.style.backgroundColor = "var(--interactive-accent-hover)";
    }
    radioContainer.addEventListener("mouseenter", () => {
      radioContainer.style.borderColor = "var(--interactive-accent)";
      radioContainer.style.transform = "translateY(-2px)";
      radioContainer.style.boxShadow = "0 4px 12px rgba(0,0,0,0.1)";
    });
    radioContainer.addEventListener("mouseleave", () => {
      if (!radio.checked) {
        radioContainer.style.borderColor = "var(--background-modifier-border)";
        radioContainer.style.transform = "translateY(0)";
        radioContainer.style.boxShadow = "none";
      }
    });
    radio.addEventListener("change", (e) => {
      var _a;
      if (e.target.checked) {
        this.format = value;
        const allContainers = container.querySelectorAll("div");
        allContainers.forEach((containerEl) => {
          const divEl = containerEl;
          divEl.style.borderColor = "var(--background-modifier-border)";
          divEl.style.backgroundColor = "var(--background-primary)";
        });
        radioContainer.style.borderColor = "var(--interactive-accent)";
        radioContainer.style.backgroundColor = "var(--interactive-accent-hover)";
        if (this.customPromptContainer) {
          if (value === "custom") {
            this.customPromptContainer.style.display = "block";
            (_a = this.customPromptInput) == null ? void 0 : _a.focus();
          } else {
            this.customPromptContainer.style.display = "none";
          }
        }
      }
    });
    radioContainer.addEventListener("click", () => {
      radio.checked = true;
      radio.dispatchEvent(new Event("change"));
    });
  }
  /**
   * Create compact format radio button
   */
  createCompactFormatRadio(container, id, value, title, icon, isChecked) {
    const radioContainer = container.createDiv();
    radioContainer.style.padding = "8px 4px";
    radioContainer.style.border = "1px solid var(--background-modifier-border)";
    radioContainer.style.borderRadius = "4px";
    radioContainer.style.backgroundColor = "var(--background-primary)";
    radioContainer.style.cursor = "pointer";
    radioContainer.style.transition = "all 0.2s ease";
    radioContainer.style.textAlign = "center";
    const radio = radioContainer.createEl("input");
    radio.type = "radio";
    radio.name = "outputFormat";
    radio.value = value;
    radio.id = id;
    radio.checked = isChecked;
    radio.style.marginBottom = "4px";
    if (icon) {
      const iconEl = radioContainer.createEl("div");
      iconEl.textContent = icon;
      iconEl.style.fontSize = "1.2rem";
      iconEl.style.marginBottom = "2px";
    }
    const titleElement = radioContainer.createEl("div");
    titleElement.textContent = title;
    titleElement.style.fontWeight = "500";
    titleElement.style.fontSize = "0.8rem";
    if (isChecked) {
      radioContainer.style.borderColor = "var(--interactive-accent)";
      radioContainer.style.backgroundColor = "var(--interactive-accent-hover)";
    }
    radioContainer.addEventListener("mouseenter", () => {
      radioContainer.style.borderColor = "var(--interactive-accent)";
      radioContainer.style.transform = "translateY(-1px)";
    });
    radioContainer.addEventListener("mouseleave", () => {
      if (!radio.checked) {
        radioContainer.style.borderColor = "var(--background-modifier-border)";
        radioContainer.style.transform = "translateY(0)";
      }
    });
    radio.addEventListener("change", (e) => {
      var _a;
      if (e.target.checked) {
        this.format = value;
        const allContainers = container.querySelectorAll("div");
        allContainers.forEach((containerEl) => {
          const divEl = containerEl;
          divEl.style.borderColor = "var(--background-modifier-border)";
          divEl.style.backgroundColor = "var(--background-primary)";
        });
        radioContainer.style.borderColor = "var(--interactive-accent)";
        radioContainer.style.backgroundColor = "var(--interactive-accent-hover)";
        if (this.customPromptContainer) {
          if (value === "custom") {
            this.customPromptContainer.style.display = "block";
            (_a = this.customPromptInput) == null ? void 0 : _a.focus();
          } else {
            this.customPromptContainer.style.display = "none";
          }
        }
      }
    });
    radioContainer.addEventListener("click", () => {
      radio.checked = true;
      radio.dispatchEvent(new Event("change"));
    });
  }
  /**
   * Create progress section
   */
  createProgressSection() {
    if (this.progressContainer) {
      this.progressContainer.remove();
      this.progressSteps = [];
    }
    this.progressContainer = this.contentEl.createDiv();
    this.progressContainer.setAttribute("role", "region");
    this.progressContainer.setAttribute("aria-label", "Processing progress");
    this.progressContainer.setAttribute("aria-live", "polite");
    this.progressContainer.style.marginTop = "16px";
    this.progressContainer.style.display = "none";
    this.progressText = this.progressContainer.createDiv();
    this.progressText.id = "progress-text";
    this.progressText.style.marginBottom = "8px";
    this.progressText.style.fontWeight = "500";
    this.progressText.style.color = "var(--text-accent)";
    this.progressText.textContent = "Processing video...";
    const progressBarContainer = this.progressContainer.createDiv();
    progressBarContainer.setAttribute("role", "progressbar");
    progressBarContainer.setAttribute("aria-valuenow", "0");
    progressBarContainer.setAttribute("aria-valuemin", "0");
    progressBarContainer.setAttribute("aria-valuemax", "100");
    progressBarContainer.setAttribute("aria-labelledby", "progress-text");
    progressBarContainer.style.width = "100%";
    progressBarContainer.style.height = "6px";
    progressBarContainer.style.backgroundColor = "var(--background-modifier-border)";
    progressBarContainer.style.borderRadius = "3px";
    progressBarContainer.style.overflow = "hidden";
    this.progressBar = progressBarContainer.createDiv();
    this.progressBar.style.height = "100%";
    this.progressBar.style.backgroundColor = "var(--text-accent)";
    this.progressBar.style.borderRadius = "3px";
    this.progressBar.style.width = "0%";
    this.progressBar.style.transition = "width 0.3s ease";
    const stepList = this.progressContainer.createEl("ol");
    stepList.setAttribute("aria-label", "Processing steps");
    stepList.style.marginTop = "12px";
    stepList.style.paddingLeft = "20px";
    stepList.style.fontSize = "0.9rem";
    stepList.style.color = "var(--text-normal)";
    const labels = [
      "Validate URL",
      "Fetch video info",
      "Run AI analysis",
      "Save note"
    ];
    this.progressSteps = labels.map((label, index) => {
      const item = stepList.createEl("li");
      item.setAttribute("role", "status");
      item.style.marginBottom = "4px";
      item.textContent = `\u25CB ${label}`;
      return { label, element: item };
    });
  }
  /**
   * Create action buttons with accessibility
   */
  createActionButtons() {
    const container = this.createButtonContainer();
    const cancelBtn = this.createButton(
      container,
      MESSAGES.MODALS.CANCEL,
      false,
      () => this.close()
    );
    cancelBtn.setAttribute("aria-label", "Cancel video processing");
    this.processButton = this.createButton(
      container,
      MESSAGES.MODALS.PROCESS,
      true,
      () => this.handleProcess()
    );
    this.processButton.setAttribute("aria-label", "Process YouTube video");
    this.openButton = this.createButton(
      container,
      "Open Note",
      true,
      () => this.handleOpenFile()
    );
    this.openButton.setAttribute("aria-label", "Open the processed note");
    this.openButton.style.display = "none";
    this.updateProcessButtonState();
  }
  /**
   * Set up event handlers
   */
  setupEventHandlers() {
    this.setupKeyHandlers(
      () => this.handleProcess(),
      () => this.close()
    );
  }
  /**
   * Focus on URL input
   */
  focusUrlInput() {
    if (this.urlInput) {
      this.focusElement(this.urlInput);
    }
  }
  /**
   * Update process button enabled state (optimized with debouncing and memoization)
   */
  updateProcessButtonState() {
    if (!this.processButton)
      return;
    if (this.isProcessing) {
      return;
    }
    const trimmedUrl = this.url.trim();
    if (this.processButton && this.processButton.textContent !== MESSAGES.MODALS.PROCESS && trimmedUrl.length >= 0) {
      this.processButton.textContent = MESSAGES.MODALS.PROCESS;
    }
    if (trimmedUrl === this.lastValidUrl) {
      const isValid = this.lastValidResult;
      this.processButton.disabled = !isValid;
      this.processButton.style.opacity = isValid ? "1" : "0.5";
      if (trimmedUrl.length === 0) {
        this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
        this.setUrlInputState("idle");
      } else {
        this.setValidationMessage(
          isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
          isValid ? "success" : "error"
        );
        this.setUrlInputState(isValid ? "valid" : "invalid");
      }
      this.updateQuickActionsState();
      return;
    }
    if (this.validationTimer) {
      clearTimeout(this.validationTimer);
    }
    this.validationTimer = window.setTimeout(() => {
      const isValid = ValidationUtils.isValidYouTubeUrl(trimmedUrl);
      this.lastValidUrl = trimmedUrl;
      this.lastValidResult = isValid;
      this.processButton.disabled = !isValid;
      this.processButton.style.opacity = isValid ? "1" : "0.5";
      if (trimmedUrl.length === 0) {
        this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
        this.setUrlInputState("idle");
      } else {
        this.setValidationMessage(
          isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
          isValid ? "success" : "error"
        );
        this.setUrlInputState(isValid ? "valid" : "invalid");
      }
      this.updateQuickActionsState();
      if (isValid) {
        void this.maybeFetchPreview(trimmedUrl);
      } else {
        this.clearPreview();
      }
    }, 300);
  }
  /**
   * Validate URL input (simplified - used by debounced handler)
   */
  isUrlValid() {
    return ValidationUtils.isValidYouTubeUrl(this.url.trim());
  }
  /**
   * Handle process button click
   */
  async handleProcess() {
    var _a;
    const trimmedUrl = this.url.trim();
    if (!trimmedUrl) {
      new import_obsidian4.Notice(MESSAGES.ERRORS.ENTER_URL);
      this.focusUrlInput();
      return;
    }
    if (!this.isUrlValid()) {
      new import_obsidian4.Notice(MESSAGES.ERRORS.INVALID_URL);
      this.focusUrlInput();
      return;
    }
    try {
      if (this.selectedProvider === "Google Gemini" && this.selectedModel && this.isUrlValid()) {
        try {
          const models = PROVIDER_MODEL_OPTIONS["Google Gemini"] || [];
          const match = models.find((m) => {
            const name = typeof m === "string" ? m : m && m.name ? m.name : "";
            return String(name).toLowerCase() === String(this.selectedModel || "").toLowerCase();
          });
          const supportsAudioVideo = !!(match && match.supportsAudioVideo);
          if (!supportsAudioVideo) {
            const recommended = (models.find((m) => m && m.supportsAudioVideo) || { name: AI_MODELS.GEMINI }).name;
            const shouldSwitch = await this.showConfirmationModal(
              "Multimodal Model Recommended",
              `The selected model (${this.selectedModel}) may not support multimodal analysis.

Would you like to switch to a multimodal-capable model (${recommended}) for better video analysis?`,
              "Switch to Multimodal",
              "Keep Current Model",
              false
            );
            if (shouldSwitch) {
              if (this.modelSelect) {
                const exists = Array.from(this.modelSelect.options).some((o) => o.value === recommended);
                if (!exists) {
                  const opt = document.createElement("option");
                  opt.value = recommended;
                  opt.text = recommended;
                  this.modelSelect.appendChild(opt);
                }
                this.modelSelect.value = recommended;
                this.selectedModel = recommended;
              } else {
                this.selectedModel = recommended;
              }
            }
          }
        } catch (err) {
          console.warn("[YouTubeUrlModal] model recommendation failed", err);
        }
      }
      this.showProcessingState();
      this.setStepState(0, "active");
      this.updateProgress(20, "Validating YouTube URL...");
      await new Promise((resolve) => setTimeout(resolve, 500));
      this.setStepState(0, "complete");
      this.setStepState(1, "active");
      this.updateProgress(40, "Extracting video data...");
      await new Promise((resolve) => setTimeout(resolve, 500));
      this.setStepState(1, "complete");
      this.setStepState(2, "active");
      this.updateProgress(60, "Analyzing video content...");
      const customPrompt = this.format === "custom" ? (_a = this.customPromptInput) == null ? void 0 : _a.value : void 0;
      const filePath = await this.options.onProcess(
        trimmedUrl,
        this.format,
        this.selectedProvider,
        this.selectedModel,
        customPrompt,
        this.performanceMode,
        this.enableParallelProcessing,
        this.preferMultimodal
      );
      this.setStepState(2, "complete");
      this.setStepState(3, "active");
      this.updateProgress(80, "Generating note...");
      await new Promise((resolve) => setTimeout(resolve, 300));
      this.updateProgress(100, "Complete!");
      this.setStepState(3, "complete");
      this.processedFilePath = filePath;
      this.showCompletionState();
    } catch (error) {
      this.flagActiveStepAsError();
      this.showErrorState(error);
      ErrorHandler.handle(error, "YouTube URL processing");
    }
  }
  /**
   * Handle open file button click
   */
  async handleOpenFile() {
    if (this.processedFilePath && this.options.onOpenFile) {
      try {
        await this.options.onOpenFile(this.processedFilePath);
        this.close();
      } catch (error) {
        ErrorHandler.handle(error, "Opening file");
      }
    }
  }
  /**
   * Show processing state
   */
  showProcessingState() {
    this.isProcessing = true;
    this.setValidationMessage("Processing video. This may take a moment...", "info");
    this.resetProgressSteps();
    if (this.progressContainer) {
      this.progressContainer.style.display = "block";
    }
    if (this.urlInput) {
      this.urlInput.disabled = true;
    }
    if (this.processButton) {
      this.processButton.disabled = true;
      this.processButton.textContent = "Processing...";
    }
    if (this.openButton) {
      this.openButton.style.display = "none";
    }
    this.setUrlInputState("idle");
    this.updateQuickActionsState();
  }
  /**
   * Show completion state
   */
  showCompletionState() {
    this.isProcessing = false;
    if (this.progressContainer) {
      this.progressContainer.style.display = "none";
    }
    if (this.urlInput) {
      this.urlInput.disabled = false;
      this.urlInput.value = "";
      this.url = "";
    }
    if (this.processButton) {
      this.processButton.disabled = false;
      this.processButton.textContent = "Process Another";
      this.processButton.style.display = "inline-block";
      this.processButton.style.opacity = "1";
    }
    if (this.openButton) {
      this.openButton.style.display = "inline-block";
    }
    if (this.headerEl) {
      this.headerEl.textContent = "\u2705 Video Processed Successfully!";
    }
    this.setValidationMessage("Note saved to today's folder. You can open it now or process another video.", "success");
    this.focusUrlInput();
    this.updateQuickActionsState();
    this.setUrlInputState("idle");
  }
  /**
   * Show error state
   */
  showErrorState(error) {
    this.isProcessing = false;
    if (this.progressContainer) {
      this.progressContainer.style.display = "none";
    }
    if (this.urlInput) {
      this.urlInput.disabled = false;
    }
    if (this.processButton) {
      this.processButton.disabled = false;
      this.processButton.textContent = MESSAGES.MODALS.PROCESS;
      this.processButton.style.display = "inline-block";
    }
    if (this.openButton) {
      this.openButton.style.display = "none";
    }
    if (this.headerEl) {
      this.headerEl.textContent = "\u274C Processing Failed";
    }
    this.setValidationMessage(error.message, "error");
    this.updateQuickActionsState();
    this.setUrlInputState(this.url.trim().length > 0 ? "invalid" : "idle");
  }
  /**
   * Update progress bar and text
   */
  updateProgress(percent, text) {
    if (this.progressBar) {
      this.progressBar.style.width = `${percent}%`;
    }
    if (this.progressText) {
      this.progressText.textContent = text;
    }
  }
  /**
   * Set initial URL value
   */
  setUrl(url) {
    if (this.url.trim() === url.trim()) {
      console.debug("YouTubeUrlModal: setUrl called with same URL, preventing cycle");
      return;
    }
    this.url = url;
    if (this.urlInput) {
      this.urlInput.value = url;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
      const trimmed = url.trim();
      if (trimmed.length === 0) {
        this.setUrlInputState("idle");
      } else {
        this.setUrlInputState(ValidationUtils.isValidYouTubeUrl(trimmed) ? "valid" : "invalid");
      }
    }
  }
  /**
   * Clean up resources when modal is closed
   */
  onClose() {
    if (this.validationTimer) {
      clearTimeout(this.validationTimer);
      this.validationTimer = void 0;
    }
    if (this.progressContainer) {
      this.progressContainer.remove();
      this.progressContainer = void 0;
    }
    this.progressSteps = [];
    super.onClose();
  }
  /**
   * Get current URL value
   */
  getUrl() {
    return this.url;
  }
  resetProgressSteps() {
    this.currentStepIndex = 0;
    if (this.progressSteps.length === 0) {
      return;
    }
    this.progressSteps.forEach((step) => {
      step.element.textContent = `\u25CB ${step.label}`;
    });
  }
  setStepState(index, state) {
    const target = this.progressSteps[index];
    if (!target) {
      return;
    }
    const prefix = this.getStepPrefix(state);
    target.element.textContent = `${prefix} ${target.label}`;
    if (state === "active") {
      this.currentStepIndex = index;
    } else if (state === "complete" && this.currentStepIndex === index) {
      this.currentStepIndex = Math.min(index + 1, this.progressSteps.length - 1);
    }
  }
  flagActiveStepAsError() {
    if (this.progressSteps.length === 0) {
      return;
    }
    this.setStepState(this.currentStepIndex, "error");
  }
  getStepPrefix(state) {
    switch (state) {
      case "active":
        return "\u25CF";
      case "complete":
        return "\u2714";
      case "error":
        return "\u26A0";
      default:
        return "\u25CB";
    }
  }
  createInlineButton(container, label, onClick) {
    const button = container.createEl("button", { text: label });
    button.style.padding = "6px 12px";
    button.style.fontSize = "0.85rem";
    button.style.borderRadius = "6px";
    button.style.border = "1px solid var(--background-modifier-border)";
    button.style.backgroundColor = "var(--background-primary)";
    button.style.color = "var(--text-normal)";
    button.style.cursor = "pointer";
    button.style.transition = "background-color 0.2s ease";
    button.addEventListener("mouseenter", () => {
      button.style.backgroundColor = "var(--background-modifier-hover)";
    });
    button.addEventListener("mouseleave", () => {
      button.style.backgroundColor = "var(--background-primary)";
    });
    button.addEventListener("click", onClick);
    return button;
  }
  async handlePasteFromClipboard() {
    if (this.isProcessing) {
      return;
    }
    if (!navigator.clipboard || !navigator.clipboard.readText) {
      this.setValidationMessage("Clipboard access is not available in this environment.", "error");
      new import_obsidian4.Notice("Clipboard access is not available.");
      return;
    }
    try {
      const text = await navigator.clipboard.readText();
      if (!text) {
        this.setValidationMessage("Clipboard is empty. Copy a YouTube URL first.", "info");
        return;
      }
      const trimmed = text.trim();
      this.url = trimmed;
      if (this.urlInput) {
        this.urlInput.value = trimmed;
      }
      this.lastValidUrl = void 0;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
      const isValid = ValidationUtils.isValidYouTubeUrl(trimmed);
      this.setValidationMessage(
        isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
        isValid ? "success" : "error"
      );
      this.setUrlInputState(isValid ? "valid" : "invalid");
      if (this.processButton && !this.isProcessing && isValid) {
        this.processButton.focus();
      } else {
        this.focusUrlInput();
      }
    } catch (error) {
      ErrorHandler.handle(error, "Reading clipboard", false);
      this.setValidationMessage("Could not read from clipboard. Paste manually instead.", "error");
      new import_obsidian4.Notice("Could not read from clipboard.");
    }
  }
  handleClearUrl() {
    if (this.isProcessing) {
      return;
    }
    this.url = "";
    if (this.urlInput) {
      this.urlInput.value = "";
    }
    this.lastValidUrl = void 0;
    this.updateProcessButtonState();
    this.updateQuickActionsState();
    this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
    this.setUrlInputState("idle");
    this.focusUrlInput();
  }
  updateQuickActionsState() {
    const hasUrl = this.url.trim().length > 0;
    if (this.clearButton) {
      this.clearButton.disabled = !hasUrl || this.isProcessing;
      this.clearButton.style.opacity = this.clearButton.disabled ? "0.5" : "1";
    }
    if (this.pasteButton) {
      this.pasteButton.disabled = this.isProcessing;
      this.pasteButton.style.opacity = this.pasteButton.disabled ? "0.5" : "1";
    }
  }
  setUrlInputState(state) {
    if (!this.urlInput) {
      return;
    }
    let borderColor = "var(--background-modifier-border)";
    let boxShadow = "none";
    if (state === "valid") {
      borderColor = "var(--text-accent)";
      boxShadow = "0 0 0 1px var(--text-accent)";
    } else if (state === "invalid") {
      borderColor = "var(--text-error)";
      boxShadow = "0 0 0 1px var(--text-error)";
    }
    this.urlInput.style.borderColor = borderColor;
    this.urlInput.style.boxShadow = boxShadow;
  }
  setValidationMessage(message, type) {
    if (!this.validationMessage) {
      return;
    }
    this.validationMessage.textContent = message;
    let color = "var(--text-muted)";
    if (type === "error") {
      color = "var(--text-error)";
    } else if (type === "success") {
      color = "var(--text-accent)";
    } else {
      color = "var(--text-muted)";
    }
    this.validationMessage.style.color = color;
  }
  /**
   * Try to fetch a lightweight preview for the provided YouTube URL using oEmbed.
   */
  async maybeFetchPreview(url) {
    if (this.fetchInProgress)
      return;
    if (!url)
      return;
    if (this.lastValidUrl === url && this.thumbnailEl && this.thumbnailEl.style.display === "block") {
      return;
    }
    this.setFetchingState(true);
    try {
      const meta = await this.fetchVideoPreview(url);
      if (meta) {
        this.showPreview(meta);
      } else {
        this.clearPreview();
      }
    } catch (error) {
      this.clearPreview();
    } finally {
      this.setFetchingState(false);
    }
  }
  setFetchingState(isFetching) {
    var _a;
    this.fetchInProgress = isFetching;
    if (this.processButton) {
      this.processButton.disabled = isFetching || !((_a = this.lastValidResult) != null ? _a : false);
      this.processButton.style.opacity = this.processButton.disabled ? "0.5" : "1";
    }
    if (this.validationMessage) {
      if (isFetching)
        this.setValidationMessage("Fetching preview...", "info");
      else if (this.lastValidResult)
        this.setValidationMessage("Ready to process this video.", "success");
      else
        this.setValidationMessage("Enter a valid YouTube video URL.", "error");
    }
  }
  async fetchVideoPreview(url) {
    try {
      const oembed = `https://www.youtube.com/oembed?url=${encodeURIComponent(url)}&format=json`;
      const res = await fetch(oembed);
      if (!res.ok)
        return null;
      const data = await res.json();
      return {
        title: data.title || "",
        author: data.author_name || "",
        thumbnail: data.thumbnail_url || ""
      };
    } catch (error) {
      return null;
    }
  }
  showPreview(meta) {
    if (!this.thumbnailEl || !this.metadataContainer)
      return;
    if (meta.thumbnail) {
      this.thumbnailEl.src = meta.thumbnail;
      this.thumbnailEl.style.display = "block";
    } else {
      this.thumbnailEl.style.display = "none";
    }
    const titleEl = this.metadataContainer.querySelector(".yt-preview-title");
    const channelEl = this.metadataContainer.querySelector(".yt-preview-channel");
    if (titleEl) {
      titleEl.textContent = meta.title;
      titleEl.style.fontWeight = "600";
      titleEl.style.marginBottom = "4px";
    }
    if (channelEl) {
      channelEl.textContent = meta.author;
      channelEl.style.color = "var(--text-muted)";
      channelEl.style.fontSize = "0.85rem";
    }
    this.metadataContainer.style.display = "block";
  }
  clearPreview() {
    if (this.thumbnailEl) {
      this.thumbnailEl.src = "";
      this.thumbnailEl.style.display = "none";
    }
    if (this.metadataContainer) {
      const titleEl = this.metadataContainer.querySelector(".yt-preview-title");
      const channelEl = this.metadataContainer.querySelector(".yt-preview-channel");
      if (titleEl)
        titleEl.textContent = "";
      if (channelEl)
        channelEl.textContent = "";
      this.metadataContainer.style.display = "none";
    }
  }
};

// src/settings-tab.ts
var import_obsidian5 = require("obsidian");

// src/secure-config.ts
var SecureConfigService = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Get API key with environment variable fallback
   */
  getApiKey(keyType) {
    if (this.settings.useEnvironmentVariables) {
      return this.getFromEnvironment(keyType);
    }
    return keyType === "gemini" ? this.settings.geminiApiKey : this.settings.groqApiKey;
  }
  /**
   * Get API key from environment variables
   */
  getFromEnvironment(keyType) {
    const prefix = this.settings.environmentPrefix || "YTC";
    const envVarName = `${prefix}_${keyType.toUpperCase()}_API_KEY`;
    return this.getSecureEnvVar(envVarName) || "";
  }
  /**
   * Secure environment variable access
   * Note: In Obsidian plugins, environment variables are limited
   * This method can be extended for server-side environments
   */
  getSecureEnvVar(varName) {
    if (typeof process !== "undefined" && process.env) {
      return process.env[varName];
    }
    return this.getFromSecureStorage(varName);
  }
  /**
   * Get from secure storage (implementation depends on environment)
   */
  getFromSecureStorage(varName) {
    return void 0;
  }
  /**
   * Validate configuration security
   */
  validateSecurityConfiguration() {
    const warnings = [];
    let isSecure = true;
    if (!this.settings.useEnvironmentVariables) {
      if (this.settings.geminiApiKey && this.settings.geminiApiKey.length > 0) {
        warnings.push("Gemini API key is stored directly in configuration. Consider using environment variables.");
        isSecure = false;
      }
      if (this.settings.groqApiKey && this.settings.groqApiKey.length > 0) {
        warnings.push("Groq API key is stored directly in configuration. Consider using environment variables.");
        isSecure = false;
      }
    }
    if (this.settings.geminiApiKey === "your-api-key-here" || this.settings.groqApiKey === "your-api-key-here") {
      warnings.push("Default placeholder API keys detected. Please set real API keys.");
      isSecure = false;
    }
    return { isSecure, warnings };
  }
  /**
   * Get configuration template for environment variables
   */
  getEnvironmentTemplate() {
    const prefix = this.settings.environmentPrefix || "YTC";
    return `# YouTubeClipper Environment Variables
# Set these in your environment for secure API key management

# Google Gemini API Key
${prefix}_GEMINI_API_KEY=your_gemini_api_key_here

# Groq API Key  
${prefix}_GROQ_API_KEY=your_groq_api_key_here

# Usage:
# 1. Set these variables in your shell profile (.bashrc, .zshrc, etc.)
# 2. Enable "Use Environment Variables" in plugin settings
# 3. Restart Obsidian to pick up the new environment variables
`;
  }
};

// src/settings-tab.ts
var SETTINGS_CSS_CLASSES = {
  container: "ytc-settings-container",
  section: "ytc-settings-section",
  header: "ytc-settings-header",
  validation: "ytc-settings-validation"
};
var YouTubeSettingsTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app, options) {
    super(app, options.plugin);
    this.options = options;
    this.validationErrors = [];
    this.settings = { ...options.plugin.settings };
    this.secureConfig = new SecureConfigService(this.settings);
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass(SETTINGS_CSS_CLASSES.container);
    containerEl.setAttribute("data-plugin", "youtube-clipper");
    this.createHeader();
    this.createAPISettings();
    this.createSecuritySettings();
    this.createFileSettings();
    this.createValidationStatus();
    this.createUsageInstructions();
  }
  /**
   * Create header with version information
   */
  createHeader() {
    const headerEl = this.containerEl.createDiv(SETTINGS_CSS_CLASSES.header);
    headerEl.createEl("h2", { text: "YouTubeClipper Settings" });
    const noteEl = headerEl.createDiv();
    noteEl.createEl("p", {
      text: "\u{1F4CC} Performance settings have been moved to the URL input modal for easier access and better workflow integration.",
      cls: "setting-item-description"
    });
    noteEl.style.marginBottom = "16px";
    noteEl.style.padding = "8px 12px";
    noteEl.style.backgroundColor = "var(--background-modifier-hover)";
    noteEl.style.borderRadius = "4px";
    noteEl.style.border = "1px solid var(--interactive-accent)";
    const versionEl = headerEl.createDiv("ytc-version-info");
    versionEl.createEl("span", {
      text: "v1.2.0 - Production Ready",
      cls: "ytc-version-badge"
    });
    const statusEl = headerEl.createDiv("ytc-status-info");
    const hasValidConfig = this.validateConfiguration();
    statusEl.createEl("span", {
      text: hasValidConfig ? "\u2705 Ready to use" : "\u26A0\uFE0F Configuration needed",
      cls: hasValidConfig ? "ytc-status-good" : "ytc-status-warning"
    });
    const docsEl = headerEl.createDiv("ytc-docs-link");
    docsEl.createEl("a", {
      text: "\u{1F4D6} View Documentation",
      href: "#",
      cls: "ytc-docs-button"
    }).addEventListener("click", (e) => {
      e.preventDefault();
      this.showDocumentation();
    });
  }
  /**
   * Validate entire configuration
   */
  validateConfiguration() {
    var _a, _b;
    const hasApiKey = ((_a = this.settings.geminiApiKey) == null ? void 0 : _a.trim()) || ((_b = this.settings.groqApiKey) == null ? void 0 : _b.trim());
    const hasValidPath = ValidationUtils.isValidPath(this.settings.outputPath);
    return Boolean(hasApiKey && hasValidPath);
  }
  /**
   * Show inline documentation
   */
  showDocumentation() {
    window.open("https://github.com/youtube-clipper/obsidian-plugin#readme", "_blank");
  }
  /**
  * Create API configuration settings
  */
  createAPISettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "API Configuration" });
    const securityNotice = containerEl.createDiv("ytc-security-notice");
    securityNotice.style.padding = "12px";
    securityNotice.style.marginBottom = "16px";
    securityNotice.style.backgroundColor = "var(--background-modifier-hover)";
    securityNotice.style.borderLeft = "4px solid var(--text-accent)";
    securityNotice.style.borderRadius = "4px";
    const noticeTitle = securityNotice.createEl("strong");
    noticeTitle.textContent = "\u{1F512} Security Notice: ";
    const noticeText = securityNotice.createEl("span");
    noticeText.textContent = "API keys are encrypted and stored securely by Obsidian. Never share your keys or commit them to version control.";
    noticeText.style.display = "block";
    noticeText.style.marginTop = "4px";
    noticeText.style.fontSize = "0.9em";
    noticeText.style.color = "var(--text-muted)";
    const geminiSetting = new import_obsidian5.Setting(containerEl).setName("Gemini API Key").setDesc("Your Google Gemini API key for content processing (password field - secured)").addText((text) => {
      const inputEl = text.setPlaceholder("sk-... (your key is encrypted)").setValue(this.settings.geminiApiKey || "").onChange(async (value) => {
        await this.updateSetting("geminiApiKey", value);
      }).inputEl;
      inputEl.type = "password";
      inputEl.style.fontFamily = "monospace";
      inputEl.style.letterSpacing = "0.1em";
      return text;
    });
    this.addKeyToggle(geminiSetting, this.settings.geminiApiKey);
    this.addKeyClearButton(geminiSetting, "geminiApiKey");
    const groqSetting = new import_obsidian5.Setting(containerEl).setName("Groq API Key").setDesc("Your Groq API key for fallback processing (password field - secured)").addText((text) => {
      const inputEl = text.setPlaceholder("gsk_... (your key is encrypted)").setValue(this.settings.groqApiKey || "").onChange(async (value) => {
        await this.updateSetting("groqApiKey", value);
      }).inputEl;
      inputEl.type = "password";
      inputEl.style.fontFamily = "monospace";
      inputEl.style.letterSpacing = "0.1em";
      return text;
    });
    this.addKeyToggle(groqSetting, this.settings.groqApiKey);
    this.addKeyClearButton(groqSetting, "groqApiKey");
    const testSection = containerEl.createDiv("ytc-test-connection");
    testSection.style.marginTop = "16px";
    testSection.style.paddingTop = "12px";
    testSection.style.borderTop = "1px solid var(--background-modifier-border)";
    new import_obsidian5.Setting(testSection).setName("Test API Connection").setDesc("Verify your API keys are valid").addButton((btn) => btn.setButtonText("Test Keys").onClick(async () => {
      btn.setDisabled(true);
      btn.setButtonText("Testing...");
      try {
        await this.testAPIKeys();
        btn.setButtonText("\u2713 Success!");
        setTimeout(() => {
          btn.setButtonText("Test Keys");
          btn.setDisabled(false);
        }, 2e3);
      } catch (error) {
        btn.setButtonText("\u2717 Failed");
        ErrorHandler.handle(error, "API key test failed", true);
        setTimeout(() => {
          btn.setButtonText("Test Keys");
          btn.setDisabled(false);
        }, 2e3);
      }
    }));
  }
  /**
   * Add show/hide toggle for sensitive API keys
   */
  addKeyToggle(setting, keyValue) {
    const toggleBtn = setting.addButton((btn) => btn.setButtonText("\u{1F441}\uFE0F Show").setTooltip("Toggle key visibility").onClick((e) => {
      const inputs = setting.settingEl.querySelectorAll('input[type="password"], input[type="text"]');
      if (inputs.length === 0)
        return;
      const input = inputs[0];
      const isPassword = input.type === "password";
      input.type = isPassword ? "text" : "password";
      btn.setButtonText(isPassword ? "\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F Hide" : "\u{1F441}\uFE0F Show");
    }));
  }
  /**
   * Add clear button to remove API key
   */
  addKeyClearButton(setting, settingKey) {
    const clearBtn = setting.addButton((btn) => btn.setButtonText("\u{1F5D1}\uFE0F Clear").setTooltip("Remove this API key").onClick(async () => {
      const keyName = settingKey === "geminiApiKey" ? "Gemini" : "Groq";
      if (confirm(`Are you sure you want to clear the ${keyName} API key?`)) {
        await this.updateSetting(settingKey, "");
        this.display();
      }
    }));
  }
  /**
   * Test API keys for validity
   */
  async testAPIKeys() {
    const errors = [];
    if (this.settings.geminiApiKey) {
      try {
        const response = await fetch(
          "https://generativelanguage.googleapis.com/v1beta/models?key=" + this.settings.geminiApiKey
        );
        if (!response.ok) {
          errors.push(`Gemini API key invalid (${response.status})`);
        }
      } catch (error) {
        errors.push("Gemini API key test failed (network error)");
      }
    } else {
      errors.push("Gemini API key not configured");
    }
    if (errors.length > 0) {
      throw new Error(errors.join("\n"));
    }
  }
  /**
   * Create security configuration settings
   */
  createSecuritySettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Security Configuration" });
    new import_obsidian5.Setting(containerEl).setName("Use Environment Variables").setDesc("Load API keys from environment variables instead of storing them in configuration").addToggle((toggle) => toggle.setValue(this.settings.useEnvironmentVariables || false).onChange(async (value) => {
      await this.updateSetting("useEnvironmentVariables", value);
      this.display();
    }));
    if (this.settings.useEnvironmentVariables) {
      new import_obsidian5.Setting(containerEl).setName("Environment Variable Prefix").setDesc("Prefix for environment variable names (e.g., YTC_GEMINI_API_KEY)").addText((text) => text.setPlaceholder("YTC").setValue(this.settings.environmentPrefix || "YTC").onChange(async (value) => {
        await this.updateSetting("environmentPrefix", value || "YTC");
      }));
      const envTemplate = this.secureConfig.getEnvironmentTemplate();
      const envSection = containerEl.createDiv("ytc-env-template");
      envSection.createEl("h4", { text: "Environment Variables Template" });
      envSection.createEl("p", {
        text: "Copy these environment variables to your shell profile:",
        cls: "setting-item-description"
      });
      const preEl = envSection.createEl("pre");
      preEl.createEl("code", { text: envTemplate });
      new import_obsidian5.Setting(envSection).setName("Copy Template").setDesc("Copy the environment variables template to clipboard").addButton((button) => button.setButtonText("Copy to Clipboard").onClick(() => {
        navigator.clipboard.writeText(envTemplate);
        button.setButtonText("Copied!");
        setTimeout(() => button.setButtonText("Copy to Clipboard"), 2e3);
      }));
    }
    const validation = this.secureConfig.validateSecurityConfiguration();
    if (!validation.isSecure) {
      const warningEl = containerEl.createDiv("ytc-security-warnings");
      warningEl.createEl("h4", { text: "\u26A0\uFE0F Security Warnings", cls: "ytc-warning-header" });
      validation.warnings.forEach((warning) => {
        warningEl.createEl("p", { text: warning, cls: "ytc-warning-text" });
      });
    }
  }
  /**
   * Create file configuration settings
   */
  createFileSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "File Configuration" });
    new import_obsidian5.Setting(containerEl).setName("Output Path").setDesc("Directory path where processed videos will be saved (relative to vault root)").addText((text) => text.setPlaceholder(MESSAGES.PLACEHOLDERS.OUTPUT_PATH).setValue(this.settings.outputPath).onChange(async (value) => {
      await this.updateSetting("outputPath", value);
    }));
  }
  /**
   * Create validation status display
   */
  createValidationStatus() {
    const { containerEl } = this;
    if (this.validationErrors.length > 0) {
      const errorSection = containerEl.createDiv();
      errorSection.style.marginTop = "20px";
      errorSection.style.padding = "10px";
      errorSection.style.backgroundColor = "var(--background-modifier-error)";
      errorSection.style.borderRadius = "4px";
      errorSection.createEl("h4", {
        text: "\u26A0\uFE0F Configuration Issues",
        attr: { style: "color: var(--text-error); margin-top: 0;" }
      });
      const errorList = errorSection.createEl("ul");
      this.validationErrors.forEach((error) => {
        errorList.createEl("li", { text: error });
      });
    } else {
      const successSection = containerEl.createDiv();
      successSection.style.marginTop = "20px";
      successSection.style.padding = "10px";
      successSection.style.backgroundColor = "var(--background-modifier-success)";
      successSection.style.borderRadius = "4px";
      successSection.createEl("h4", {
        text: "\u2705 Configuration Valid",
        attr: { style: "color: var(--text-success); margin-top: 0;" }
      });
    }
  }
  /**
   * Create usage instructions
   */
  createUsageInstructions() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Usage Instructions" });
    const instructions = containerEl.createDiv();
    instructions.innerHTML = `
            <p><strong>How to use:</strong></p>
            <ol>
                <li>Set your Gemini or Groq API key above</li>
                <li>Configure your preferred output directory</li>
                <li>Click the video icon in the ribbon or use the command palette</li>
                <li>Paste a YouTube URL and adjust performance settings in the modal</li>
                <li>Click Process to analyze the video and create a structured note</li>
            </ol>

            <p><strong>Performance Settings:</strong></p>
            <ul>
                <li><strong>Speed & Performance:</strong> Available directly in the URL input modal for easy access</li>
                <li><strong>Performance Mode:</strong> Choose between Fast, Balanced, or Quality processing</li>
                <li><strong>Parallel Processing:</strong> Race multiple AI providers for faster responses</li>
                <li><strong>Multimodal Analysis:</strong> Enable audio + visual analysis for video-aware models</li>
            </ul>

            <p><strong>API Key Information:</strong></p>
            <ul>
                <li><strong>Gemini API:</strong> Get your key from <a href="https://aistudio.google.com/app/apikey">Google AI Studio</a></li>
                <li><strong>Groq API:</strong> Get your key from <a href="https://console.groq.com/keys">Groq Console</a></li>
                <li>At least one API key is required for the plugin to function</li>
            </ul>

            <p><strong>Note:</strong> This plugin requires an active internet connection and a valid API key.</p>
            <p><strong>Limitations:</strong> Due to CORS restrictions, full transcript extraction may be limited. The plugin works with available metadata and descriptions.</p>
        `;
  }
  /**
   * Update a setting value
   */
  async updateSetting(key, value) {
    try {
      this.settings[key] = value;
      await this.validateAndSaveSettings();
    } catch (error) {
      ErrorHandler.handle(error, `Settings update for ${key}`);
    }
  }
  /**
   * Validate and save settings
   */
  async validateAndSaveSettings() {
    const validation = ValidationUtils.validateSettings(this.settings);
    this.validationErrors = validation.errors;
    if (validation.isValid) {
      await this.options.onSettingsChange(this.settings);
    }
    this.display();
  }
  /**
   * Get current settings
   */
  getSettings() {
    return { ...this.settings };
  }
  /**
   * Update settings from external source
   */
  updateSettings(newSettings) {
    this.settings = { ...newSettings };
    this.display();
  }
};

// src/services/ai-service.ts
init_api();

// src/performance.ts
var PERFORMANCE_PRESETS = {
  fast: {
    name: "Fast",
    description: "Maximum speed with optimized models and parallel processing. Best for quick summaries.",
    timeouts: {
      geminiTimeout: 15e3,
      groqTimeout: 1e4,
      metadataTimeout: 5e3
    },
    enableParallel: true,
    preferMultimodal: false,
    modelStrategy: {
      briefFormat: "llama-3.1-8b-instant",
      executiveSummary: "llama-3.3-70b-versatile",
      detailedGuide: "gemini-2.0-flash-lite",
      fallbackModel: "llama-3.1-8b-instant"
    }
  },
  balanced: {
    name: "Balanced",
    description: "Balanced speed and quality with multimodal analysis for detailed content.",
    timeouts: {
      geminiTimeout: 3e4,
      groqTimeout: 2e4,
      metadataTimeout: 1e4
    },
    enableParallel: true,
    preferMultimodal: true,
    modelStrategy: {
      briefFormat: "llama-3.1-8b-instant",
      executiveSummary: "gemini-2.0-flash-lite",
      detailedGuide: "gemini-2.5-flash",
      fallbackModel: "llama-3.3-70b-versatile"
    }
  },
  quality: {
    name: "Quality",
    description: "Maximum quality with comprehensive multimodal analysis. Slower but most detailed.",
    timeouts: {
      geminiTimeout: 6e4,
      groqTimeout: 3e4,
      metadataTimeout: 15e3
    },
    enableParallel: false,
    preferMultimodal: true,
    modelStrategy: {
      briefFormat: "gemini-2.0-flash-lite",
      executiveSummary: "gemini-2.5-flash",
      detailedGuide: "gemini-2.5-pro",
      fallbackModel: "gemini-2.0-flash"
    }
  }
};

// src/services/ai-service.ts
var AIService = class {
  constructor(providers, settings) {
    this.providers = [];
    if (!providers || providers.length === 0) {
      throw new Error(MESSAGES.ERRORS.MISSING_API_KEYS);
    }
    this.providers = providers;
    this.settings = settings;
    this.applyPerformanceSettings();
  }
  /**
   * Apply performance settings to providers
   */
  applyPerformanceSettings() {
    const preset = PERFORMANCE_PRESETS[this.settings.performanceMode] || PERFORMANCE_PRESETS.balanced;
    const timeouts = this.settings.customTimeouts || preset.timeouts;
    this.providers.forEach((provider) => {
      if (provider.name === "Google Gemini" && provider.setTimeout) {
        provider.setTimeout(timeouts.geminiTimeout);
      } else if (provider.name === "Groq" && provider.setTimeout) {
        provider.setTimeout(timeouts.groqTimeout);
      }
    });
  }
  /**
   * Update settings and reapply performance configurations
   */
  updateSettings(newSettings) {
    this.settings = newSettings;
    this.applyPerformanceSettings();
  }
  /**
   * Return available model options for a provider name (from constants mapping)
   */
  getProviderModels(providerName) {
    const raw = PROVIDER_MODEL_OPTIONS[providerName] || [];
    return raw.map((r) => typeof r === "string" ? r : r && r.name ? r.name : String(r));
  }
  /**
   * Best-effort fetch of latest models for all providers by scraping known provider pages.
   * Returns a mapping providerName -> list of discovered models. Falls back to static mapping.
   */
  async fetchLatestModels() {
    const result = {};
    const providers = this.getProviderNames();
    for (const p of providers) {
      try {
        const models = await this.fetchLatestModelsForProvider(p);
        result[p] = models.length > 0 ? models : PROVIDER_MODEL_OPTIONS[p] ? PROVIDER_MODEL_OPTIONS[p].map((m) => typeof m === "string" ? m : m.name) : [];
      } catch (error) {
        result[p] = PROVIDER_MODEL_OPTIONS[p] ? PROVIDER_MODEL_OPTIONS[p].map((m) => typeof m === "string" ? m : m.name) : [];
      }
    }
    return result;
  }
  /**
   * Fetch latest models for a single provider (best-effort scraping).
   */
  async fetchLatestModelsForProvider(providerName) {
    const url = PROVIDER_MODEL_LIST_URLS[providerName];
    const regex = PROVIDER_MODEL_REGEX[providerName];
    if (!url || !regex) {
      return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
    }
    try {
      const resp = await fetch(url, { method: "GET" });
      if (!resp.ok) {
        return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
      }
      const text = await resp.text();
      const matches = text.match(regex) || [];
      const normalized = Array.from(new Set(matches.map((m) => m.toLowerCase())));
      return normalized;
    } catch (error) {
      return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
    }
  }
  /**
   * Process prompt with fallback support (original sequential method)
   */
  async process(prompt) {
    if (!prompt || typeof prompt !== "string") {
      throw new Error("Valid prompt is required");
    }
    if (this.settings.enableParallelProcessing) {
      return this.processParallel(prompt);
    }
    return this.processSequential(prompt);
  }
  /**
   * Process prompt with sequential fallback (original method)
   */
  async processSequential(prompt) {
    let lastError = null;
    for (const provider of this.providers) {
      try {
        console.log(`Attempting to process with ${provider.name}...`);
        const content = await provider.process(prompt);
        if (content && content.trim().length > 0) {
          return {
            content,
            provider: provider.name,
            model: provider.model
          };
        } else {
          throw new Error("Empty response from AI provider");
        }
      } catch (error) {
        lastError = error;
        console.warn(`${provider.name} failed:`, error);
        if (provider === this.providers[this.providers.length - 1]) {
          break;
        }
      }
    }
    const errorMessage = lastError ? MESSAGES.ERRORS.AI_PROCESSING(lastError.message) : "All AI providers failed to process the request";
    throw new Error(errorMessage);
  }
  /**
   * Process prompt with parallel provider racing for maximum speed
   */
  async processParallel(prompt) {
    console.log("Starting parallel provider racing...");
    const providerPromises = this.providers.map(async (provider) => {
      try {
        const content = await provider.processWithTimeout(prompt);
        if (content && content.trim().length > 0) {
          return {
            content,
            provider: provider.name,
            model: provider.model,
            success: true,
            responseTime: Date.now()
          };
        } else {
          throw new Error("Empty response from AI provider");
        }
      } catch (error) {
        console.warn(`${provider.name} failed in parallel race:`, error);
        return {
          error: error.message,
          provider: provider.name,
          model: provider.model,
          success: false,
          responseTime: Date.now()
        };
      }
    });
    const results = await Promise.allSettled(providerPromises);
    for (const result of results) {
      if (result.status === "fulfilled" && result.value.success) {
        console.log(`Parallel winner: ${result.value.provider} (${Date.now() - result.value.responseTime}ms)`);
        return {
          content: result.value.content,
          provider: result.value.provider,
          model: result.value.model
        };
      }
    }
    const errors = results.filter((r) => r.status === "fulfilled" && !r.value.success).map((r) => r.value.error);
    const errorMessage = errors.length > 0 ? MESSAGES.ERRORS.AI_PROCESSING(errors.join("; ")) : "All AI providers failed to process the request";
    throw new Error(errorMessage);
  }
  /**
   * Process prompt using a specific provider name. Optionally override the model if supported.
   */
  async processWith(providerName, prompt, overrideModel) {
    const provider = this.providers.find((p) => p.name === providerName);
    if (!provider) {
      throw new Error(`AI provider not found: ${providerName}`);
    }
    try {
      if (overrideModel && typeof provider.setModel === "function") {
        provider.setModel(overrideModel);
      }
      const content = await provider.process(prompt);
      if (content && content.trim().length > 0) {
        return { content, provider: provider.name, model: provider.model };
      }
      throw new Error("Empty response from AI provider");
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.AI_PROCESSING(error.message));
    }
  }
  /**
   * Check if any providers are available
   */
  hasAvailableProviders() {
    return this.providers.length > 0;
  }
  /**
   * Get list of available provider names
   */
  getProviderNames() {
    return this.providers.map((p) => p.name);
  }
  /**
   * Add a new provider
   */
  addProvider(provider) {
    this.providers.push(provider);
  }
  /**
   * Remove a provider by name
   */
  removeProvider(providerName) {
    const index = this.providers.findIndex((p) => p.name === providerName);
    if (index !== -1) {
      this.providers.splice(index, 1);
      return true;
    }
    return false;
  }
};

// src/gemini.ts
init_api();

// src/base.ts
var BaseAIProvider = class {
  constructor(apiKey, initialModel, timeout) {
    this.apiKey = apiKey;
    this._timeout = 3e4;
    if (!apiKey) {
      throw new Error("API key is required for AI provider");
    }
    this._model = initialModel || "";
    if (timeout) {
      this._timeout = timeout;
    }
  }
  // Default 30s timeout
  get model() {
    return this._model;
  }
  get timeout() {
    return this._timeout;
  }
  setModel(model) {
    this._model = model;
  }
  setTimeout(timeout) {
    this._timeout = timeout;
  }
  /**
   * Process with timeout support
   */
  async processWithTimeout(prompt, customTimeout) {
    const timeoutMs = customTimeout || this._timeout;
    const timeoutPromise = new Promise((_, reject) => {
      setTimeout(() => {
        reject(new Error(`${this.name} request timed out after ${timeoutMs}ms`));
      }, timeoutMs);
    });
    const processPromise = this.process(prompt);
    return Promise.race([processPromise, timeoutPromise]);
  }
  /**
   * Validate API response structure
   */
  validateResponse(response, requiredPath) {
    let current = response;
    for (const key of requiredPath) {
      if (!current || typeof current !== "object" || !(key in current)) {
        return false;
      }
      current = current[key];
    }
    return current !== null && current !== void 0;
  }
  /**
   * Safely parse JSON response without throwing
   */
  async safeJsonParse(response) {
    try {
      return await response.json();
    } catch (e) {
      return null;
    }
  }
  /**
   * Handle API errors consistently
   */
  async handleAPIError(response) {
    return ErrorHandler.handleAPIError(response, this.name);
  }
};

// src/gemini.ts
var GeminiProvider = class extends BaseAIProvider {
  constructor(apiKey, model, timeout) {
    super(apiKey, model || AI_MODELS.GEMINI, timeout);
    this.name = "Google Gemini";
  }
  async process(prompt) {
    var _a;
    try {
      if (!this.apiKey || this.apiKey.trim().length === 0) {
        throw new Error(MESSAGES.ERRORS.GEMINI_INVALID_KEY);
      }
      const response = await fetch(`${API_ENDPOINTS.GEMINI}?key=${this.apiKey}`, {
        method: "POST",
        headers: this.createHeaders(),
        body: JSON.stringify(this.createRequestBody(prompt))
      });
      if (response.status === 400) {
        const errorData = await this.safeJsonParse(response);
        const errorMessage = ((_a = errorData == null ? void 0 : errorData.error) == null ? void 0 : _a.message) || "Bad request";
        throw new Error(`Gemini API error: ${errorMessage}. Try checking the model configuration.`);
      }
      if (response.status === 401) {
        throw new Error(MESSAGES.ERRORS.GEMINI_INVALID_KEY);
      }
      if (response.status === 403) {
        throw new Error("Gemini API access forbidden. Check API key permissions and billing.");
      }
      if (response.status === 429) {
        throw new Error("Gemini API rate limit exceeded. Please wait and try again.");
      }
      if (!response.ok) {
        await this.handleAPIError(response);
      }
      const data = await response.json();
      if (!data.candidates || !data.candidates.length) {
        throw new Error("No response candidates returned from Gemini API");
      }
      if (data.candidates[0].finishReason === "SAFETY") {
        throw new Error("Response blocked by Gemini safety filters. Try rephrasing.");
      }
      if (!this.validateResponse(data, ["candidates", "0", "content", "parts", "0", "text"])) {
        throw new Error("Invalid response format from Gemini API");
      }
      return this.extractContent(data);
    } catch (error) {
      if (error instanceof Error) {
        throw error;
      }
      throw new Error(`Gemini processing failed: ${error}`);
    }
  }
  createHeaders() {
    return {
      "Content-Type": "application/json"
    };
  }
  createRequestBody(prompt) {
    const normalizedPrompt = prompt.toLowerCase();
    const isVideoAnalysis = normalizedPrompt.includes("youtube video") || normalizedPrompt.includes("youtu.be/") || normalizedPrompt.includes("youtube.com/");
    const baseConfig = {
      contents: [{
        parts: [{ text: prompt }]
      }],
      generationConfig: {
        temperature: 0.7,
        maxOutputTokens: 4e3,
        // Increased for detailed guides
        candidateCount: 1
      }
      // safetySettings: [
      //     {
      //         category: "HARM_CATEGORY_HARASSMENT",
      //         threshold: "BLOCK_MEDIUM_AND_ABOVE"
      //     },
      //     {
      //         category: "HARM_CATEGORY_HATE_SPEECH", 
      //         threshold: "BLOCK_MEDIUM_AND_ABOVE"
      //     }
      // ]
    };
    if (isVideoAnalysis) {
      const providerModels = PROVIDER_MODEL_OPTIONS["Google Gemini"] || [];
      const currentModelName = String(this.model || "").toLowerCase();
      const matched = providerModels.find((m) => {
        const name = typeof m === "string" ? m : m && m.name ? m.name : "";
        return String(name).toLowerCase() === currentModelName;
      });
      const supportsAudioVideo = matched && matched.supportsAudioVideo === true;
      const videoConfig = {
        ...baseConfig,
        systemInstruction: {
          parts: [{
            text: `You are an expert video content analyzer. Provide comprehensive, multimodal analysis using:
\u2022 AUDIO STREAM: Transcribe all spoken content, identify speakers, capture tone/emphasis/emotion
\u2022 VIDEO STREAM: Analyze visual elements, text overlays, diagrams, slides, gestures, scene changes, and visual demonstrations
\u2022 INTEGRATED INSIGHTS: Synthesize audio and visual data to provide complete understanding

For best results:
- Prioritize accuracy in transcription and speaker identification
- Extract and explain key concepts shown visually
- Note timing relationships between audio and visual elements
- Identify visual cues that reinforce or clarify spoken content`
          }]
        }
      };
      const gcsMatch = prompt.match(/(gs:\/\/[\w\-\.\/]+\.(?:mp4|mov|mkv|webm))/i);
      if (gcsMatch && gcsMatch[1]) {
        const gcsUri = gcsMatch[1];
        videoConfig.contents = videoConfig.contents || [];
        videoConfig.contents.push({
          parts: [{ fileData: { fileUri: gcsUri, mimeType: "video/mp4" } }]
        });
      }
      return videoConfig;
    }
    return baseConfig;
  }
  extractContent(response) {
    const content = response.candidates[0].content.parts[0].text;
    return content ? content.trim() : "";
  }
};

// src/groq.ts
init_api();
var GroqProvider = class extends BaseAIProvider {
  constructor(apiKey, model, timeout) {
    super(apiKey, model || AI_MODELS.GROQ, timeout);
    this.name = "Groq";
  }
  async process(prompt) {
    const response = await fetch(API_ENDPOINTS.GROQ, {
      method: "POST",
      headers: this.createHeaders(),
      body: JSON.stringify(this.createRequestBody(prompt))
    });
    if (response.status === 404) {
      throw new Error(MESSAGES.ERRORS.GROQ_MODEL_NOT_FOUND);
    }
    if (!response.ok) {
      await this.handleAPIError(response);
    }
    const data = await response.json();
    if (!this.validateResponse(data, ["choices", "0", "message"])) {
      throw new Error("Invalid response format from Groq API");
    }
    return this.extractContent(data);
  }
  createHeaders() {
    return {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${this.apiKey}`
    };
  }
  createRequestBody(prompt) {
    return {
      model: this.model,
      messages: [
        {
          role: "system",
          content: "You are an expert content analyzer specializing in extracting practical value and creating actionable guides from video content. Focus on clarity, practicality, and immediate implementability. Even with limited information, provide maximum value through structured analysis and practical recommendations."
        },
        {
          role: "user",
          content: prompt
        }
      ],
      max_tokens: API_LIMITS.MAX_TOKENS,
      temperature: API_LIMITS.TEMPERATURE
    };
  }
  extractContent(response) {
    const content = response.choices[0].message.content;
    return content ? content.trim() : "";
  }
};

// src/video-data.ts
init_api();

// src/services/transcript-service.ts
init_api();
var YouTubeTranscriptService = class {
  // 1 hour
  constructor(cache) {
    this.cache = cache;
    this.transcriptTTL = 1e3 * 60 * 60;
  }
  /**
   * Extract transcript for a YouTube video
   */
  async getTranscript(videoId) {
    var _a, _b;
    if (!videoId) {
      throw new Error("Video ID is required");
    }
    const cacheKey = `transcript-${videoId}`;
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const transcript = await this.fetchTranscriptWithFallback(videoId);
      if (transcript) {
        (_b = this.cache) == null ? void 0 : _b.set(cacheKey, transcript, this.transcriptTTL);
        return transcript;
      }
      return null;
    } catch (error) {
      console.warn("Failed to fetch transcript:", error);
      return null;
    }
  }
  /**
   * Fetch transcript using multiple methods with fallback
   */
  async fetchTranscriptWithFallback(videoId) {
    try {
      const transcript = await this.fetchFromYouTubeAPI(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("YouTube API method failed:", error);
    }
    try {
      const transcript = await this.scrapeTranscriptFromPage(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("Page scraping method failed:", error);
    }
    try {
      const transcript = await this.fetchFromThirdParty(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("Third-party method failed:", error);
    }
    return null;
  }
  /**
   * Method 1: Official YouTube transcript API
   */
  async fetchFromYouTubeAPI(videoId) {
    const url = `https://video.google.com/timedtext?lang=en&v=${videoId}`;
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`Transcript API failed: ${response.status}`);
    }
    const xmlText = await response.text();
    return this.parseXMLTranscript(xmlText, videoId);
  }
  /**
   * Method 2: Scrape transcript from YouTube page
   */
  async scrapeTranscriptFromPage(videoId) {
    const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;
    const proxyUrl = `${API_ENDPOINTS.CORS_PROXY}?url=${encodeURIComponent(videoUrl)}`;
    const response = await fetch(proxyUrl);
    if (!response.ok) {
      throw new Error("Failed to fetch video page");
    }
    const html = await response.text();
    const transcriptData = await this.extractTranscriptFromHTML(html);
    if (transcriptData) {
      return this.createTranscript(transcriptData, videoId, true);
    }
    return null;
  }
  /**
   * Method 3: Third-party transcript service (optional)
   */
  async fetchFromThirdParty(videoId) {
    return null;
  }
  /**
   * Parse XML transcript from YouTube API
   */
  parseXMLTranscript(xmlText, videoId) {
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xmlText, "text/xml");
    const textElements = xmlDoc.getElementsByTagName("text");
    const segments = [];
    let fullText = "";
    for (let i = 0; i < textElements.length; i++) {
      const element = textElements[i];
      const text = element.textContent || "";
      const start = parseFloat(element.getAttribute("start") || "0");
      const duration = parseFloat(element.getAttribute("dur") || "0");
      if (text.trim()) {
        segments.push({ text: text.trim(), start, duration });
        fullText += text.trim() + " ";
      }
    }
    return {
      segments,
      fullText: fullText.trim(),
      language: "en",
      autoGenerated: true
    };
  }
  /**
   * Extract transcript data from YouTube page HTML
   */
  async extractTranscriptFromHTML(html) {
    const transcriptRegex = /"captions":\s*{[^}]*"playerCaptionsTracklistRenderer":\s*{[^}]*"captionTracks":\s*\[([^\]]+)\]/;
    const match = html.match(transcriptRegex);
    if (!match || !match[1]) {
      return null;
    }
    try {
      const captionTracksJson = match[1];
      const captionTracks = JSON.parse(`[${captionTracksJson}]`);
      const englishTrack = captionTracks.find(
        (track) => {
          var _a;
          return track.languageCode === "en" || ((_a = track.languageCode) == null ? void 0 : _a.startsWith("en"));
        }
      );
      if (!englishTrack || !englishTrack.baseUrl) {
        return null;
      }
      return fetch(englishTrack.baseUrl).then((resp) => {
        if (!resp.ok)
          throw new Error("Failed to fetch caption track");
        return resp.text();
      }).then((xmlText) => this.parseXMLTranscript(xmlText, "").segments).catch((err) => {
        console.debug("Failed to fetch caption track:", err);
        return null;
      });
    } catch (error) {
      console.debug("Failed to parse transcript from HTML:", error);
      return null;
    }
  }
  /**
   * Create transcript object from segments
   */
  createTranscript(segments, videoId, autoGenerated = false) {
    if (!Array.isArray(segments)) {
      segments = [segments];
    }
    const normalizedSegments = segments.map((seg) => ({
      text: seg.text,
      start: seg.start,
      duration: seg.duration || 0
    }));
    const fullText = normalizedSegments.map((seg) => seg.text).join(" ").trim();
    return {
      segments: normalizedSegments,
      fullText,
      language: "en",
      autoGenerated
    };
  }
  /**
   * Get transcript summary for quick analysis
   */
  async getTranscriptSummary(videoId, maxLength = 2e3) {
    const transcript = await this.getTranscript(videoId);
    if (!transcript) {
      return null;
    }
    if (transcript.fullText.length <= maxLength) {
      return transcript.fullText;
    }
    const keySegments = transcript.segments.filter((seg) => seg.text.length > 20).slice(0, 10).map((seg) => seg.text).join(" ");
    return keySegments.length > maxLength ? keySegments.substring(0, maxLength) + "..." : keySegments;
  }
  /**
   * Extract key time-stamped moments from transcript
   */
  async extractKeyMoments(videoId, count = 5) {
    const transcript = await this.getTranscript(videoId);
    if (!transcript || transcript.segments.length === 0) {
      return null;
    }
    const meaningfulSegments = transcript.segments.filter((seg) => seg.text.length > 30);
    if (meaningfulSegments.length === 0) {
      return null;
    }
    const totalSegments = meaningfulSegments.length;
    const step = Math.max(1, Math.floor(totalSegments / count));
    const keyMoments = [];
    for (let i = 0; i < totalSegments && keyMoments.length < count; i += step) {
      const segment = meaningfulSegments[i];
      keyMoments.push({
        time: segment.start,
        text: segment.text
      });
    }
    return keyMoments;
  }
  /**
   * Check if transcript is available for a video
   */
  async isTranscriptAvailable(videoId) {
    const transcript = await this.getTranscript(videoId);
    return transcript !== null && transcript.segments.length > 0;
  }
};

// src/video-data.ts
var YouTubeVideoService = class {
  constructor(cache) {
    this.cache = cache;
    this.metadataTTL = 1e3 * 60 * 30;
    // 30 minutes
    this.descriptionTTL = 1e3 * 60 * 30;
    this.transcriptService = new YouTubeTranscriptService(cache);
  }
  /**
   * Extract video ID from YouTube URL
   */
  extractVideoId(url) {
    return ValidationUtils.extractVideoId(url);
  }
  /**
   * Get video metadata and description
   */
  async getVideoData(videoId) {
    var _a, _b;
    if (!videoId) {
      throw new Error("Video ID is required");
    }
    const cacheKey = this.getCacheKey("video-data", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const metadata = await this.getVideoMetadata(videoId);
      const result = {
        title: metadata.title || "Unknown Title",
        description: metadata.description || "No description available",
        duration: metadata.duration,
        thumbnail: metadata.thumbnail,
        channelName: metadata.channelName
      };
      if (result.duration && result.duration < 1800) {
        this.checkTranscriptAvailability(videoId).then((hasTranscript) => {
          var _a2;
          result.hasTranscript = hasTranscript;
          (_a2 = this.cache) == null ? void 0 : _a2.set(cacheKey, result, this.metadataTTL);
        });
      }
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, result, this.metadataTTL);
      return result;
    } catch (error) {
      throw ErrorHandler.createUserFriendlyError(
        error,
        "fetch video data"
      );
    }
  }
  /**
   * Get video metadata using YouTube oEmbed API
   */
  async getVideoMetadata(videoId) {
    var _a, _b;
    const cacheKey = this.getCacheKey("metadata", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    const oembedUrl = `${API_ENDPOINTS.YOUTUBE_OEMBED}?url=https://www.youtube.com/watch?v=${videoId}&format=json`;
    try {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 1e4);
      const response = await fetch(oembedUrl, {
        headers: {
          "User-Agent": "Obsidian YoutubeClipper Plugin"
        },
        signal: controller.signal
      });
      clearTimeout(timeoutId);
      if (!response.ok) {
        if (response.status === 400) {
          throw new Error(`Invalid YouTube video ID: ${videoId}. Please check the URL and try again.`);
        } else if (response.status === 404) {
          throw new Error(`YouTube video not found: ${videoId}. The video may be private, deleted, or the ID is incorrect.`);
        } else if (response.status === 403) {
          throw new Error(`Access denied to YouTube video: ${videoId}. The video may be private or restricted.`);
        } else {
          throw new Error(MESSAGES.ERRORS.FETCH_VIDEO_DATA(response.status));
        }
      }
      const data = await response.json();
      let enhancedData = {
        title: data.title || "Unknown Title",
        thumbnail: data.thumbnail_url,
        author_name: data.author_name
      };
      try {
        const pageData = await this.scrapeAdditionalMetadata(videoId);
        enhancedData = { ...enhancedData, ...pageData };
      } catch (error) {
        console.debug("Could not scrape additional metadata:", error);
      }
      const metadata = {
        title: enhancedData.title,
        description: enhancedData.description,
        duration: enhancedData.duration,
        thumbnail: enhancedData.thumbnail,
        channelName: enhancedData.author_name
      };
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, metadata, this.metadataTTL);
      return metadata;
    } catch (error) {
      if (error instanceof DOMException && error.name === "AbortError") {
        throw new Error("Request timed out. Please check your internet connection and try again.");
      } else if (error instanceof TypeError) {
        throw new Error(MESSAGES.ERRORS.NETWORK_ERROR);
      } else if (error instanceof Error && error.message.includes("JSON")) {
        throw new Error("Failed to parse YouTube response. The service may be temporarily unavailable.");
      }
      throw error;
    }
  }
  /**
   * Scrape additional metadata from YouTube page
   */
  async scrapeAdditionalMetadata(videoId) {
    try {
      const html = await this.fetchVideoPageHTML(videoId);
      const durationMatch = html.match(/"lengthSeconds":"(\d+)"/);
      const duration = durationMatch ? parseInt(durationMatch[1]) : void 0;
      const descriptionMatch = html.match(/"shortDescription":"([^"]+)"/);
      const description = descriptionMatch ? descriptionMatch[1].replace(/\\u0026/g, "&").replace(/\\n/g, "\n") : void 0;
      return { description, duration };
    } catch (error) {
      return {};
    }
  }
  /**
   * Check if transcript is available for this video
   */
  async checkTranscriptAvailability(videoId) {
    try {
      return await this.transcriptService.isTranscriptAvailable(videoId);
    } catch (error) {
      return false;
    }
  }
  /**
   * Get video description by scraping the YouTube page
   */
  async getVideoDescription(videoId) {
    var _a, _b, _c;
    const cacheKey = this.getCacheKey("description", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const html = await this.fetchVideoPageHTML(videoId);
      const description = this.extractDescriptionFromHTML(html);
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, description, this.descriptionTTL);
      return description;
    } catch (error) {
      console.warn("Failed to scrape video page:", error);
      const fallback = MESSAGES.WARNINGS.EXTRACTION_FAILED;
      (_c = this.cache) == null ? void 0 : _c.set(cacheKey, fallback, this.descriptionTTL);
      return fallback;
    }
  }
  /**
   * Fetch YouTube page HTML using CORS proxy
   */
  async fetchVideoPageHTML(videoId) {
    const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;
    const proxyUrl = `${API_ENDPOINTS.CORS_PROXY}?url=${encodeURIComponent(videoUrl)}`;
    const response = await fetch(proxyUrl);
    if (!response.ok) {
      throw new Error(MESSAGES.WARNINGS.CORS_RESTRICTIONS);
    }
    return response.text();
  }
  /**
   * Extract description from YouTube page HTML
   */
  extractDescriptionFromHTML(html) {
    const patterns = [
      /"shortDescription":"([^"]*?)"/,
      /"description":{"simpleText":"([^"]*?)"}/,
      /<meta name="description" content="([^"]*?)">/,
      /<meta property="og:description" content="([^"]*?)">/
    ];
    for (const pattern of patterns) {
      const match = html.match(pattern);
      if (match && match[1]) {
        const cleanedText = ValidationUtils.cleanText(match[1]);
        return ValidationUtils.truncateText(cleanedText, API_LIMITS.DESCRIPTION_MAX_LENGTH);
      }
    }
    return MESSAGES.WARNINGS.AUTO_EXTRACTION;
  }
  /**
   * Validate YouTube URL and extract video ID
   */
  validateAndExtractVideoId(url) {
    if (!ValidationUtils.isValidYouTubeUrl(url)) {
      throw new Error(MESSAGES.ERRORS.INVALID_URL);
    }
    const videoId = this.extractVideoId(url);
    if (!videoId) {
      throw new Error(MESSAGES.ERRORS.INVALID_URL);
    }
    return videoId;
  }
  getCacheKey(namespace, videoId) {
    return `youtube-video-service:${namespace}:${videoId}`;
  }
};

// src/obsidian-file.ts
var import_obsidian6 = require("obsidian");
init_api();

// src/file-conflict-modal.ts
init_base_modal();
var COPY_WARNING = "A note with this title already exists. Choose how to proceed.";
var FileConflictModal = class extends BaseModal {
  constructor(app, file) {
    super(app);
    this.file = file;
    this.decision = "cancel";
  }
  onOpen() {
    this.createHeader("Note Already Exists");
    this.createMessage(`${COPY_WARNING}

Existing note: ${this.file.path}`);
    this.createButtons();
  }
  openAndWait() {
    return new Promise((resolve) => {
      this.resolve = resolve;
      this.forceVisible();
      this.open();
    });
  }
  onClose() {
    if (this.resolve) {
      this.resolve(this.decision);
    }
    super.onClose();
  }
  createButtons() {
    const container = this.createButtonContainer();
    this.createButton(container, "Cancel", false, () => {
      this.closeWithDecision("cancel");
    });
    this.createButton(container, "Save as Numbered Copy", false, () => {
      this.closeWithDecision("new-name");
    });
    this.createButton(container, "Overwrite Existing", true, () => {
      this.closeWithDecision("overwrite");
    });
  }
  closeWithDecision(decision) {
    this.decision = decision;
    this.close();
  }
};

// src/obsidian-file.ts
var ObsidianFileService = class {
  constructor(app) {
    this.app = app;
  }
  /**
   * Save content to a file in the vault
   */
  async saveToFile(title, content, outputPath) {
    try {
      const filename = this.createSafeFilename(title);
      const normalizedBase = this.normalizePath(outputPath);
      await this.ensureDirectoryExists(normalizedBase);
      const dailyFolder = this.getDailyFolderPath(normalizedBase);
      await this.ensureDirectoryExists(dailyFolder);
      const filePath = `${dailyFolder}/${filename}`;
      const finalPath = await this.handleFileConflicts(filePath, content);
      return finalPath;
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.SAVE_FILE(error.message));
    }
  }
  /**
   * Open a file with user confirmation
   */
  async openFileWithConfirmation(file) {
    await this.waitForFileCreation();
    try {
      const currentFile = this.app.vault.getAbstractFileByPath(file.path);
      if (!(currentFile instanceof import_obsidian6.TFile)) {
        throw new Error(MESSAGES.ERRORS.FILE_NOT_EXISTS);
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(currentFile);
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.COULD_NOT_OPEN(error.message));
    }
  }
  /**
   * Create a safe filename from title
   */
  createSafeFilename(title) {
    const sanitized = ValidationUtils.sanitizeFilename(title);
    return `${sanitized}.md`;
  }
  /**
   * Ensure the output directory exists
   */
  async ensureDirectoryExists(outputPath) {
    try {
      await this.app.vault.createFolder(outputPath);
    } catch (error) {
    }
  }
  getDailyFolderPath(basePath) {
    const trimmedBase = basePath.replace(/\/+$/, "");
    const today = new Date().toISOString().split("T")[0];
    return `${trimmedBase}/${today}`;
  }
  /**
   * Handle file naming conflicts by adding timestamp
   */
  async handleFileConflicts(filePath, content) {
    const existingFile = this.app.vault.getAbstractFileByPath(filePath);
    if (existingFile instanceof import_obsidian6.TFile) {
      const decision = await this.promptConflictResolution(existingFile);
      switch (decision) {
        case "overwrite":
          await this.app.vault.modify(existingFile, content);
          return existingFile.path;
        case "new-name":
          return this.createVersionedCopy(existingFile.path, content);
        default:
          throw new Error("Save cancelled by user");
      }
    }
    await this.app.vault.create(filePath, content);
    return filePath;
  }
  /**
   * Wait for file creation to complete
   */
  async waitForFileCreation() {
    return new Promise(
      (resolve) => setTimeout(resolve, TIMEOUTS.FILE_CREATION_WAIT)
    );
  }
  /**
   * Get file by path with validation
   */
  getFileByPath(filePath) {
    const file = this.app.vault.getAbstractFileByPath(filePath);
    return file instanceof import_obsidian6.TFile ? file : null;
  }
  /**
   * Check if file exists at path
   */
  fileExists(filePath) {
    return this.getFileByPath(filePath) !== null;
  }
  /**
   * Create a file with unique naming
   */
  async createUniqueFile(basePath, content) {
    let counter = 1;
    let filePath = basePath;
    while (this.fileExists(filePath)) {
      const pathParts = basePath.split("/");
      const filename = pathParts.pop();
      const nameWithoutExt = filename.replace(".md", "");
      const newFilename = `${nameWithoutExt} (${counter}).md`;
      filePath = [...pathParts, newFilename].join("/");
      counter++;
    }
    await this.app.vault.create(filePath, content);
    return filePath;
  }
  async promptConflictResolution(file) {
    const modal = new FileConflictModal(this.app, file);
    const decision = await modal.openAndWait();
    return decision;
  }
  async createVersionedCopy(originalPath, content) {
    const pathParts = originalPath.split("/");
    const filename = pathParts.pop();
    const nameWithoutExt = filename.replace(".md", "");
    let counter = 1;
    let candidatePath;
    do {
      candidatePath = [...pathParts, `${nameWithoutExt} (${counter}).md`].join("/");
      counter++;
    } while (this.fileExists(candidatePath));
    await this.app.vault.create(candidatePath, content);
    return candidatePath;
  }
  normalizePath(path) {
    if (!path) {
      return "";
    }
    let normalized = path.trim();
    if (normalized.startsWith("./")) {
      normalized = normalized.slice(2);
    }
    while (normalized.startsWith("/")) {
      normalized = normalized.slice(1);
    }
    normalized = normalized.replace(/\/+/g, "/");
    return normalized;
  }
};

// src/services/prompt-service.ts
var _AIPromptService = class {
  /**
   * Create analysis prompt for YouTube video content with performance optimization
   */
  createAnalysisPrompt(videoData, videoUrl, format = "detailed-guide", customPrompt, performanceMode = "balanced") {
    if (customPrompt && customPrompt.trim()) {
      return this.applyCustomPrompt(customPrompt, videoData, videoUrl);
    }
    let baseTemplate;
    switch (performanceMode) {
      case "fast":
        baseTemplate = _AIPromptService.COMPACT_BASE_TEMPLATE;
        break;
      case "quality":
        baseTemplate = _AIPromptService.COMPREHENSIVE_BASE_TEMPLATE;
        break;
      default:
        baseTemplate = _AIPromptService.BALANCED_BASE_TEMPLATE;
    }
    const baseContent = baseTemplate.replace("{{TITLE}}", videoData.title).replace("{{URL}}", videoUrl).replace("{{DESCRIPTION}}", videoData.description);
    switch (format) {
      case "executive-summary":
        return this.createExecutiveSummaryPrompt(baseContent, videoUrl, performanceMode);
      case "brief":
        return this.createBriefPrompt(baseContent, videoUrl, performanceMode);
      case "detailed-guide":
      default:
        return this.createDetailedGuidePrompt(baseContent, videoUrl, performanceMode);
    }
  }
  /**
   * Apply custom prompt template with placeholder substitution
   */
  applyCustomPrompt(customPrompt, videoData, videoUrl) {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return customPrompt.replace(/__VIDEO_TITLE__/g, videoData.title).replace(/__VIDEO_DESCRIPTION__/g, videoData.description).replace(/__VIDEO_URL__/g, videoUrl).replace(/__VIDEO_ID__/g, videoId || "unknown").replace(/__EMBED_URL__/g, embedUrl).replace(/__DATE__/g, new Date().toISOString().split("T")[0]).replace(/__TIMESTAMP__/g, new Date().toISOString());
  }
  /**
   * Create a brief prompt: short description plus resources list
   */
  createBriefPrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return `${baseContent}

        OUTPUT FORMAT - BRIEF DESCRIPTION + RESOURCES:

        Use this EXACT template:

        ---
        title: {Video Title}
        source: ${videoUrl}
        created: "${new Date().toISOString().split("T")[0]}"
        modified: "${new Date().toISOString().split("T")[0]}"
        description: "One short paragraph (3-4 sentences) summarizing the video"
        type: youtube-note
        format: brief
        tags:
          - youtube
          - brief
        status: processed
        duration: "[Extract video duration]"
        channel: "[Extract channel name]"
        video_id: "${videoId || "unknown"}"
        processing_date: "${new Date().toISOString()}"
    ai_provider: "__AI_PROVIDER__"
    ai_model: "__AI_MODEL__"
        ---

        <iframe width="640" height="360" src="${embedUrl}" title="{Video Title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

        ---

        ## Brief Description
        [Provide a concise 3-4 sentence description that captures the core message of the video]

        ## Key Takeaways
        - **[Takeaway 1]**: [Core insight or lesson from the video]
        - **[Takeaway 2]**: [Core insight or lesson from the video]
        - **[Takeaway 3]**: [Core insight or lesson from the video]

        ## Quick Actions
        1. **[Immediate Action]**: [Specific action you can take right away]
        2. **[Next Step]**: [Follow-up action to apply what you learned]

        ## Resources
        - **Original Video:** [Watch on YouTube](${videoUrl})
        - **Channel:** [Creator's Channel](https://youtube.com/channel/[extract-channel-id])
        - **Top resources mentioned or related (links):**
          - [Resource 1]
          - [Resource 2]
          - [Resource 3]

        IMPORTANT: Keep the Brief Description short and focused. Provide 2-3 high-quality resource links that help the reader explore the topic further. Action items should be simple and immediately applicable.`;
  }
  /**
   * Create executive summary prompt (250 words, tech/developer focused)
   */
  createExecutiveSummaryPrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    const modeMap = {
      "fast": "Fast Mode: transcript only",
      "balanced": "Balanced Mode: transcript + primary visuals",
      "quality": "Quality Mode: full multimodal analysis (audio, visuals, diagrams, slides, demonstrations)"
    };
    const processingMode = modeMap[performanceMode] || modeMap["balanced"];
    return `## \u{1F3AF} YouTube \u2192 Obsidian Executive Summary Prompt (Tech/Developer Focus)

**ROLE:**
You are an expert technical analyst and executive summarizer. Your task is to extract high-value strategic insights from a technology-focused YouTube video and produce a concise, structured note for Obsidian.

---

Use this EXACT template:

---
title: {{TITLE}}
source: ${videoUrl}
created: "${new Date().toISOString().split("T")[0]}"
modified: "${new Date().toISOString().split("T")[0]}"
description: "Single sentence capturing the core insight"
type: youtube-note
format: executive-summary
tags:
  - youtube
  - executive-summary
  - technology
  - strategy
status: processed
duration: "[Extract video duration]"
channel: "[Extract channel name]"
video_id: "${videoId || "unknown"}"
processing_date: "${new Date().toISOString()}"
word_count: 250
ai_provider: "__AI_PROVIDER__"
ai_model: "__AI_MODEL__"
---

<div style="text-align: center; margin-bottom: 24px;">
<iframe width="640" height="360" src="${embedUrl}" title="{{TITLE}}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
</div>

---

# \u{1F4CA} Executive Summary

The video discusses [explain the main problem/opportunity and the central argument of the video].

Key concepts include [summarize the most important concepts, frameworks, or differentiators that create impact].

To implement these insights, [provide recommendations, risks, and priority actions based on the insights].

> **\u{1F4A1} Focus:** Strategic value over narrative recap - prioritize actionable insights.

---

## \u{1F3AF} Key Strategic Insights

### \u{1F527} Technical Strategy
**[Critical insight with specific business impact and example from video]**

### \u{1F4A1} Design Thinking
**[Critical insight with specific business impact and example from video]**

### \u{1F4DA} Continuous Learning
**[Critical insight with specific business impact and example from video]**

> *Optional: Add 4\u20135 additional insights if they provide significant value.*

---

## \u{1F680} Action Plan & Implementation

### \u26A1 Immediate (0-30 days)
- **Action:** [Specific, measurable action]
- **Success Metric:** [Clear success criteria]

### \u{1F4C8} Short-term (1-3 months)
- **Action:** [Specific, measurable action]
- **Success Metric:** [Clear success criteria]

### \u{1F3AF} Mid-term (3-6 months)
- **Action:** [Specific, measurable action]
- **Success Metric:** [Clear success criteria]

### \u{1F52E} Long-term (6+ months)
- **Action:** [Specific, measurable action]
- **Success Metric:** [Clear success criteria]

> **\u2705 Requirement:** Each action item must include clear, measurable success criteria.

---

## \u{1F4DA} Curated Resources & References

### \u{1F3A5} Primary Sources
- **Original Video:** [Watch on YouTube](${videoUrl})
- **Channel:** [Creator's Channel](https://youtube.com/channel/[extract-channel-id])

### \u{1F6E0}\uFE0F Key Tools & Technologies
- [List main tools, frameworks, or technologies mentioned]

### \u{1F4D6} Official Documentation
- [Links to official documentation for mentioned technologies]

### \u{1F31F} Further Reading
- [1-2 high-quality related articles or resources for deep dive]

---

### Non-Negotiable Rules

- Executive Summary \u2264 250 words
- Insights & action items must reference the video
- Focus on strategy and developer/business value
- Avoid fluff and storytelling\u2014prioritize usable analysis

---

### Suggested Prompt Invocation

Analyze this YouTube video in **${processingMode}**:
Title: {{TITLE}}
URL: ${videoUrl}
Description: {{DESCRIPTION}}
Return a structured Obsidian-ready note with strategic insights and developer-aligned action steps.`;
  }
  /**
   * Create detailed guide prompt
   */
  createDetailedGuidePrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return `${baseContent}

        OUTPUT FORMAT - EFFICIENT STEP-BY-STEP TUTORIAL:

        Create a concise step-by-step tutorial following this structure:

        ---
        title: {{TITLE}}
        source: ${videoUrl}
        created: "${new Date().toISOString().split("T")[0]}"
        type: youtube-tutorial
        format: step-by-step
        tags: [youtube, tutorial, implementation, practical]
        status: processed
        channel: "[Extract channel name]"
        video_id: "${videoId || "unknown"}"
        ai_provider: "__AI_PROVIDER__"
        ai_model: "__AI_MODEL__"
        ---

        <div style="text-align: center; margin-bottom: 24px;">
        <iframe width="640" height="360" src="${embedUrl}" title="{{TITLE}}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>

        ---

        # [Title] - Practical Tutorial

        ## Overview
        **Goal:** [Main learning objective]
        **Duration:** [Estimated time]
        **Level:** [Difficulty]

        **Video:** [{{TITLE}}](${videoUrl})

        ## Prerequisites
        - [Requirement 1]
        - [Requirement 2]
        - [Requirement 3]

        ## Step-by-Step Guide

        ### Step 1: [Action/Setup]
        **Objective:** [Clear goal]

        **Actions:**
        1. [Specific instruction]
        2. [Follow-up instruction]
        3. [Verification step]

        \u2705 **Success:** [How to confirm it worked]

        ### Step 2: [Core Implementation]
        **Objective:** [Clear goal]

        [Continue with remaining steps...]

        ### Step 3: [Final Touches]
        **Objective:** [Clear goal]

        ## Learning Outcomes
        Upon completion, you will:
- [Achieved skill 1]
- [Achieved skill 2]
- [Achieved skill 3]

        ## Required Tools
        - **[Tool/Resource 1]:** [Where to get it]
        - **[Tool/Resource 2]:** [Where to get it]

        ## Pro Tips
        \u{1F4A1} **Tip 1:** [Key insight from video]
        \u{1F4A1} **Tip 2:** [Best practice]
        \u26A0\uFE0F **Avoid:** [Common mistake]

        ## Verification
        **Final Check:** [How to verify complete success]
        **Expected Result:** [What you should see/accomplish]

              *Generated from YouTube video content*`;
  }
  /**
   * Process AI response and inject provider information
   */
  processAIResponse(content, provider, model, format) {
    if (!content) {
      return content;
    }
    const providerValue = provider || "unknown";
    const modelValue = model || "unknown";
    let updatedContent = content.replace(/__AI_PROVIDER__/g, providerValue).replace(/__AI_MODEL__/g, modelValue);
    updatedContent = this.ensureFrontMatterValue(updatedContent, "ai_provider", providerValue);
    updatedContent = this.ensureFrontMatterValue(updatedContent, "ai_model", modelValue);
    return updatedContent;
  }
  ensureFrontMatterValue(content, key, value) {
    const pattern = new RegExp(`(${key}\\s*:\\s*)(["'])?([^"'\\n]*)(["'])?`, "i");
    if (pattern.test(content)) {
      return content.replace(pattern, (_, prefix, openingQuote, _existing, closingQuote) => {
        const quote = openingQuote || closingQuote ? '"' : "";
        return `${prefix}${quote}${value}${quote}`;
      });
    }
    if (content.startsWith("---")) {
      return content.replace(/^---\s*\n/, `---
${key}: "${value}"
`);
    }
    return content;
  }
  /**
   * Create a summary prompt for shorter content
   */
  createSummaryPrompt(videoData, videoUrl) {
    return `Create a concise summary for this YouTube video:

        Title: ${videoData.title}
        URL: ${videoUrl}
        Description: ${videoData.description}

        Please provide:
        1. A 2-paragraph summary (max 250 words)
        2. 3-5 key takeaways
        3. Main actionable insights

        Format as markdown with clear headings.`;
  }
  /**
   * Validate prompt length and content
   */
  validatePrompt(prompt) {
    return Boolean(prompt) && typeof prompt === "string" && prompt.trim().length > 10 && prompt.length < 5e4;
  }
};
var AIPromptService = _AIPromptService;
// Optimized prompt templates for different performance modes
AIPromptService.COMPACT_BASE_TEMPLATE = `Analyze this YouTube video:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

Focus on extracting the key information and insights.`;
AIPromptService.BALANCED_BASE_TEMPLATE = `Analyze this YouTube video with multimodal analysis:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

Extract insights from both spoken content and visual elements, focusing on practical information.`;
AIPromptService.COMPREHENSIVE_BASE_TEMPLATE = `Analyze this YouTube video using comprehensive multimodal analysis:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

MULTIMODAL ANALYSIS INSTRUCTIONS:
1. Watch the complete video using both audio and visual analysis capabilities
2. Extract insights from spoken content, music, sound effects, and ambient audio
3. Analyze visual elements including slides, diagrams, charts, body language, and demonstrations
4. Focus on practical, action-oriented information with specific examples
5. Maintain accuracy and cite specific examples from the video when relevant`;

// src/services/cache/memory-cache.ts
var MemoryCacheService = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
    this.defaultTTL = 3e5;
    // 5 minutes
    this.lastCleanup = 0;
    this.CLEANUP_INTERVAL = 6e4;
  }
  // 1 minute
  /**
   * Get item from cache (optimized with lazy cleanup)
   */
  get(key) {
    var _a;
    if (this.cache.size > 50) {
      this.cleanup();
    }
    const item = this.cache.get(key);
    if (!item)
      return null;
    const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
    if (Date.now() - item.timestamp > ttl) {
      this.cache.delete(key);
      return null;
    }
    return item.data;
  }
  /**
   * Set item in cache
   */
  set(key, data, ttl) {
    this.cache.set(key, {
      data,
      timestamp: Date.now(),
      ttl
    });
  }
  /**
   * Clear all cache items
   */
  clear() {
    this.cache.clear();
  }
  /**
   * Delete specific cache item
   */
  delete(key) {
    return this.cache.delete(key);
  }
  /**
   * Check if key exists in cache
   */
  has(key) {
    var _a;
    const item = this.cache.get(key);
    if (!item) {
      return false;
    }
    const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
    if (Date.now() - item.timestamp > ttl) {
      this.cache.delete(key);
      return false;
    }
    return true;
  }
  /**
   * Get cache size
   */
  size() {
    return this.cache.size;
  }
  /**
   * Clean up expired items (optimized with batched operations)
   */
  cleanup() {
    var _a;
    const now = Date.now();
    if (now - this.lastCleanup < this.CLEANUP_INTERVAL)
      return;
    this.lastCleanup = now;
    const expiredKeys = [];
    for (const [key, item] of this.cache.entries()) {
      const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
      if (now - item.timestamp > ttl) {
        expiredKeys.push(key);
      }
    }
    expiredKeys.forEach((key) => this.cache.delete(key));
  }
};

// src/services/service-container.ts
var ServiceContainer = class {
  constructor(settings, app) {
    this.settings = settings;
    this.app = app;
  }
  get aiService() {
    if (!this._aiService) {
      const providers = [];
      if (this.settings.geminiApiKey) {
        providers.push(new GeminiProvider(this.settings.geminiApiKey));
      }
      if (this.settings.groqApiKey) {
        providers.push(new GroqProvider(this.settings.groqApiKey));
      }
      this._aiService = new AIService(providers, this.settings);
    }
    return this._aiService;
  }
  get videoService() {
    if (!this._videoService) {
      this._videoService = new YouTubeVideoService(this.cacheService);
    }
    return this._videoService;
  }
  get fileService() {
    if (!this._fileService) {
      this._fileService = new ObsidianFileService(this.app);
    }
    return this._fileService;
  }
  get cacheService() {
    if (!this._cacheService) {
      this._cacheService = new MemoryCacheService();
    }
    return this._cacheService;
  }
  get promptService() {
    if (!this._promptService) {
      this._promptService = new AIPromptService();
    }
    return this._promptService;
  }
  /**
   * Update settings and refresh services that depend on them
   */
  async updateSettings(newSettings) {
    this.settings = newSettings;
    this._aiService = void 0;
  }
  /**
   * Clear all cached services
   */
  clearServices() {
    this._aiService = void 0;
    this._videoService = void 0;
    this._fileService = void 0;
    this._cacheService = void 0;
    this._promptService = void 0;
  }
};

// src/main.ts
var PLUGIN_PREFIX = "ytp";
var DEFAULT_SETTINGS = {
  geminiApiKey: "",
  groqApiKey: "",
  outputPath: "YouTube/Processed Videos",
  useEnvironmentVariables: false,
  environmentPrefix: "YTC",
  // Performance settings with smart defaults
  performanceMode: "balanced",
  enableParallelProcessing: true,
  preferMultimodal: true
};
var YoutubeClipperPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.settings = DEFAULT_SETTINGS;
    this.isUnloading = false;
    this.operationCount = 0;
    // Track temp notes we've already handled to avoid duplicate modal opens
    this.handledTempFiles = /* @__PURE__ */ new Set();
    // Track modal instances to prevent double opening
    this.isModalOpen = false;
  }
  async onload() {
    var _a;
    this.logInfo("Initializing YoutubeClipper Plugin v1.2.0...");
    const conflicts = ConflictPrevention.checkForPotentialConflicts();
    if (conflicts.length > 0) {
      this.logWarning(`Potential conflicts detected but proceeding: ${conflicts.join(", ")}`);
    }
    try {
      await this.loadSettings();
      await this.initializeServices();
      this.registerUIComponents();
      const NOTE_MARKER = "<!-- ytc-extension:youtube-clipper -->";
      const pendingUrls = /* @__PURE__ */ new Map();
      const URL_HANDLER_DELAY = 500;
      const isTempFile = (file, content) => {
        if (content && content.includes(NOTE_MARKER)) {
          return true;
        }
        if (file.name && file.name.startsWith("YouTube Clip -")) {
          return true;
        }
        const trimmedContent = content.trim();
        const lines = trimmedContent.split("\n").filter((line) => line.trim().length > 0);
        const isUrlOnly = lines.length === 1 && ValidationUtils.isValidYouTubeUrl(lines[0]);
        if (isUrlOnly && content.length < 200) {
          const fileAge = Date.now() - file.stat.ctime;
          const isInOutputPath = file.path.includes(this.settings.outputPath);
          if (fileAge < 5e3 && !isInOutputPath) {
            return true;
          }
        }
        return false;
      };
      const handleUrlSafely = (url, source, filePath, file, content) => {
        var _a2;
        console.log(`YouTubeClipper: ${source} - handleUrlSafely called for URL:`, url, "file:", filePath);
        if (file && content && !isTempFile(file, content)) {
          console.warn(`YouTubeClipper: ${source} - REJECTING URL in non-temp file: ${filePath}`);
          const fileAge = Date.now() - file.stat.ctime;
          const isInOutputPath = filePath == null ? void 0 : filePath.includes(this.settings.outputPath);
          const hasMarker = content.includes(NOTE_MARKER);
          const hasClipPrefix = (_a2 = file.name) == null ? void 0 : _a2.startsWith("YouTube Clip -");
          console.warn(`YouTubeClipper: ${source} - Rejection details: age=${fileAge}ms, inOutputPath=${isInOutputPath}, hasMarker=${hasMarker}, hasClipPrefix=${hasClipPrefix}`);
          return;
        }
        if (this.handledTempFiles.has(url)) {
          console.log(`YouTubeClipper: ${source} - URL already handled: ${url}, skipping`);
          return;
        }
        if (pendingUrls.has(url)) {
          console.log(`YouTubeClipper: ${source} - cancelling pending handler for URL:`, url);
          clearTimeout(pendingUrls.get(url));
        }
        this.handledTempFiles.add(url);
        if (filePath) {
          this.handledTempFiles.add(filePath);
        }
        console.log(`YouTubeClipper: ${source} - marked URL as handled:`, url);
        const timeout = setTimeout(() => {
          console.log(`YouTubeClipper: ${source} - DEBOUNCED: opening modal for URL: ${url}`);
          console.log(`YouTubeClipper: ${source} - pendingUrls size before:`, pendingUrls.size);
          console.log(`YouTubeClipper: ${source} - handledTempFiles size:`, this.handledTempFiles.size);
          void this.safeShowUrlModal(url);
          pendingUrls.delete(url);
          console.log(`YouTubeClipper: ${source} - pendingUrls size after:`, pendingUrls.size);
          if (this.handledTempFiles.size > 100) {
            const entries = Array.from(this.handledTempFiles);
            this.handledTempFiles.clear();
            entries.slice(-50).forEach((entry) => this.handledTempFiles.add(entry));
            console.log(`YouTubeClipper: ${source} - cleaned up handledTempFiles, new size:`, this.handledTempFiles.size);
          }
        }, URL_HANDLER_DELAY);
        pendingUrls.set(url, timeout);
        console.log(`YouTubeClipper: ${source} - set timeout for URL:`, url, "delay:", URL_HANDLER_DELAY);
      };
      this.registerEvent(this.app.vault.on("create", async (file) => {
        try {
          if (!(file instanceof import_obsidian7.TFile))
            return;
          const content = await this.app.vault.read(file);
          if (!isTempFile(file, content)) {
            console.debug("YouTubeClipper: create handler - ignoring existing file:", file.path);
            return;
          }
          let url = null;
          if (content && content.includes(NOTE_MARKER)) {
            url = content.replace(NOTE_MARKER, "").trim();
          } else {
            const maybe = (content || "").trim();
            const ytRegex = /(https?:\/\/(?:www\.)?youtube\.com\/watch\?v=[A-Za-z0-9_-]{6,}|https?:\/\/(?:www\.)?youtu\.be\/[A-Za-z0-9_-]{6,})/i;
            const m = maybe.match(ytRegex);
            if (m && m[1]) {
              url = m[1].trim();
            } else if (file.name && file.name.startsWith("YouTube Clip -")) {
              const single = maybe.split("\n").map((s) => s.trim()).find(Boolean) || "";
              if (ValidationUtils.isValidYouTubeUrl(single))
                url = single;
            }
          }
          if (!url) {
            console.debug("YouTubeClipper: create handler - no url extracted for temp file:", file.path);
            return;
          }
          console.log("YouTubeClipper: CREATE EVENT - detected temp note", { path: file.path, url });
          handleUrlSafely(url, "create-handler", file.path, file, content);
        } catch (e) {
        }
      }));
      this.registerEvent(this.app.workspace.on("active-leaf-change", async () => {
        try {
          const file = this.app.workspace.getActiveFile();
          if (!file || !(file instanceof import_obsidian7.TFile))
            return;
          if (this.handledTempFiles.has(file.path))
            return;
          const content = await this.app.vault.read(file);
          if (!isTempFile(file, content)) {
            console.debug("YouTubeClipper: active-leaf-change - ignoring existing file:", file.path);
            return;
          }
          let url = null;
          if (content && content.includes(NOTE_MARKER)) {
            url = content.replace(NOTE_MARKER, "").trim();
          } else {
            const maybe = (content || "").trim();
            const ytRegex = /(https?:\/\/(?:www\.)?youtube\.com\/watch\?v=[A-Za-z0-9_-]{6,}|https?:\/\/(?:www\.)?youtu\.be\/[A-Za-z0-9_-]{6,})/i;
            const m = maybe.match(ytRegex);
            if (m && m[1]) {
              url = m[1].trim();
            } else if (file.name && file.name.startsWith("YouTube Clip -")) {
              const single = maybe.split("\n").map((s) => s.trim()).find(Boolean) || "";
              if (ValidationUtils.isValidYouTubeUrl(single))
                url = single;
            }
          }
          if (!url) {
            console.debug("YouTubeClipper: active-leaf-change - no url for temp file:", file.path);
            return;
          }
          console.log("YouTubeClipper: ACTIVE-LEAF-CHANGE EVENT - detected temp note", { path: file.path, url });
          handleUrlSafely(url, "active-leaf-handler", file.path, file, content);
        } catch (e) {
        }
      }));
      this.logInfo("YoutubeClipper Plugin loaded successfully");
      try {
        (_a = this.registerObsidianProtocolHandler) == null ? void 0 : _a.call(this, "youtube-clipper", (params) => {
          try {
            const url = params.url || params.content || params.path || "";
            if (url && ValidationUtils.isValidYouTubeUrl(url)) {
              setTimeout(() => {
                void this.safeShowUrlModal(url);
              }, 200);
            } else {
              console.debug("YouTubeClipper: protocol handler received no valid url", params);
            }
          } catch (e) {
            console.warn("YouTubeClipper: protocol handler error", e);
          }
        });
      } catch (e) {
      }
    } catch (error) {
      this.logError("Failed to load plugin", error);
      ErrorHandler.handle(error, "Plugin initialization");
      new import_obsidian7.Notice("Failed to load YoutubeClipper Plugin. Check console for details.");
    }
  }
  onunload() {
    var _a;
    this.logInfo("Unloading YoutubeClipper Plugin...");
    this.isUnloading = true;
    try {
      this.isModalOpen = false;
      this.pendingModalUrl = void 0;
      (_a = this.serviceContainer) == null ? void 0 : _a.clearServices();
      this.cleanupUIElements();
      ConflictPrevention.cleanupAllElements();
      this.logInfo("YoutubeClipper Plugin unloaded successfully");
    } catch (error) {
      this.logError("Error during plugin unload", error);
    }
  }
  async initializeServices() {
    this.serviceContainer = new ServiceContainer(this.settings, this.app);
  }
  registerUIComponents() {
    this.ribbonIcon = this.addRibbonIcon("film", "Process YouTube Video", () => {
      void this.safeShowUrlModal();
    });
    console.log("YouTubeClipper: Ribbon icon set successfully");
    this.addCommand({
      id: `${PLUGIN_PREFIX}-process-youtube-video`,
      name: "Process YouTube Video",
      callback: () => {
        void this.safeShowUrlModal();
      }
    });
    this.addSettingTab(new YouTubeSettingsTab(this.app, {
      plugin: this,
      onSettingsChange: this.handleSettingsChange.bind(this)
    }));
    this.addCommand({
      id: `${PLUGIN_PREFIX}-open-url-from-clipboard`,
      name: "YouTube Clipper: Open URL Modal (from clipboard)",
      callback: async () => {
        try {
          let text = "";
          try {
            if (navigator && navigator.clipboard && navigator.clipboard.readText) {
              text = await navigator.clipboard.readText() || "";
            }
          } catch (e) {
            text = "";
          }
          if (text && ValidationUtils.isValidYouTubeUrl(text.trim())) {
            void this.safeShowUrlModal(text.trim());
            return;
          }
          const manual = window.prompt("Paste YouTube URL to open in YouTube Clipper:");
          if (manual && ValidationUtils.isValidYouTubeUrl(manual.trim())) {
            void this.safeShowUrlModal(manual.trim());
          } else {
            new import_obsidian7.Notice("No valid YouTube URL provided.");
          }
        } catch (error) {
          ErrorHandler.handle(error, "Open URL from clipboard");
        }
      }
    });
  }
  cleanupUIElements() {
    if (this.ribbonIcon) {
      this.ribbonIcon.remove();
      this.ribbonIcon = void 0;
    }
  }
  async safeShowUrlModal(initialUrl) {
    const callId = Math.random().toString(36).substr(2, 9);
    console.log(`YouTubeClipper [${callId}]: safeShowUrlModal called with URL:`, initialUrl);
    console.log(`YouTubeClipper [${callId}]: Current modal state - isModalOpen:`, this.isModalOpen, "pendingModalUrl:", this.pendingModalUrl);
    await this.safeOperation(async () => {
      if (this.isModalOpen) {
        console.warn(`YouTubeClipper [${callId}]: MODAL ALREADY OPEN - IGNORING request for:`, initialUrl);
        console.warn(`YouTubeClipper [${callId}]: Current pending URL:`, this.pendingModalUrl);
        if (initialUrl && initialUrl !== this.pendingModalUrl) {
          console.warn(`YouTubeClipper [${callId}]: Updating pending modal URL from:`, this.pendingModalUrl, "to:", initialUrl);
          this.pendingModalUrl = initialUrl;
        } else {
          console.warn(`YouTubeClipper [${callId}]: Same URL as pending, completely ignoring`);
        }
        return;
      }
      console.log(`YouTubeClipper [${callId}]: Setting isModalOpen = true for URL:`, initialUrl);
      this.isModalOpen = true;
      this.pendingModalUrl = initialUrl;
      console.log(`YouTubeClipper [${callId}]: About to open YouTubeUrlModal for URL:`, initialUrl);
      this.openYouTubeUrlModal(initialUrl);
      setTimeout(() => {
        console.log(`YouTubeClipper [${callId}]: Modal state after 100ms - isModalOpen:`, this.isModalOpen);
      }, 100);
    }, "Show URL Modal");
  }
  async safeOperation(operation, operationName) {
    if (this.isUnloading) {
      this.logWarning(`Attempted ${operationName} during plugin unload - skipping`);
      return null;
    }
    const opId = ++this.operationCount;
    this.logInfo(`Starting operation ${opId}: ${operationName}`);
    try {
      const result = await operation();
      this.logInfo(`Completed operation ${opId}: ${operationName}`);
      return result;
    } catch (error) {
      this.logError(`Failed operation ${opId}: ${operationName}`, error);
      ErrorHandler.handle(error, operationName);
      return null;
    }
  }
  openYouTubeUrlModal(initialUrl) {
    if (this.isUnloading) {
      ConflictPrevention.log("Plugin is unloading, ignoring modal request");
      return;
    }
    ConflictPrevention.safeOperation(async () => {
      var _a;
      const aiService = (_a = this.serviceContainer) == null ? void 0 : _a.aiService;
      const providers = aiService ? aiService.getProviderNames() : [];
      const modelOptionsMap = this.settings.modelOptionsCache || {};
      if (aiService && (!this.settings.modelOptionsCache || Object.keys(this.settings.modelOptionsCache).length === 0)) {
        for (const p of providers) {
          modelOptionsMap[p] = aiService.getProviderModels(p) || [];
        }
      }
      const modal = new YouTubeUrlModal(this.app, {
        onProcess: this.processYouTubeVideo.bind(this),
        onOpenFile: this.openFileByPath.bind(this),
        initialUrl,
        providers,
        modelOptions: modelOptionsMap,
        fetchModels: async () => {
          try {
            const map = await this.serviceContainer.aiService.fetchLatestModels();
            this.settings.modelOptionsCache = map;
            await this.saveSettings();
            return map;
          } catch (error) {
            return modelOptionsMap;
          }
        },
        // Performance settings from plugin settings
        performanceMode: this.settings.performanceMode || "balanced",
        enableParallelProcessing: this.settings.enableParallelProcessing || false,
        preferMultimodal: this.settings.preferMultimodal || false,
        onPerformanceSettingsChange: async (performanceMode, enableParallel, preferMultimodal) => {
          this.settings.performanceMode = performanceMode;
          this.settings.enableParallelProcessing = enableParallel;
          this.settings.preferMultimodal = preferMultimodal;
          await this.saveSettings();
          this.serviceContainer = new ServiceContainer(this.settings, this.app);
        }
      });
      modal.onClose = () => {
        try {
          console.log(`YouTubeClipper: Modal onClose triggered for URL:`, initialUrl);
          console.log(`YouTubeClipper: Modal state before close - isModalOpen:`, this.isModalOpen, "pendingModalUrl:", this.pendingModalUrl);
          this.isModalOpen = false;
          this.pendingModalUrl = void 0;
          console.log(`YouTubeClipper: Modal state after close - isModalOpen:`, this.isModalOpen, "pendingModalUrl:", this.pendingModalUrl);
        } catch (error) {
          console.warn("YouTubeClipper: Error resetting modal state:", error);
          this.isModalOpen = false;
          this.pendingModalUrl = void 0;
          console.log(`YouTubeClipper: Force reset modal state after error - isModalOpen:`, this.isModalOpen);
        }
      };
      setTimeout(() => {
        if (this.isModalOpen && this.pendingModalUrl === initialUrl) {
          console.warn("YouTubeClipper: Fallback modal state reset triggered for URL:", initialUrl);
          this.isModalOpen = false;
          this.pendingModalUrl = void 0;
          console.log("YouTubeClipper: Modal state after fallback reset - isModalOpen:", this.isModalOpen);
        }
      }, 1e4);
      modal.open();
    }, "YouTube URL Modal").catch((error) => {
      ErrorHandler.handle(error, "Opening YouTube URL modal");
    });
  }
  async processYouTubeVideo(url, format = "detailed-guide", providerName, model, customPrompt, performanceMode, enableParallel, preferMultimodal) {
    if (this.isUnloading) {
      ConflictPrevention.log("Plugin is unloading, cancelling video processing");
      throw new Error("Plugin is shutting down");
    }
    const result = await ConflictPrevention.safeOperation(async () => {
      var _a, _b;
      new import_obsidian7.Notice(MESSAGES.PROCESSING);
      const validation = ValidationUtils.validateSettings(this.settings);
      if (!validation.isValid) {
        throw new Error(`Configuration invalid: ${validation.errors.join(", ")}`);
      }
      const youtubeService = this.serviceContainer.videoService;
      const aiService = this.serviceContainer.aiService;
      const fileService = this.serviceContainer.fileService;
      const promptService = this.serviceContainer.promptService;
      const videoId = youtubeService.extractVideoId(url);
      if (!videoId) {
        throw new Error(MESSAGES.ERRORS.VIDEO_ID_EXTRACTION);
      }
      const videoData = await youtubeService.getVideoData(videoId);
      let promptToUse;
      if (format === "custom") {
        promptToUse = customPrompt;
      } else {
        promptToUse = (_a = this.settings.customPrompts) == null ? void 0 : _a[format];
      }
      const prompt = promptService.createAnalysisPrompt(videoData, url, format, promptToUse);
      console.log("AI Processing Debug:");
      console.log("- Provider selected:", providerName || "Auto");
      console.log("- Model override:", model || "Default");
      console.log("- Providers available:", aiService.getProviderNames());
      let aiResponse;
      try {
        if (providerName) {
          console.log(`Processing with provider: ${providerName}, model: ${model || "default"}`);
          aiResponse = await aiService.processWith(providerName, prompt, model);
        } else {
          console.log("Processing with auto-selected provider");
          aiResponse = await aiService.process(prompt);
        }
        console.log("AI Response received:", {
          provider: aiResponse.provider,
          model: aiResponse.model,
          contentLength: ((_b = aiResponse.content) == null ? void 0 : _b.length) || 0
        });
      } catch (error) {
        console.error("AI Processing failed:", error);
        throw error;
      }
      const formattedContent = promptService.processAIResponse(
        aiResponse.content,
        aiResponse.provider,
        aiResponse.model,
        format,
        videoData,
        url
      );
      const filePath = await fileService.saveToFile(
        videoData.title,
        formattedContent,
        this.settings.outputPath
      );
      new import_obsidian7.Notice(MESSAGES.SUCCESS(videoData.title));
      return filePath;
    }, "YouTube Video Processing");
    if (!result) {
      throw new Error("Failed to process YouTube video");
    }
    return result;
  }
  async openFileByPath(filePath) {
    try {
      await new Promise((resolve) => setTimeout(resolve, 300));
      const cleanPath = filePath.startsWith("/") ? filePath.substring(1) : filePath;
      const file = this.app.vault.getAbstractFileByPath(cleanPath);
      if (!file || !(file instanceof import_obsidian7.TFile)) {
        throw new Error(`File not found at path: ${cleanPath}`);
      }
      await this.openFileInNewTab(file);
    } catch (error) {
      ErrorHandler.handle(error, "Opening file by path");
      throw error;
    }
  }
  async openFileInNewTab(file) {
    try {
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
      this.app.workspace.setActiveLeaf(leaf);
      new import_obsidian7.Notice(`\u{1F4C2} Opened: ${file.name}`);
    } catch (error) {
      try {
        const currentLeaf = this.app.workspace.getLeaf(false);
        await currentLeaf.openFile(file);
        new import_obsidian7.Notice(`\u{1F4C2} Opened: ${file.name}`);
      } catch (fallbackError) {
        ErrorHandler.handle(fallbackError, "Opening file in current tab");
        new import_obsidian7.Notice(`Note saved as "${file.name}" but could not auto-open. Please open manually.`);
      }
    }
  }
  showPersistentSaveConfirmation(file) {
    try {
      const modal = new SaveConfirmationModal(this.app, file, (shouldOpen) => {
        if (shouldOpen) {
          void this.openFileInNewTab(file);
        }
      });
      modal.open();
    } catch (error) {
      ErrorHandler.handle(error, "Showing save confirmation");
      new import_obsidian7.Notice(`File saved: ${file.name}. Click to open.`, 0).noticeEl.onclick = () => {
        void this.openFileInNewTab(file);
      };
    }
  }
  async handleSettingsChange(newSettings) {
    var _a;
    try {
      this.settings = { ...newSettings };
      await this.saveSettings();
      await ((_a = this.serviceContainer) == null ? void 0 : _a.updateSettings(this.settings));
    } catch (error) {
      ErrorHandler.handle(error, "Settings update");
      throw error;
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getServiceContainer() {
    return this.serviceContainer;
  }
  logInfo(message) {
    ConflictPrevention.log(`[INFO] ${message}`);
  }
  logWarning(message) {
    ConflictPrevention.log(`[WARN] ${message}`, "warn");
  }
  logError(message, error) {
    ConflictPrevention.log(`[ERROR] ${message}: ${error.message}`, "error");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3N0eWxlcy50cyIsICJzcmMvZG9tLnRzIiwgInNyYy9hcGkudHMiLCAic3JjL2NvbmZpcm1hdGlvbi1tb2RhbC50cyIsICJzcmMvYmFzZS1tb2RhbC50cyIsICJzcmMvbWFpbi50cyIsICJzcmMvY29uZmxpY3QtcHJldmVudGlvbi50cyIsICJzcmMvbWVzc2FnZXMudHMiLCAic3JjL3ZhbGlkYXRpb24udHMiLCAic3JjL3NlcnZpY2VzL2Vycm9yLWhhbmRsZXIudHMiLCAic3JjL3NhdmUtY29uZmlybWF0aW9uLW1vZGFsLnRzIiwgInNyYy95b3V0dWJlLXVybC1tb2RhbC50cyIsICJzcmMvc2V0dGluZ3MtdGFiLnRzIiwgInNyYy9zZWN1cmUtY29uZmlnLnRzIiwgInNyYy9zZXJ2aWNlcy9haS1zZXJ2aWNlLnRzIiwgInNyYy9wZXJmb3JtYW5jZS50cyIsICJzcmMvZ2VtaW5pLnRzIiwgInNyYy9iYXNlLnRzIiwgInNyYy9ncm9xLnRzIiwgInNyYy92aWRlby1kYXRhLnRzIiwgInNyYy9zZXJ2aWNlcy90cmFuc2NyaXB0LXNlcnZpY2UudHMiLCAic3JjL29ic2lkaWFuLWZpbGUudHMiLCAic3JjL2ZpbGUtY29uZmxpY3QtbW9kYWwudHMiLCAic3JjL3NlcnZpY2VzL3Byb21wdC1zZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9jYWNoZS9tZW1vcnktY2FjaGUudHMiLCAic3JjL3NlcnZpY2VzL3NlcnZpY2UtY29udGFpbmVyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKipcbiAqIFVJIHN0eWxpbmcgY29uc3RhbnRzIHRvIGVsaW1pbmF0ZSBEUlkgdmlvbGF0aW9uc1xuICovXG5cbmV4cG9ydCBjb25zdCBNT0RBTF9TVFlMRVMgPSB7XG4gICAgekluZGV4OiAnMTAwMDAnLFxuICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICBoZWFkZXI6IHtcbiAgICAgICAgbWFyZ2luQm90dG9tOiAnMTVweCcsXG4gICAgICAgIGNvbG9yOiAndmFyKC0tdGV4dC1hY2NlbnQpJ1xuICAgIH0sXG4gICAgbWVzc2FnZToge1xuICAgICAgICBtYXJnaW5Cb3R0b206ICcyMHB4JyxcbiAgICAgICAgbGluZUhlaWdodDogJzEuNSdcbiAgICB9LFxuICAgIGJ1dHRvbkNvbnRhaW5lcjoge1xuICAgICAgICBtYXJnaW5Ub3A6ICcyMHB4JyxcbiAgICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgICBnYXA6ICcxMHB4JyxcbiAgICAgICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LWVuZCdcbiAgICB9LFxuICAgIGJ1dHRvbjoge1xuICAgICAgICBwYWRkaW5nOiAnOHB4IDE2cHgnLFxuICAgICAgICBtaW5XaWR0aDogJzEwMHB4J1xuICAgIH1cbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBJTlBVVF9TVFlMRVMgPSB7XG4gICAgd2lkdGg6ICcxMDAlJyxcbiAgICBtYXJnaW5Ub3A6ICc4cHgnLFxuICAgIHBhZGRpbmc6ICc4cHgnLFxuICAgIGJvcmRlcjogJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknLFxuICAgIGJvcmRlclJhZGl1czogJzRweCdcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBDT05UQUlORVJfU1RZTEVTID0ge1xuICAgIG1hcmdpblRvcDogJzIwcHgnXG59IGFzIGNvbnN0O1xuIiwgIi8qKlxuICogRE9NIG1hbmlwdWxhdGlvbiB1dGlsaXRpZXMgdG8gZWxpbWluYXRlIGNvZGUgZHVwbGljYXRpb25cbiAqL1xuXG5pbXBvcnQgeyBNT0RBTF9TVFlMRVMsIElOUFVUX1NUWUxFUyB9IGZyb20gJy4vc3R5bGVzJztcbmltcG9ydCB7IERPTVV0aWxzSW50ZXJmYWNlLCBTdHlsZU9iamVjdCB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgRE9NVXRpbHMgaW1wbGVtZW50cyBET01VdGlsc0ludGVyZmFjZSB7XG4gICAgLyoqXG4gICAgICogQXBwbHkgc3R5bGVzIHRvIGFuIEhUTUwgZWxlbWVudFxuICAgICAqL1xuICAgIHN0YXRpYyBhcHBseVN0eWxlcyhlbGVtZW50OiBIVE1MRWxlbWVudCwgc3R5bGVzOiBTdHlsZU9iamVjdCk6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc3RhbmRhcmRpemVkIGJ1dHRvbiBjb250YWluZXJcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlQnV0dG9uQ29udGFpbmVyKHBhcmVudDogSFRNTEVsZW1lbnQpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHBhcmVudC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlcyhjb250YWluZXIsIE1PREFMX1NUWUxFUy5idXR0b25Db250YWluZXIpO1xuICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHN0eWxlZCBidXR0b24gd2l0aCBjb25zaXN0ZW50IGFwcGVhcmFuY2VcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlU3R5bGVkQnV0dG9uKFxuICAgICAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICB0ZXh0OiBzdHJpbmcsXG4gICAgICAgIGlzUHJpbWFyeSA9IGZhbHNlLFxuICAgICAgICBvbkNsaWNrPzogKCkgPT4gdm9pZFxuICAgICk6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gY29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNQcmltYXJ5KSB7XG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnbW9kLWN0YScpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFwcGx5U3R5bGVzKGJ1dHRvbiwgTU9EQUxfU1RZTEVTLmJ1dHRvbik7XG4gICAgICAgIFxuICAgICAgICBpZiAob25DbGljaykge1xuICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbGljayk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBidXR0b247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc3R5bGVkIGlucHV0IGZpZWxkXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVN0eWxlZElucHV0KFxuICAgICAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgIHBsYWNlaG9sZGVyOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlID0gJydcbiAgICApOiBIVE1MSW5wdXRFbGVtZW50IHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBjb250YWluZXIuY3JlYXRlRWwoJ2lucHV0Jywge1xuICAgICAgICAgICAgdHlwZSxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgdmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFwcGx5U3R5bGVzKGlucHV0LCBJTlBVVF9TVFlMRVMpO1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIG1vZGFsIGJhc2Ugc3R5bGluZyBmb3IgY29uc2lzdGVuY3lcbiAgICAgKi9cbiAgICBzdGF0aWMgc2V0dXBNb2RhbFN0eWxpbmcobW9kYWxFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlcyhtb2RhbEVsLCB7XG4gICAgICAgICAgICB6SW5kZXg6IE1PREFMX1NUWUxFUy56SW5kZXgsXG4gICAgICAgICAgICBkaXNwbGF5OiBNT0RBTF9TVFlMRVMuZGlzcGxheVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBoZWFkZXIgZWxlbWVudCB3aXRoIGNvbnNpc3RlbnQgc3R5bGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVNb2RhbEhlYWRlcihwYXJlbnQ6IEhUTUxFbGVtZW50LCB0ZXh0OiBzdHJpbmcpOiBIVE1MSGVhZGluZ0VsZW1lbnQge1xuICAgICAgICBjb25zdCBoZWFkZXIgPSBwYXJlbnQuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0IH0pO1xuICAgICAgICB0aGlzLmFwcGx5U3R5bGVzKGhlYWRlciwgTU9EQUxfU1RZTEVTLmhlYWRlcik7XG4gICAgICAgIHJldHVybiBoZWFkZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbWVzc2FnZSBwYXJhZ3JhcGggd2l0aCBjb25zaXN0ZW50IHN0eWxpbmdcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlTW9kYWxNZXNzYWdlKHBhcmVudDogSFRNTEVsZW1lbnQsIHRleHQ6IHN0cmluZyk6IEhUTUxQYXJhZ3JhcGhFbGVtZW50IHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHBhcmVudC5jcmVhdGVFbCgncCcpO1xuICAgICAgICBtZXNzYWdlLnNldFRleHQodGV4dCk7XG4gICAgICAgIHRoaXMuYXBwbHlTdHlsZXMobWVzc2FnZSwgTU9EQUxfU1RZTEVTLm1lc3NhZ2UpO1xuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXAga2V5Ym9hcmQgZXZlbnQgaGFuZGxlcnMgZm9yIG1vZGFsc1xuICAgICAqL1xuICAgIHN0YXRpYyBzZXR1cE1vZGFsS2V5SGFuZGxlcnMoXG4gICAgICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgICAgICBvbkVudGVyOiAoKSA9PiB2b2lkLFxuICAgICAgICBvbkVzY2FwZT86ICgpID0+IHZvaWRcbiAgICApOiB2b2lkIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIG9uRW50ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScgJiYgb25Fc2NhcGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBvbkVzY2FwZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBJbnN0YW5jZSBtZXRob2RzIGltcGxlbWVudGluZyBpbnRlcmZhY2VcbiAgICBhcHBseVN0eWxlcyhlbGVtZW50OiBIVE1MRWxlbWVudCwgc3R5bGVzOiBTdHlsZU9iamVjdCk6IHZvaWQge1xuICAgICAgICBET01VdGlscy5hcHBseVN0eWxlcyhlbGVtZW50LCBzdHlsZXMpO1xuICAgIH1cblxuICAgIGNyZWF0ZUJ1dHRvbkNvbnRhaW5lcihwYXJlbnQ6IEhUTUxFbGVtZW50KTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICByZXR1cm4gRE9NVXRpbHMuY3JlYXRlQnV0dG9uQ29udGFpbmVyKHBhcmVudCk7XG4gICAgfVxuXG4gICAgY3JlYXRlU3R5bGVkQnV0dG9uKFxuICAgICAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICB0ZXh0OiBzdHJpbmcsXG4gICAgICAgIGlzUHJpbWFyeSA9IGZhbHNlLFxuICAgICAgICBvbkNsaWNrPzogKCkgPT4gdm9pZFxuICAgICk6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIERPTVV0aWxzLmNyZWF0ZVN0eWxlZEJ1dHRvbihjb250YWluZXIsIHRleHQsIGlzUHJpbWFyeSwgb25DbGljayk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogQVBJIGVuZHBvaW50cyBhbmQgY29uZmlndXJhdGlvbiBjb25zdGFudHNcbiAqL1xuXG5leHBvcnQgY29uc3QgQVBJX0VORFBPSU5UUyA9IHtcbiAgICBHRU1JTkk6ICdodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzL2dlbWluaS0yLjUtcHJvOmdlbmVyYXRlQ29udGVudCcsXG4gICAgR1JPUTogJ2h0dHBzOi8vYXBpLmdyb3EuY29tL29wZW5haS92MS9jaGF0L2NvbXBsZXRpb25zJyxcbiAgICBZT1VUVUJFX09FTUJFRDogJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL29lbWJlZCcsXG4gICAgQ09SU19QUk9YWTogJ2h0dHBzOi8vYXBpLmFsbG9yaWdpbnMud2luL3Jhdydcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBBSV9NT0RFTFMgPSB7XG4gICAgR0VNSU5JOiAnZ2VtaW5pLTIuNS1wcm8nLCAvLyBTZXQgR2VtaW5pIG1vZGVsIHRvIGdlbWluaS0yLjUtcHJvXG4gICAgR1JPUTogJ2xsYW1hLTMuMy03MGItdmVyc2F0aWxlJ1xufSBhcyBjb25zdDtcblxuLy8gS25vd24gbW9kZWwgb3B0aW9ucyBwZXIgcHJvdmlkZXIgKHVzZWQgdG8gcG9wdWxhdGUgbW9kZWwgc2VsZWN0b3IgaW4gVUkpXG4vLyBFYWNoIGVudHJ5IGlzIG5vdyBhbiBvYmplY3Qgd2l0aCBgbmFtZWAgYW5kIG9wdGlvbmFsIG1ldGFkYXRhIGxpa2UgYHN1cHBvcnRzQXVkaW9WaWRlb2AuXG4vLyBNb2RlbHMgYXJlIHVwZGF0ZWQgdG8gcmVmbGVjdCB0aGUgbGF0ZXN0IGF2YWlsYWJsZSB2ZXJzaW9ucyAoTm92IDIwMjQgLSBOb3YgMjAyNSkuXG5leHBvcnQgdHlwZSBQcm92aWRlck1vZGVsRW50cnkgPSB7IG5hbWU6IHN0cmluZzsgc3VwcG9ydHNBdWRpb1ZpZGVvPzogYm9vbGVhbiB9O1xuZXhwb3J0IGNvbnN0IFBST1ZJREVSX01PREVMX09QVElPTlM6IFJlY29yZDxzdHJpbmcsIFByb3ZpZGVyTW9kZWxFbnRyeVtdPiA9IHtcbiAgICAnR29vZ2xlIEdlbWluaSc6IFtcbiAgICAgICAgLy8gR2VtaW5pIDIuNSBzZXJpZXMgKGxhdGVzdCwgYWxsIHN1cHBvcnQgbXVsdGltb2RhbCB2aWRlbyBhbmFseXNpcylcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuNS1wcm8nLCBzdXBwb3J0c0F1ZGlvVmlkZW86IHRydWUgfSxcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuNS1wcm8tdHRzJywgc3VwcG9ydHNBdWRpb1ZpZGVvOiB0cnVlIH0sXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0yLjUtZmxhc2gnLCBzdXBwb3J0c0F1ZGlvVmlkZW86IHRydWUgfSxcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuNS1mbGFzaC1saXRlJywgc3VwcG9ydHNBdWRpb1ZpZGVvOiB0cnVlIH0sXG4gICAgICAgIC8vIEdlbWluaSAyLjAgc2VyaWVzICh2aWRlbyBzdXBwb3J0IHZpYSBuYXRpdmUgQVBJLCBidXQgbm8gZXhwbGljaXQgbXVsdGltb2RhbCBmbGFnKVxuICAgICAgICB7IG5hbWU6ICdnZW1pbmktMi4wLXBybycsIHN1cHBvcnRzQXVkaW9WaWRlbzogdHJ1ZSB9LFxuICAgICAgICB7IG5hbWU6ICdnZW1pbmktMi4wLWZsYXNoJyB9LFxuICAgICAgICB7IG5hbWU6ICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnIH0sXG4gICAgICAgIC8vIEdlbWluaSAxLjUgc2VyaWVzIChhdmFpbGFibGUsIHN1cHBvcnRzIHZpZGVvIHZpYSBGaWxlIEFQSSlcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTEuNS1wcm8nIH0sXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0xLjUtZmxhc2gnIH1cbiAgICBdLFxuICAgICdHcm9xJzogW1xuICAgICAgICAvLyBMYXRlc3QgbW9kZWxzIChOb3YgMjAyNCAtIE5vdiAyMDI1KVxuICAgICAgICAvLyBOb3RlOiBHcm9xIG1vZGVscyBwcmlvcml0aXplIHNwZWVkL3RleHQ7IGZvciBtdWx0aW1vZGFsIHZpZGVvLCBHZW1pbmkgaXMgcmVjb21tZW5kZWRcbiAgICAgICAgeyBuYW1lOiAnbGxhbWEtNC1tYXZlcmljay0xN2ItMTI4ZS1pbnN0cnVjdCcgfSxcbiAgICAgICAgeyBuYW1lOiAnbGxhbWEtNC1zY291dC0xN2ItMTZlLWluc3RydWN0JyB9LFxuICAgICAgICAvLyBMbGFtYSAzLnggc2VyaWVzXG4gICAgICAgIHsgbmFtZTogJ2xsYW1hLTMuMy03MGItdmVyc2F0aWxlJyB9LFxuICAgICAgICB7IG5hbWU6ICdsbGFtYS0zLjEtOGItaW5zdGFudCcgfVxuICAgIF1cbn07XG5cbi8vIE9wdGlvbmFsOiBwcm92aWRlciBwYWdlcyB0byBhdHRlbXB0IHRvIHNjcmFwZSBmb3IgbGF0ZXN0IG1vZGVsIG5hbWVzIChiZXN0LWVmZm9ydClcbmV4cG9ydCBjb25zdCBQUk9WSURFUl9NT0RFTF9MSVNUX1VSTFM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgJ0dvb2dsZSBHZW1pbmknOiAnaHR0cHM6Ly9kZXZlbG9wZXJzLmdlbmVyYXRpdmVhaS5nb29nbGUvbW9kZWxzJyxcbiAgICAnR3JvcSc6ICdodHRwczovL2dyb3EuY29tJ1xufTtcblxuLy8gU2ltcGxlIHJlZ2V4IHBhdHRlcm5zIHRvIHRyeSB0byBleHRyYWN0IG1vZGVsLWxpa2UgdG9rZW5zIGZyb20gcHJvdmlkZXIgcGFnZXNcbmV4cG9ydCBjb25zdCBQUk9WSURFUl9NT0RFTF9SRUdFWDogUmVjb3JkPHN0cmluZywgUmVnRXhwPiA9IHtcbiAgICAnR29vZ2xlIEdlbWluaSc6IC9nZW1pbmlbLV9cXC5dP1xcZCsoPzpcXC5cXGQrKT8oPzotW2EtejAtOVxcLV0rKT8vZ2ksXG4gICAgJ0dyb3EnOiAvbGxhbWFbLV9cXC5dP1xcZCsoPzpcXC5cXGQrKT8oPzotW2EtejAtOVxcLV0rKT8vZ2lcbn07XG5cbmV4cG9ydCBjb25zdCBBUElfTElNSVRTID0ge1xuICAgIE1BWF9UT0tFTlM6IDgwMDAsICAvLyBJbmNyZWFzZWQgZnJvbSAyMDAwIHRvIGhhbmRsZSBjb21wcmVoZW5zaXZlIHR1dG9yaWFsc1xuICAgIFRFTVBFUkFUVVJFOiAwLjcsXG4gICAgREVTQ1JJUFRJT05fTUFYX0xFTkdUSDogMTAwMCxcbiAgICBUSVRMRV9NQVhfTEVOR1RIOiAxMDBcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBUSU1FT1VUUyA9IHtcbiAgICBGSUxFX0NSRUFUSU9OX1dBSVQ6IDMwMCxcbiAgICBNT0RBTF9ERUxBWTogMTAwLFxuICAgIEZBTExCQUNLX01PREFMX0NIRUNLOiA1MDAsXG4gICAgRk9DVVNfREVMQVk6IDE1MCxcbiAgICBSRVBBSU5UX0RFTEFZOiA1MFxufSBhcyBjb25zdDtcbiIsICIvKipcbiAqIEN1c3RvbSBzdHlsZWQgY29uZmlybWF0aW9uIG1vZGFsIGZvciBiZXR0ZXIgYWNjZXNzaWJpbGl0eSBhbmQgVVhcbiAqIFJlcGxhY2VzIG5hdGl2ZSBicm93c2VyIGNvbmZpcm0oKSB3aXRoIGEgZnVsbHkgYWNjZXNzaWJsZSBtb2RhbCBkaWFsb2dcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQmFzZU1vZGFsIH0gZnJvbSAnLi9iYXNlLW1vZGFsJztcblxuZXhwb3J0IGludGVyZmFjZSBDb25maXJtYXRpb25Nb2RhbE9wdGlvbnMge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIGNvbmZpcm1UZXh0Pzogc3RyaW5nO1xuICAgIGNhbmNlbFRleHQ/OiBzdHJpbmc7XG4gICAgaXNEYW5nZXJvdXM/OiBib29sZWFuOyAvLyBJZiB0cnVlLCBzd2FwIGJ1dHRvbiBwb3NpdGlvbnMgKGNhbmNlbCBvbiByaWdodClcbn1cblxuLyoqXG4gKiBDdXN0b20gY29uZmlybWF0aW9uIG1vZGFsIHdpdGgga2V5Ym9hcmQgc2hvcnRjdXRzIChFbnRlciB0byBjb25maXJtLCBFc2NhcGUgdG8gY2FuY2VsKVxuICogYW5kIHByb3BlciBBUklBIGxhYmVscyBmb3IgYWNjZXNzaWJpbGl0eVxuICovXG5leHBvcnQgY2xhc3MgQ29uZmlybWF0aW9uTW9kYWwgZXh0ZW5kcyBCYXNlTW9kYWwge1xuICAgIHByaXZhdGUgY29uZmlybUJ1dHRvbj86IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgY2FuY2VsQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSByZXN1bHQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIHJlc29sdmVyPzogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIG9wdGlvbnM6IENvbmZpcm1hdGlvbk1vZGFsT3B0aW9uc1xuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgIH1cblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jcmVhdGVNb2RhbENvbnRlbnQoKTtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50SGFuZGxlcnMoKTtcbiAgICAgICAgdGhpcy5mb2N1c0NvbmZpcm1CdXR0b24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgbW9kYWwgY29udGVudCB3aXRoIGFjY2Vzc2libGUgc3RydWN0dXJlXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVNb2RhbENvbnRlbnQoKTogdm9pZCB7XG4gICAgICAgIC8vIEhlYWRlclxuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLmNyZWF0ZUhlYWRlcih0aGlzLm9wdGlvbnMudGl0bGUpO1xuICAgICAgICBoZWFkZXIuc2V0QXR0cmlidXRlKCdpZCcsICdjb25maXJtYXRpb24tbW9kYWwtdGl0bGUnKTtcblxuICAgICAgICAvLyBNZXNzYWdlIGNvbnRhaW5lciB3aXRoIGFyaWEtZGVzY3JpYmVkYnlcbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdignY29uZmlybWF0aW9uLW1lc3NhZ2UnKTtcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2NvbmZpcm1hdGlvbi1tb2RhbC1kZXNjcmlwdGlvbicpO1xuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnRleHRDb250ZW50ID0gdGhpcy5vcHRpb25zLm1lc3NhZ2U7XG5cbiAgICAgICAgLy8gQnV0dG9ucyBjb250YWluZXJcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jcmVhdGVCdXR0b25Db250YWluZXIoKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcyMHB4JztcblxuICAgICAgICBjb25zdCBjb25maXJtVGV4dCA9IHRoaXMub3B0aW9ucy5jb25maXJtVGV4dCB8fCAnQ29uZmlybSc7XG4gICAgICAgIGNvbnN0IGNhbmNlbFRleHQgPSB0aGlzLm9wdGlvbnMuY2FuY2VsVGV4dCB8fCAnQ2FuY2VsJztcbiAgICAgICAgY29uc3QgaXNEYW5nZXJvdXMgPSB0aGlzLm9wdGlvbnMuaXNEYW5nZXJvdXMgfHwgZmFsc2U7XG5cbiAgICAgICAgaWYgKGlzRGFuZ2Vyb3VzKSB7XG4gICAgICAgICAgICAvLyBTd2FwOiBjYW5jZWwgb24gbGVmdCwgY29uZmlybSBvbiByaWdodCAoZm9yIGRlc3RydWN0aXZlIGFjdGlvbnMpXG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ2FuY2VsKClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgQ2FuY2VsOiAke2NhbmNlbFRleHR9YCk7XG5cbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjb25maXJtVGV4dCxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ29uZmlybSgpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBDb25maXJtOiAke2NvbmZpcm1UZXh0fWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRGVmYXVsdDogY29uZmlybSBvbiBsZWZ0LCBjYW5jZWwgb24gcmlnaHRcbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjb25maXJtVGV4dCxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ29uZmlybSgpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBDb25maXJtOiAke2NvbmZpcm1UZXh0fWApO1xuXG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ2FuY2VsKClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgQ2FuY2VsOiAke2NhbmNlbFRleHR9YCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgbW9kYWwgY29udGVudCBhcmlhLWxhYmVsbGVkYnkgYW5kIGFyaWEtZGVzY3JpYmVkYnlcbiAgICAgICAgdGhpcy5jb250ZW50RWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCAnY29uZmlybWF0aW9uLW1vZGFsLXRpdGxlJyk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsICdjb25maXJtYXRpb24tbW9kYWwtZGVzY3JpcHRpb24nKTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2FsZXJ0ZGlhbG9nJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGtleWJvYXJkIGV2ZW50IGhhbmRsZXJzIChFbnRlciB0byBjb25maXJtLCBFc2NhcGUgdG8gY2FuY2VsKVxuICAgICAqL1xuICAgIHByaXZhdGUgc2V0dXBFdmVudEhhbmRsZXJzKCk6IHZvaWQge1xuICAgICAgICAvLyBFbnRlciBrZXk6IGNvbmZpcm1cbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgJ0VudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDb25maXJtKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEVzY2FwZSBrZXk6IGNhbmNlbFxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCAnRXNjYXBlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDYW5jZWwoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9jdXMgdGhlIGNvbmZpcm0gYnV0dG9uIGJ5IGRlZmF1bHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvY3VzQ29uZmlybUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY29uZmlybUJ1dHRvbikge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uIS5mb2N1cygpO1xuICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIGNvbmZpcm1hdGlvbiAoQ29uZmlybSBidXR0b24gb3IgRW50ZXIga2V5KVxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlQ29uZmlybSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5yZXNvbHZlcikge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlcih0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIGNhbmNlbGxhdGlvbiAoQ2FuY2VsIGJ1dHRvbiBvciBFc2NhcGUga2V5KVxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlQ2FuY2VsKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlc3VsdCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5yZXNvbHZlcikge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlcihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW4gbW9kYWwgYW5kIHdhaXQgZm9yIHVzZXIgcmVzcG9uc2VcbiAgICAgKiBSZXR1cm5zIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0cnVlIGlmIGNvbmZpcm1lZCwgZmFsc2UgaWYgY2FuY2VsbGVkXG4gICAgICovXG4gICAgcHVibGljIG9wZW5BbmRXYWl0KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZXIgPSByZXNvbHZlO1xuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgcmVzdWx0IChzeW5jaHJvbm91cyBpZiBhbHJlYWR5IGNsb3NlZClcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UmVzdWx0KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQ7XG4gICAgfVxufVxuIiwgIi8qKlxuICogQmFzZSBtb2RhbCBjbGFzcyB3aXRoIHNoYXJlZCBmdW5jdGlvbmFsaXR5IGFuZCBjb25zaXN0ZW50IHN0eWxpbmdcbiAqIERlc2lnbmVkIHRvIHByZXZlbnQgY29uZmxpY3RzIHdpdGggb3RoZXIgcGx1Z2luIG1vZGFsc1xuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBET01VdGlscyB9IGZyb20gJy4vZG9tJztcbmltcG9ydCB7IE1PREFMX1NUWUxFUywgSU5QVVRfU1RZTEVTIH0gZnJvbSAnLi9zdHlsZXMnO1xuaW1wb3J0IHsgVElNRU9VVFMgfSBmcm9tICcuL2FwaSc7XG5pbXBvcnQgeyBNb2RhbEV2ZW50cyB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuXG4vLyBVbmlxdWUgQ1NTIGNsYXNzZXMgdG8gcHJldmVudCBjb25mbGljdHNcbmNvbnN0IE1PREFMX0NTU19DTEFTU0VTID0ge1xuICAgIG1vZGFsOiAneXRjLW1vZGFsJyxcbiAgICBoZWFkZXI6ICd5dGMtbW9kYWwtaGVhZGVyJyxcbiAgICBjb250ZW50OiAneXRjLW1vZGFsLWNvbnRlbnQnLFxuICAgIGJ1dHRvbjogJ3l0Yy1tb2RhbC1idXR0b24nLFxuICAgIGlucHV0OiAneXRjLW1vZGFsLWlucHV0J1xufSBhcyBjb25zdDtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcm90ZWN0ZWQgZXZlbnRzOiBQYXJ0aWFsPE1vZGFsRXZlbnRzPiA9IHt9O1xuICAgIHByaXZhdGUgaXNEaXNwb3NlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5zZXR1cE1vZGFsU3R5bGluZygpO1xuICAgICAgICB0aGlzLnNldHVwQ29uZmxpY3RQcmV2ZW50aW9uKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGJhc2UgbW9kYWwgc3R5bGluZyBmb3IgY29uc2lzdGVuY3lcbiAgICAgKi9cbiAgICBwcml2YXRlIHNldHVwTW9kYWxTdHlsaW5nKCk6IHZvaWQge1xuICAgICAgICBET01VdGlscy5zZXR1cE1vZGFsU3R5bGluZyh0aGlzLm1vZGFsRWwpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHVuaXF1ZSBDU1MgY2xhc3MgdG8gcHJldmVudCBjb25mbGljdHNcbiAgICAgICAgdGhpcy5tb2RhbEVsLmFkZENsYXNzKE1PREFMX0NTU19DTEFTU0VTLm1vZGFsKTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuYWRkQ2xhc3MoTU9EQUxfQ1NTX0NMQVNTRVMuY29udGVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGNvbmZsaWN0IHByZXZlbnRpb24gbWVhc3VyZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIHNldHVwQ29uZmxpY3RQcmV2ZW50aW9uKCk6IHZvaWQge1xuICAgICAgICAvLyBBZGQgdW5pcXVlIGF0dHJpYnV0ZSBmb3IgaWRlbnRpZmljYXRpb25cbiAgICAgICAgdGhpcy5tb2RhbEVsLnNldEF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nLCAneW91dHViZS1jbGlwcGVyJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgbW9kYWwgaGFzIGhpZ2ggei1pbmRleCBidXQgbm90IGNvbmZsaWN0aW5nXG4gICAgICAgIHRoaXMubW9kYWxFbC5zdHlsZS56SW5kZXggPSAnOTk5OSc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHN0YW5kYXJkaXplZCBtb2RhbCBoZWFkZXIgd2l0aCBjb25mbGljdCBwcmV2ZW50aW9uXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUhlYWRlcih0ZXh0OiBzdHJpbmcpOiBIVE1MSGVhZGluZ0VsZW1lbnQge1xuICAgICAgICBjb25zdCBoZWFkZXIgPSBET01VdGlscy5jcmVhdGVNb2RhbEhlYWRlcih0aGlzLmNvbnRlbnRFbCwgdGV4dCk7XG4gICAgICAgIGhlYWRlci5hZGRDbGFzcyhNT0RBTF9DU1NfQ0xBU1NFUy5oZWFkZXIpO1xuICAgICAgICByZXR1cm4gaGVhZGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBzdGFuZGFyZGl6ZWQgbW9kYWwgbWVzc2FnZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBjcmVhdGVNZXNzYWdlKHRleHQ6IHN0cmluZyk6IEhUTUxQYXJhZ3JhcGhFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIERPTVV0aWxzLmNyZWF0ZU1vZGFsTWVzc2FnZSh0aGlzLmNvbnRlbnRFbCwgdGV4dCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHN0YW5kYXJkaXplZCBidXR0b24gY29udGFpbmVyXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUJ1dHRvbkNvbnRhaW5lcigpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIHJldHVybiBET01VdGlscy5jcmVhdGVCdXR0b25Db250YWluZXIodGhpcy5jb250ZW50RWwpO1xuICAgIH1cblxuICAgICAgICAvKipcbiAgICAgKiBDcmVhdGUgc3RhbmRhcmRpemVkIGJ1dHRvbiB3aXRoIGNvbmZsaWN0IHByZXZlbnRpb24gYW5kIGFjY2Vzc2liaWxpdHlcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY3JlYXRlQnV0dG9uKFxuICAgICAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICB0ZXh0OiBzdHJpbmcsXG4gICAgICAgIGlzUHJpbWFyeSA9IGZhbHNlLFxuICAgICAgICBvbkNsaWNrPzogKCkgPT4gdm9pZFxuICAgICk6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gRE9NVXRpbHMuY3JlYXRlU3R5bGVkQnV0dG9uKGNvbnRhaW5lciwgdGV4dCwgaXNQcmltYXJ5LCBvbkNsaWNrKTtcbiAgICAgICAgYnV0dG9uLmFkZENsYXNzKE1PREFMX0NTU19DTEFTU0VTLmJ1dHRvbik7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdW5pcXVlIGRhdGEgYXR0cmlidXRlXG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGx1Z2luJywgJ3lvdXR1YmUtY2xpcHBlcicpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWNjZXNzaWJpbGl0eTogYWRkIHJvbGUgYW5kIGFyaWEtbGFiZWxcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcbiAgICAgICAgaWYgKCFidXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJykpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgc3RhbmRhcmRpemVkIGlucHV0IHdpdGggY29uZmxpY3QgcHJldmVudGlvbiBhbmQgYWNjZXNzaWJpbGl0eVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBjcmVhdGVJbnB1dChcbiAgICAgICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgdHlwZTogc3RyaW5nLFxuICAgICAgICBwbGFjZWhvbGRlcj86IHN0cmluZ1xuICAgICk6IEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICBjb25zdCBpbnB1dCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCB7XG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBcHBseSBzdHlsZXMgYW5kIGFkZCB1bmlxdWUgY2xhc3NcbiAgICAgICAgRE9NVXRpbHMuYXBwbHlTdHlsZXMoaW5wdXQsIElOUFVUX1NUWUxFUyk7XG4gICAgICAgIGlucHV0LmFkZENsYXNzKE1PREFMX0NTU19DTEFTU0VTLmlucHV0KTtcbiAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCdkYXRhLXBsdWdpbicsICd5b3V0dWJlLWNsaXBwZXInKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFjY2Vzc2liaWxpdHk6IGFkZCBBUklBIGxhYmVscyBpZiBwbGFjZWhvbGRlciBleGlzdHNcbiAgICAgICAgaWYgKHBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBwbGFjZWhvbGRlcik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXAga2V5Ym9hcmQgZXZlbnQgaGFuZGxlcnNcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc2V0dXBLZXlIYW5kbGVycyhcbiAgICAgICAgb25FbnRlcjogKCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD4sXG4gICAgICAgIG9uRXNjYXBlPzogKCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD5cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlZE9uRW50ZXIgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IG9uRW50ZXIoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRW50ZXIga2V5IGhhbmRsZXIgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHdyYXBwZWRPbkVzY2FwZSA9IG9uRXNjYXBlID8gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBvbkVzY2FwZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFc2NhcGUga2V5IGhhbmRsZXIgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IDogdW5kZWZpbmVkO1xuXG4gICAgICAgIERPTVV0aWxzLnNldHVwTW9kYWxLZXlIYW5kbGVycyh0aGlzLmNvbnRlbnRFbCwgd3JhcHBlZE9uRW50ZXIsIHdyYXBwZWRPbkVzY2FwZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9jdXMgZWxlbWVudCB3aXRoIGRlbGF5IGZvciBiZXR0ZXIgVVhcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZm9jdXNFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBkZWxheSA9IFRJTUVPVVRTLkZPQ1VTX0RFTEFZKTogdm9pZCB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGV2ZW50IGhhbmRsZXJzXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHNldEV2ZW50cyhldmVudHM6IFBhcnRpYWw8TW9kYWxFdmVudHM+KTogdm9pZCB7XG4gICAgICAgIHRoaXMuZXZlbnRzID0gZXZlbnRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgY3VzdG9tIHN0eWxlZCBjb25maXJtYXRpb24gZGlhbG9nIGJlZm9yZSBjbG9zaW5nXG4gICAgICogVGhpcyB1c2VzIG91ciBjdXN0b20gQ29uZmlybWF0aW9uTW9kYWwgaW5zdGVhZCBvZiB0aGUgbmF0aXZlIGJyb3dzZXIgY29uZmlybSgpXG4gICAgICogZm9yIGJldHRlciBhY2Nlc3NpYmlsaXR5IGFuZCBVWC5cbiAgICAgKiBcbiAgICAgKiBOb3RlOiBUaGlzIGlzIG5vdyBzeW5jaHJvbm91cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBleGlzdGluZyBjYWxsZXJzLFxuICAgICAqIGJ1dCByZXR1cm5zIGEgYm9vbGVhbiBpbW1lZGlhdGVseS4gRm9yIGFzeW5jIGNvbmZpcm1hdGlvbiB3aXRoIHByb3BlciBtb2RhbCxcbiAgICAgKiB1c2Ugc2hvd0NvbmZpcm1hdGlvbk1vZGFsKCkgaW5zdGVhZC5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY29uZmlybUNsb3NlKG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBGb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSwgcmV0dXJuIGEgc3luY2hyb25vdXMgdmFsdWUuXG4gICAgICAgIC8vIEhvd2V2ZXIsIGluIHByYWN0aWNlLCB5b3Ugc2hvdWxkIHVzZSBzaG93Q29uZmlybWF0aW9uTW9kYWwoKSBmb3IgdGhlIGZ1bGwgYXN5bmMgZXhwZXJpZW5jZS5cbiAgICAgICAgLy8gVGhpcyBmYWxsYmFjayB1c2VzIG5hdGl2ZSBjb25maXJtKCkgb25seSBpZiBuZWVkZWQuXG4gICAgICAgIHJldHVybiBjb25maXJtKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgYSBjdXN0b20gYWNjZXNzaWJsZSBjb25maXJtYXRpb24gbW9kYWwgYW5kIHdhaXQgZm9yIHVzZXIgcmVzcG9uc2UuXG4gICAgICogUHJlZmVycmVkIG1ldGhvZCBmb3IgY29uZmlybWF0aW9uIGRpYWxvZ3MgKGFzeW5jLCBmdWxseSBhY2Nlc3NpYmxlKS5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYXN5bmMgc2hvd0NvbmZpcm1hdGlvbk1vZGFsKFxuICAgICAgICB0aXRsZTogc3RyaW5nLFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGNvbmZpcm1UZXh0ID0gJ0NvbmZpcm0nLFxuICAgICAgICBjYW5jZWxUZXh0ID0gJ0NhbmNlbCcsXG4gICAgICAgIGlzRGFuZ2Vyb3VzID0gZmFsc2VcbiAgICApOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgeyBDb25maXJtYXRpb25Nb2RhbCB9ID0gYXdhaXQgaW1wb3J0KCcuL2NvbmZpcm1hdGlvbi1tb2RhbCcpO1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBDb25maXJtYXRpb25Nb2RhbCh0aGlzLmFwcCwge1xuICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgY29uZmlybVRleHQsXG4gICAgICAgICAgICBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgaXNEYW5nZXJvdXNcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtb2RhbC5vcGVuQW5kV2FpdCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcmNlIG1vZGFsIHZpc2liaWxpdHkgKGZvciBzdHViYm9ybiBtb2RhbHMpXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGZvcmNlVmlzaWJsZSgpOiB2b2lkIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBET01VdGlscy5zZXR1cE1vZGFsU3R5bGluZyh0aGlzLm1vZGFsRWwpO1xuICAgICAgICB9LCBUSU1FT1VUUy5SRVBBSU5UX0RFTEFZKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBvbiBjbG9zZSB3aXRoIHByb3BlciBkaXNwb3NhbFxuICAgICAqL1xuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ1t5b3V0dWJlLWNsaXBwZXJdIENsZWFuaW5nIHVwIG1vZGFsJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXJrIGFzIGRpc3Bvc2VkIHRvIHByZXZlbnQgZG91YmxlIGNsZWFudXBcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFyIGNvbnRlbnRcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIHVuaXF1ZSBjbGFzc2VzIGFuZCBhdHRyaWJ1dGVzXG4gICAgICAgIHRoaXMubW9kYWxFbC5yZW1vdmVDbGFzcyhNT0RBTF9DU1NfQ0xBU1NFUy5tb2RhbCk7XG4gICAgICAgIHRoaXMubW9kYWxFbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtcGx1Z2luJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnW3lvdXR1YmUtY2xpcHBlcl0gTW9kYWwgY2xlYW51cCBjb21wbGV0ZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFic3RyYWN0IG1ldGhvZCBmb3IgbW9kYWwgY29udGVudCBjcmVhdGlvblxuICAgICAqL1xuICAgIGFic3RyYWN0IG9uT3BlbigpOiB2b2lkO1xufVxuIiwgImltcG9ydCB7IE5vdGljZSwgUGx1Z2luLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbmZsaWN0UHJldmVudGlvbiB9IGZyb20gJy4vY29uZmxpY3QtcHJldmVudGlvbic7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4vbWVzc2FnZXMnO1xuaW1wb3J0IHsgVmFsaWRhdGlvblV0aWxzIH0gZnJvbSAnLi92YWxpZGF0aW9uJztcbmltcG9ydCB7IEVycm9ySGFuZGxlciB9IGZyb20gJy4vc2VydmljZXMvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBTYXZlQ29uZmlybWF0aW9uTW9kYWwgfSBmcm9tICcuL3NhdmUtY29uZmlybWF0aW9uLW1vZGFsJztcbmltcG9ydCB7IFlvdVR1YmVVcmxNb2RhbCB9IGZyb20gJy4veW91dHViZS11cmwtbW9kYWwnO1xuaW1wb3J0IHsgWW91VHViZVNldHRpbmdzVGFiIH0gZnJvbSAnLi9zZXR0aW5ncy10YWInO1xuaW1wb3J0IHsgU2VydmljZUNvbnRhaW5lciB9IGZyb20gJy4vc2VydmljZXMvc2VydmljZS1jb250YWluZXInO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBZb3VUdWJlUGx1Z2luU2V0dGluZ3MsIFBlcmZvcm1hbmNlTW9kZSB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuXG5jb25zdCBQTFVHSU5fUFJFRklYID0gJ3l0cCc7XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICBnZW1pbmlBcGlLZXk6ICcnLFxuICAgIGdyb3FBcGlLZXk6ICcnLFxuICAgIG91dHB1dFBhdGg6ICdZb3VUdWJlL1Byb2Nlc3NlZCBWaWRlb3MnLFxuICAgIHVzZUVudmlyb25tZW50VmFyaWFibGVzOiBmYWxzZSxcbiAgICBlbnZpcm9ubWVudFByZWZpeDogJ1lUQycsXG4gICAgLy8gUGVyZm9ybWFuY2Ugc2V0dGluZ3Mgd2l0aCBzbWFydCBkZWZhdWx0c1xuICAgIHBlcmZvcm1hbmNlTW9kZTogJ2JhbGFuY2VkJyxcbiAgICBlbmFibGVQYXJhbGxlbFByb2Nlc3Npbmc6IHRydWUsXG4gICAgcHJlZmVyTXVsdGltb2RhbDogdHJ1ZVxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWW91dHViZUNsaXBwZXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyA9IERFRkFVTFRfU0VUVElOR1M7XG4gICAgcHJpdmF0ZSBzZXJ2aWNlQ29udGFpbmVyPzogU2VydmljZUNvbnRhaW5lcjtcbiAgICBwcml2YXRlIHJpYmJvbkljb24/OiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGlzVW5sb2FkaW5nID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBvcGVyYXRpb25Db3VudCA9IDA7XG4gICAgLy8gVHJhY2sgdGVtcCBub3RlcyB3ZSd2ZSBhbHJlYWR5IGhhbmRsZWQgdG8gYXZvaWQgZHVwbGljYXRlIG1vZGFsIG9wZW5zXG4gICAgcHJpdmF0ZSBoYW5kbGVkVGVtcEZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcbiAgICAvLyBUcmFjayBtb2RhbCBpbnN0YW5jZXMgdG8gcHJldmVudCBkb3VibGUgb3BlbmluZ1xuICAgIHByaXZhdGUgaXNNb2RhbE9wZW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIHBlbmRpbmdNb2RhbFVybD86IHN0cmluZztcblxuICAgIGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdJbml0aWFsaXppbmcgWW91dHViZUNsaXBwZXIgUGx1Z2luIHYxLjIuMC4uLicpO1xuICAgICAgICBjb25zdCBjb25mbGljdHMgPSBDb25mbGljdFByZXZlbnRpb24uY2hlY2tGb3JQb3RlbnRpYWxDb25mbGljdHMoKTtcbiAgICAgICAgaWYgKGNvbmZsaWN0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ1dhcm5pbmcoYFBvdGVudGlhbCBjb25mbGljdHMgZGV0ZWN0ZWQgYnV0IHByb2NlZWRpbmc6ICR7Y29uZmxpY3RzLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZVNlcnZpY2VzKCk7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyVUlDb21wb25lbnRzKCk7XG5cbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3Igbm90ZXMgY3JlYXRlZCB2aWEgT2JzaWRpYW4gVVJJLiBUaGUgZXh0ZW5zaW9uIGFwcGVuZHMgYVxuICAgICAgICAgICAgLy8gaGlkZGVuIG1hcmtlciB0byBjcmVhdGVkIG5vdGVzIHNvIHdlIGNhbiByZWxpYWJseSBkZXRlY3QgdGhlbS5cbiAgICAgICAgICAgIGNvbnN0IE5PVEVfTUFSS0VSID0gJzwhLS0geXRjLWV4dGVuc2lvbjp5b3V0dWJlLWNsaXBwZXIgLS0+JztcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgZGVib3VuY2VkIFVSTCBoYW5kbGVyIHRvIHByZXZlbnQgY3ljbGVzXG4gICAgICAgICAgICBjb25zdCBwZW5kaW5nVXJscyA9IG5ldyBNYXA8c3RyaW5nLCBOb2RlSlMuVGltZW91dD4oKTtcbiAgICAgICAgICAgIGNvbnN0IFVSTF9IQU5ETEVSX0RFTEFZID0gNTAwO1xuXG4gICAgICAgICAgICBjb25zdCBpc1RlbXBGaWxlID0gKGZpbGU6IFRGaWxlLCBjb250ZW50OiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgdGVtcG9yYXJ5IGZpbGUgY3JlYXRlZCBieSB0aGUgQ2hyb21lIGV4dGVuc2lvblxuICAgICAgICAgICAgICAgIC8vIEJlIHZlcnkgc3RyaWN0IHRvIGF2b2lkIHRyZWF0aW5nIHByb2Nlc3NlZCB2aWRlbyBmaWxlcyBhcyB0ZW1wIGZpbGVzXG5cbiAgICAgICAgICAgICAgICAvLyAxLiBDb250YWlucyB0aGUgaGlkZGVuIG1hcmtlciAobW9zdCByZWxpYWJsZSkgLSBBTFdBWVMgYWNjZXB0XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC5pbmNsdWRlcyhOT1RFX01BUktFUikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gMi4gRmlsZSBuYW1lIG1hdGNoZXMgdGhlIENocm9tZSBleHRlbnNpb24gcGF0dGVybiBFWEFDVExZXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUubmFtZSAmJiBmaWxlLm5hbWUuc3RhcnRzV2l0aCgnWW91VHViZSBDbGlwIC0nKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyAzLiBDb250ZW50IGlzIE9OTFkgYSBZb3VUdWJlIFVSTCBhbmQgZmlsZSBpcyB2ZXJ5IG5ldy9zbWFsbCBBTkQgTk9UIGluIG91dHB1dCBwYXRoXG4gICAgICAgICAgICAgICAgY29uc3QgdHJpbW1lZENvbnRlbnQgPSBjb250ZW50LnRyaW0oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHRyaW1tZWRDb250ZW50LnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKS5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1VybE9ubHkgPSBsaW5lcy5sZW5ndGggPT09IDEgJiYgVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKGxpbmVzWzBdKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc1VybE9ubHkgJiYgY29udGVudC5sZW5ndGggPCAyMDApIHsgLy8gdmVyeSBzbWFsbCBmaWxlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVBZ2UgPSBEYXRlLm5vdygpIC0gZmlsZS5zdGF0LmN0aW1lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0luT3V0cHV0UGF0aCA9IGZpbGUucGF0aC5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLm91dHB1dFBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgYXMgdGVtcCBmaWxlIGlmOlxuICAgICAgICAgICAgICAgICAgICAvLyAtIFZlcnkgcmVjZW50ICh3aXRoaW4gNSBzZWNvbmRzIGZvciBpbW1lZGlhdGUgZGV0ZWN0aW9uKVxuICAgICAgICAgICAgICAgICAgICAvLyAtIEFORCBOT1QgaW4gdGhlIG91dHB1dCBwYXRoICh0byBhdm9pZCBwcm9jZXNzZWQgdmlkZW8gZmlsZXMpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQWdlIDwgNTAwMCAmJiAhaXNJbk91dHB1dFBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgaGFuZGxlVXJsU2FmZWx5ID0gKHVybDogc3RyaW5nLCBzb3VyY2U6IHN0cmluZywgZmlsZVBhdGg/OiBzdHJpbmcsIGZpbGU/OiBURmlsZSwgY29udGVudD86IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBZb3VUdWJlQ2xpcHBlcjogJHtzb3VyY2V9IC0gaGFuZGxlVXJsU2FmZWx5IGNhbGxlZCBmb3IgVVJMOmAsIHVybCwgJ2ZpbGU6JywgZmlsZVBhdGgpO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBzYWZldHkgY2hlY2s6IG9ubHkgcHJvY2VzcyBpZiB0aGlzIGFwcGVhcnMgdG8gYmUgYSB0ZW1wIGZpbGVcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSAmJiBjb250ZW50ICYmICFpc1RlbXBGaWxlKGZpbGUsIGNvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgWW91VHViZUNsaXBwZXI6ICR7c291cmNlfSAtIFJFSkVDVElORyBVUkwgaW4gbm9uLXRlbXAgZmlsZTogJHtmaWxlUGF0aH1gKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgc3BlY2lmaWMgcmVhc29ucyBmb3IgcmVqZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVBZ2UgPSBEYXRlLm5vdygpIC0gZmlsZS5zdGF0LmN0aW1lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0luT3V0cHV0UGF0aCA9IGZpbGVQYXRoPy5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLm91dHB1dFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNNYXJrZXIgPSBjb250ZW50LmluY2x1ZGVzKE5PVEVfTUFSS0VSKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzQ2xpcFByZWZpeCA9IGZpbGUubmFtZT8uc3RhcnRzV2l0aCgnWW91VHViZSBDbGlwIC0nKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBSZWplY3Rpb24gZGV0YWlsczogYWdlPSR7ZmlsZUFnZX1tcywgaW5PdXRwdXRQYXRoPSR7aXNJbk91dHB1dFBhdGh9LCBoYXNNYXJrZXI9JHtoYXNNYXJrZXJ9LCBoYXNDbGlwUHJlZml4PSR7aGFzQ2xpcFByZWZpeH1gKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZWRUZW1wRmlsZXMuaGFzKHVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBVUkwgYWxyZWFkeSBoYW5kbGVkOiAke3VybH0sIHNraXBwaW5nYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDYW5jZWwgYW55IHBlbmRpbmcgaGFuZGxlciBmb3IgdGhpcyBVUkxcbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1VybHMuaGFzKHVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBjYW5jZWxsaW5nIHBlbmRpbmcgaGFuZGxlciBmb3IgVVJMOmAsIHVybCk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChwZW5kaW5nVXJscy5nZXQodXJsKSEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1hcmsgYXMgaGFuZGxlZCBpbW1lZGlhdGVseSB0byBwcmV2ZW50IGR1cGxpY2F0ZXNcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZWRUZW1wRmlsZXMuYWRkKHVybCk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlZFRlbXBGaWxlcy5hZGQoZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXI6ICR7c291cmNlfSAtIG1hcmtlZCBVUkwgYXMgaGFuZGxlZDpgLCB1cmwpO1xuXG4gICAgICAgICAgICAgICAgLy8gRGVib3VuY2UgdG8gaGFuZGxlIHJhcGlkLWZpcmUgZXZlbnRzXG4gICAgICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXI6ICR7c291cmNlfSAtIERFQk9VTkNFRDogb3BlbmluZyBtb2RhbCBmb3IgVVJMOiAke3VybH1gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBwZW5kaW5nVXJscyBzaXplIGJlZm9yZTpgLCBwZW5kaW5nVXJscy5zaXplKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBoYW5kbGVkVGVtcEZpbGVzIHNpemU6YCwgdGhpcy5oYW5kbGVkVGVtcEZpbGVzLnNpemUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKHVybCk7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdVcmxzLmRlbGV0ZSh1cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBZb3VUdWJlQ2xpcHBlcjogJHtzb3VyY2V9IC0gcGVuZGluZ1VybHMgc2l6ZSBhZnRlcjpgLCBwZW5kaW5nVXJscy5zaXplKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCBvbGQgZW50cmllcyB0byBwcmV2ZW50IG1lbW9yeSBsZWFrc1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYW5kbGVkVGVtcEZpbGVzLnNpemUgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuaGFuZGxlZFRlbXBGaWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIG9ubHkgdGhlIG1vc3QgcmVjZW50IDUwIGVudHJpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlZFRlbXBGaWxlcy5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50cmllcy5zbGljZSgtNTApLmZvckVhY2goZW50cnkgPT4gdGhpcy5oYW5kbGVkVGVtcEZpbGVzLmFkZChlbnRyeSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiAke3NvdXJjZX0gLSBjbGVhbmVkIHVwIGhhbmRsZWRUZW1wRmlsZXMsIG5ldyBzaXplOmAsIHRoaXMuaGFuZGxlZFRlbXBGaWxlcy5zaXplKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIFVSTF9IQU5ETEVSX0RFTEFZKTtcblxuICAgICAgICAgICAgICAgIHBlbmRpbmdVcmxzLnNldCh1cmwsIHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBZb3VUdWJlQ2xpcHBlcjogJHtzb3VyY2V9IC0gc2V0IHRpbWVvdXQgZm9yIFVSTDpgLCB1cmwsICdkZWxheTonLCBVUkxfSEFORExFUl9ERUxBWSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oJ2NyZWF0ZScsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlIGFzIFRGaWxlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCBjaGVjazogSXMgdGhpcyBhIHRlbXBvcmFyeSBmaWxlP1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGVtcEZpbGUoZmlsZSwgY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVDbGlwcGVyOiBjcmVhdGUgaGFuZGxlciAtIGlnbm9yaW5nIGV4aXN0aW5nIGZpbGU6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgVVJMIGZyb20gdGVtcG9yYXJ5IGZpbGVcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC5pbmNsdWRlcyhOT1RFX01BUktFUikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGNvbnRlbnQucmVwbGFjZShOT1RFX01BUktFUiwgJycpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaXJzdCBZb3VUdWJlIFVSTCBhbnl3aGVyZSBpbiB0aGUgY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF5YmUgPSAoY29udGVudCB8fCAnJykudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVnZXggdG8gY2FwdHVyZSBjb21tb24gWW91VHViZSB3YXRjaCBVUkxzIGFuZCB5b3V0dS5iZSBsaW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeXRSZWdleCA9IC8oaHR0cHM/OlxcL1xcLyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL3dhdGNoXFw/dj1bQS1aYS16MC05Xy1dezYsfXxodHRwcz86XFwvXFwvKD86d3d3XFwuKT95b3V0dVxcLmJlXFwvW0EtWmEtejAtOV8tXXs2LH0pL2k7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gbWF5YmUubWF0Y2goeXRSZWdleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobSAmJiBtWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gbVsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGUubmFtZSAmJiBmaWxlLm5hbWUuc3RhcnRzV2l0aCgnWW91VHViZSBDbGlwIC0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhbGxiYWNrOiBpZiBmaWxlbmFtZSBtYXRjaGVzIGFuZCBjb250ZW50IGlzIGEgc2luZ2xlIHRva2VuIHBvc3NpYmx5IFVSTFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpbmdsZSA9IG1heWJlLnNwbGl0KCdcXG4nKS5tYXAocyA9PiBzLnRyaW0oKSkuZmluZChCb29sZWFuKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHNpbmdsZSkpIHVybCA9IHNpbmdsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogY3JlYXRlIGhhbmRsZXIgLSBubyB1cmwgZXh0cmFjdGVkIGZvciB0ZW1wIGZpbGU6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdZb3VUdWJlQ2xpcHBlcjogQ1JFQVRFIEVWRU5UIC0gZGV0ZWN0ZWQgdGVtcCBub3RlJywgeyBwYXRoOiBmaWxlLnBhdGgsIHVybCB9KTtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlVXJsU2FmZWx5KHVybCwgJ2NyZWF0ZS1oYW5kbGVyJywgZmlsZS5wYXRoLCBmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHN3YWxsb3c7IG5vbi1jcml0aWNhbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgLy8gQWxzbyBsaXN0ZW4gZm9yIHdoZW4gYSBmaWxlIGJlY29tZXMgYWN0aXZlIChvcGVuZWQpLiBTb21lIE9ic2lkaWFuXG4gICAgICAgICAgICAvLyBVUkwgZmxvd3MgY3JlYXRlIHRoZSBmaWxlIGFuZCBpbW1lZGlhdGVseSBvcGVuIGl0OyBkZXRlY3RpbmcgdGhlXG4gICAgICAgICAgICAvLyBhY3RpdmUgbGVhZiBlbnN1cmVzIHdlIGNhdGNoIG5vdGVzIGNyZWF0ZWQgd2l0aG91dCBmaXJpbmcgYSBjcmVhdGVcbiAgICAgICAgICAgIC8vIGV2ZW50IGluIHRpbWUgZm9yIG91ciBoYW5kbGVyLlxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZWRUZW1wRmlsZXMuaGFzKGZpbGUucGF0aCkpIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlIGFzIFRGaWxlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCBjaGVjazogSXMgdGhpcyBhIHRlbXBvcmFyeSBmaWxlP1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGVtcEZpbGUoZmlsZSwgY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVDbGlwcGVyOiBhY3RpdmUtbGVhZi1jaGFuZ2UgLSBpZ25vcmluZyBleGlzdGluZyBmaWxlOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IFVSTCBleHRyYWN0aW9uIGZyb20gdGVtcG9yYXJ5IGZpbGVcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQuaW5jbHVkZXMoTk9URV9NQVJLRVIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBjb250ZW50LnJlcGxhY2UoTk9URV9NQVJLRVIsICcnKS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXliZSA9IChjb250ZW50IHx8ICcnKS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5dFJlZ2V4ID0gLyhodHRwcz86XFwvXFwvKD86d3d3XFwuKT95b3V0dWJlXFwuY29tXFwvd2F0Y2hcXD92PVtBLVphLXowLTlfLV17Nix9fGh0dHBzPzpcXC9cXC8oPzp3d3dcXC4pP3lvdXR1XFwuYmVcXC9bQS1aYS16MC05Xy1dezYsfSkvaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSBtYXliZS5tYXRjaCh5dFJlZ2V4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtICYmIG1bMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBtWzFdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZS5uYW1lICYmIGZpbGUubmFtZS5zdGFydHNXaXRoKCdZb3VUdWJlIENsaXAgLScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2luZ2xlID0gbWF5YmUuc3BsaXQoJ1xcbicpLm1hcChzID0+IHMudHJpbSgpKS5maW5kKEJvb2xlYW4pIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFlvdVR1YmVVcmwoc2luZ2xlKSkgdXJsID0gc2luZ2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVDbGlwcGVyOiBhY3RpdmUtbGVhZi1jaGFuZ2UgLSBubyB1cmwgZm9yIHRlbXAgZmlsZTonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdVR1YmVDbGlwcGVyOiBBQ1RJVkUtTEVBRi1DSEFOR0UgRVZFTlQgLSBkZXRlY3RlZCB0ZW1wIG5vdGUnLCB7IHBhdGg6IGZpbGUucGF0aCwgdXJsIH0pO1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVVcmxTYWZlbHkodXJsLCAnYWN0aXZlLWxlYWYtaGFuZGxlcicsIGZpbGUucGF0aCwgZmlsZSwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIHRoaXMubG9nSW5mbygnWW91dHViZUNsaXBwZXIgUGx1Z2luIGxvYWRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGEgY3VzdG9tIHByb3RvY29sIGhhbmRsZXIgc28gZXh0ZXJuYWwgYXBwcyAob3IgdGhlXG4gICAgICAgICAgICAvLyBDaHJvbWUgZXh0ZW5zaW9uKSBjYW4gb3BlbiBhbiBVUkkgbGlrZTpcbiAgICAgICAgICAgIC8vIG9ic2lkaWFuOi8veW91dHViZS1jbGlwcGVyP3ZhdWx0PVZBVUxUJnVybD08dmlkZW9Vcmw+XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIGByZWdpc3Rlck9ic2lkaWFuUHJvdG9jb2xIYW5kbGVyYCBpcyBhdmFpbGFibGUgaW4gT2JzaWRpYW4nc1xuICAgICAgICAgICAgICAgIC8vIFBsdWdpbiBBUEkuIEl0IGdpdmVzIHVzIGEgY2xlYW4gd2F5IHRvIHJlY2VpdmUgYSBVUkwgZGlyZWN0bHlcbiAgICAgICAgICAgICAgICAvLyBmcm9tIHRoZSBleHRlbnNpb24gd2l0aG91dCBjcmVhdGluZyB0ZW1wb3Jhcnkgbm90ZXMuXG4gICAgICAgICAgICAgICAgLy8gVGhlIGhhbmRsZXIgcmVjZWl2ZXMgYSBwYXJhbXMgb2JqZWN0IHdpdGggcXVlcnkgcGFyYW1ldGVycy5cbiAgICAgICAgICAgICAgICAvLyBFeGFtcGxlIGludm9jYXRpb246IG9ic2lkaWFuOi8veW91dHViZS1jbGlwcGVyP3ZhdWx0PU15VmF1bHQmdXJsPTxlbmNvZGVkPlxuICAgICAgICAgICAgICAgIC8vIFdlJ2xsIG9wZW4gdGhlIG1vZGFsIHdpdGggdGhlIHByb3ZpZGVkIFVSTC5cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJPYnNpZGlhblByb3RvY29sSGFuZGxlcj8uKCd5b3V0dWJlLWNsaXBwZXInLCAocGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBwYXJhbXMudXJsIHx8IHBhcmFtcy5jb250ZW50IHx8IHBhcmFtcy5wYXRoIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVybCAmJiBWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFlvdVR1YmVVcmwodXJsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlZmVyIGludG8gdGhlIHBsdWdpbiBtYWluIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwodXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogcHJvdG9jb2wgaGFuZGxlciByZWNlaXZlZCBubyB2YWxpZCB1cmwnLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1lvdVR1YmVDbGlwcGVyOiBwcm90b2NvbCBoYW5kbGVyIGVycm9yJywgZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBOb3QgZmF0YWwgaWYgQVBJIG1pc3NpbmdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMubG9nRXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHBsdWdpbicsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsICdQbHVnaW4gaW5pdGlhbGl6YXRpb24nKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0ZhaWxlZCB0byBsb2FkIFlvdXR1YmVDbGlwcGVyIFBsdWdpbi4gQ2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmxvZ0luZm8oJ1VubG9hZGluZyBZb3V0dWJlQ2xpcHBlciBQbHVnaW4uLi4nKTtcbiAgICAgICAgdGhpcy5pc1VubG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFJlc2V0IG1vZGFsIHN0YXRlIHRvIHByZXZlbnQgaXNzdWVzIGR1cmluZyB1bmxvYWRcbiAgICAgICAgICAgIHRoaXMuaXNNb2RhbE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ01vZGFsVXJsID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VDb250YWluZXI/LmNsZWFyU2VydmljZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cFVJRWxlbWVudHMoKTtcbiAgICAgICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5jbGVhbnVwQWxsRWxlbWVudHMoKTtcbiAgICAgICAgICAgIHRoaXMubG9nSW5mbygnWW91dHViZUNsaXBwZXIgUGx1Z2luIHVubG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgZHVyaW5nIHBsdWdpbiB1bmxvYWQnLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVTZXJ2aWNlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlQ29udGFpbmVyID0gbmV3IFNlcnZpY2VDb250YWluZXIodGhpcy5zZXR0aW5ncywgdGhpcy5hcHApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVnaXN0ZXJVSUNvbXBvbmVudHMoKTogdm9pZCB7XG4gICAgICAgIC8vIFVzZSBhIHJlbGlhYmxlIGljb24gSUQgdGhhdCBzaG91bGQgYmUgYXZhaWxhYmxlIGluIE9ic2lkaWFuXG4gICAgICAgIC8vIENvbW1vbmx5IGF2YWlsYWJsZSBpY29uczogJ3ZpZGVvJywgJ3BsYXknLCAnZmlsbScsICdtb25pdG9yJywgJ2dsb2JlJywgJ3BsYXktY2lyY2xlJ1xuICAgICAgICB0aGlzLnJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ2ZpbG0nLCAnUHJvY2VzcyBZb3VUdWJlIFZpZGVvJywgKCkgPT4ge1xuICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTG9nIHRoYXQgaWNvbiBoYXMgYmVlbiBzZXQgZm9yIGRlYnVnZ2luZ1xuICAgICAgICBjb25zb2xlLmxvZygnWW91VHViZUNsaXBwZXI6IFJpYmJvbiBpY29uIHNldCBzdWNjZXNzZnVsbHknKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IGAke1BMVUdJTl9QUkVGSVh9LXByb2Nlc3MteW91dHViZS12aWRlb2AsXG4gICAgICAgICAgICBuYW1lOiAnUHJvY2VzcyBZb3VUdWJlIFZpZGVvJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBZb3VUdWJlU2V0dGluZ3NUYWIodGhpcy5hcHAsIHtcbiAgICAgICAgICAgIHBsdWdpbjogdGhpcyxcbiAgICAgICAgICAgIG9uU2V0dGluZ3NDaGFuZ2U6IHRoaXMuaGFuZGxlU2V0dGluZ3NDaGFuZ2UuYmluZCh0aGlzKVxuICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQ29tbWFuZCB1c2VkIGJ5IEFkdmFuY2VkIFVSSSBvciBvdGhlciBleHRlcm5hbCBjYWxsZXJzLiBUaGlzIGNvbW1hbmRcbiAgICAgICAgLy8gcmVhZHMgdGhlIGNsaXBib2FyZCAodGhlIENocm9tZSBleHRlbnNpb24gY29waWVzIHRoZSBVUkwgdGhlcmUpIGFuZFxuICAgICAgICAvLyBvcGVucyB0aGUgWW91VHViZSBVUkwgbW9kYWwgd2l0aCB0aGF0IFVSTC4gVGhpcyBhbGxvd3MgdGhlIGV4dGVuc2lvblxuICAgICAgICAvLyB0byBpbnZva2UgdGhlIGNvbW1hbmQgd2l0aG91dCBwYXNzaW5nIGFyZ3MuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogYCR7UExVR0lOX1BSRUZJWH0tb3Blbi11cmwtZnJvbS1jbGlwYm9hcmRgLFxuICAgICAgICAgICAgbmFtZTogJ1lvdVR1YmUgQ2xpcHBlcjogT3BlbiBVUkwgTW9kYWwgKGZyb20gY2xpcGJvYXJkKScsXG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBjbGlwYm9hcmQgZmlyc3RcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRleHQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hdmlnYXRvci5jbGlwYm9hcmQgbWF5IG5vdCBiZSBhdmFpbGFibGUgaW4gYWxsIGhvc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAoYnV0IHVzdWFsbHkgaXMgaW4gT2JzaWRpYW4gcmVuZGVyZXIpLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IuY2xpcGJvYXJkICYmIG5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSAoYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHQgJiYgVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHRleHQudHJpbSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwodGV4dC50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTm8gdmFsaWQgVVJMIG9uIGNsaXBib2FyZCBcdTIwMTQgcHJvbXB0IHRoZSB1c2VyIHRvIHBhc3RlIG9uZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXNlIGEgc2ltcGxlIHByb21wdCBzaW5jZSB0aGlzIGlzIGEgZmFsbGJhY2sgcGF0aC5cbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWFsZXJ0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hbnVhbCA9IHdpbmRvdy5wcm9tcHQoJ1Bhc3RlIFlvdVR1YmUgVVJMIHRvIG9wZW4gaW4gWW91VHViZSBDbGlwcGVyOicpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFudWFsICYmIFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybChtYW51YWwudHJpbSgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwobWFudWFsLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyB2YWxpZCBZb3VUdWJlIFVSTCBwcm92aWRlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsICdPcGVuIFVSTCBmcm9tIGNsaXBib2FyZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhbnVwVUlFbGVtZW50cygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucmliYm9uSWNvbikge1xuICAgICAgICAgICAgdGhpcy5yaWJib25JY29uLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5yaWJib25JY29uID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzYWZlU2hvd1VybE1vZGFsKGluaXRpYWxVcmw/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY2FsbElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXIgWyR7Y2FsbElkfV06IHNhZmVTaG93VXJsTW9kYWwgY2FsbGVkIHdpdGggVVJMOmAsIGluaXRpYWxVcmwpO1xuICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXIgWyR7Y2FsbElkfV06IEN1cnJlbnQgbW9kYWwgc3RhdGUgLSBpc01vZGFsT3BlbjpgLCB0aGlzLmlzTW9kYWxPcGVuLCAncGVuZGluZ01vZGFsVXJsOicsIHRoaXMucGVuZGluZ01vZGFsVXJsKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnNhZmVPcGVyYXRpb24oYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gU3Ryb25nIG1vZGFsIGRlZHVwbGljYXRpb24gLSBwcmV2ZW50IG11bHRpcGxlIG1vZGFscyBmcm9tIG9wZW5pbmdcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTW9kYWxPcGVuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBZb3VUdWJlQ2xpcHBlciBbJHtjYWxsSWR9XTogTU9EQUwgQUxSRUFEWSBPUEVOIC0gSUdOT1JJTkcgcmVxdWVzdCBmb3I6YCwgaW5pdGlhbFVybCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBZb3VUdWJlQ2xpcHBlciBbJHtjYWxsSWR9XTogQ3VycmVudCBwZW5kaW5nIFVSTDpgLCB0aGlzLnBlbmRpbmdNb2RhbFVybCk7XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGlzIGEgZGlmZmVyZW50IFVSTCB0aGFuIHRoZSBwZW5kaW5nIG9uZSwgdXBkYXRlIGl0XG4gICAgICAgICAgICAgICAgaWYgKGluaXRpYWxVcmwgJiYgaW5pdGlhbFVybCAhPT0gdGhpcy5wZW5kaW5nTW9kYWxVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBZb3VUdWJlQ2xpcHBlciBbJHtjYWxsSWR9XTogVXBkYXRpbmcgcGVuZGluZyBtb2RhbCBVUkwgZnJvbTpgLCB0aGlzLnBlbmRpbmdNb2RhbFVybCwgJ3RvOicsIGluaXRpYWxVcmwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdNb2RhbFVybCA9IGluaXRpYWxVcmw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBZb3VUdWJlQ2xpcHBlciBbJHtjYWxsSWR9XTogU2FtZSBVUkwgYXMgcGVuZGluZywgY29tcGxldGVseSBpZ25vcmluZ2ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE1hcmsgdGhhdCB3ZSdyZSBvcGVuaW5nIGEgbW9kYWxcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBZb3VUdWJlQ2xpcHBlciBbJHtjYWxsSWR9XTogU2V0dGluZyBpc01vZGFsT3BlbiA9IHRydWUgZm9yIFVSTDpgLCBpbml0aWFsVXJsKTtcbiAgICAgICAgICAgIHRoaXMuaXNNb2RhbE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5wZW5kaW5nTW9kYWxVcmwgPSBpbml0aWFsVXJsO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXIgWyR7Y2FsbElkfV06IEFib3V0IHRvIG9wZW4gWW91VHViZVVybE1vZGFsIGZvciBVUkw6YCwgaW5pdGlhbFVybCk7XG4gICAgICAgICAgICB0aGlzLm9wZW5Zb3VUdWJlVXJsTW9kYWwoaW5pdGlhbFVybCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBhIGNoZWNrIHRvIHNlZSBpZiBtb2RhbCBzdGF0ZSBjaGFuZ2VzIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXIgWyR7Y2FsbElkfV06IE1vZGFsIHN0YXRlIGFmdGVyIDEwMG1zIC0gaXNNb2RhbE9wZW46YCwgdGhpcy5pc01vZGFsT3Blbik7XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICB9LCAnU2hvdyBVUkwgTW9kYWwnKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNhZmVPcGVyYXRpb248VD4ob3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LCBvcGVyYXRpb25OYW1lOiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgICAgIGlmICh0aGlzLmlzVW5sb2FkaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ1dhcm5pbmcoYEF0dGVtcHRlZCAke29wZXJhdGlvbk5hbWV9IGR1cmluZyBwbHVnaW4gdW5sb2FkIC0gc2tpcHBpbmdgKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgb3BJZCA9ICsrdGhpcy5vcGVyYXRpb25Db3VudDtcbiAgICAgICAgdGhpcy5sb2dJbmZvKGBTdGFydGluZyBvcGVyYXRpb24gJHtvcElkfTogJHtvcGVyYXRpb25OYW1lfWApO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBvcGVyYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMubG9nSW5mbyhgQ29tcGxldGVkIG9wZXJhdGlvbiAke29wSWR9OiAke29wZXJhdGlvbk5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2dFcnJvcihgRmFpbGVkIG9wZXJhdGlvbiAke29wSWR9OiAke29wZXJhdGlvbk5hbWV9YCwgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciBhcyBFcnJvciwgb3BlcmF0aW9uTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgb3BlbllvdVR1YmVVcmxNb2RhbChpbml0aWFsVXJsPzogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzVW5sb2FkaW5nKSB7XG4gICAgICAgICAgICBDb25mbGljdFByZXZlbnRpb24ubG9nKCdQbHVnaW4gaXMgdW5sb2FkaW5nLCBpZ25vcmluZyBtb2RhbCByZXF1ZXN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBDb25mbGljdFByZXZlbnRpb24uc2FmZU9wZXJhdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBQcm92aWRlIGF2YWlsYWJsZSBBSSBwcm92aWRlcnMgYW5kIG1vZGVsIG9wdGlvbnMgdG8gdGhlIG1vZGFsIGZvciBzZWxlY3Rpb25cbiAgICAgICAgICAgIGNvbnN0IGFpU2VydmljZSA9IHRoaXMuc2VydmljZUNvbnRhaW5lcj8uYWlTZXJ2aWNlO1xuICAgICAgICAgICAgY29uc3QgcHJvdmlkZXJzID0gYWlTZXJ2aWNlID8gYWlTZXJ2aWNlLmdldFByb3ZpZGVyTmFtZXMoKSA6IFtdO1xuICAgICAgICAgICAgLy8gUHJlZmVyIGNhY2hlZCBtb2RlbCBvcHRpb25zIGZyb20gc2V0dGluZ3MgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICBjb25zdCBtb2RlbE9wdGlvbnNNYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHRoaXMuc2V0dGluZ3MubW9kZWxPcHRpb25zQ2FjaGUgfHwge307XG4gICAgICAgICAgICBpZiAoYWlTZXJ2aWNlICYmICghdGhpcy5zZXR0aW5ncy5tb2RlbE9wdGlvbnNDYWNoZSB8fCBPYmplY3Qua2V5cyh0aGlzLnNldHRpbmdzLm1vZGVsT3B0aW9uc0NhY2hlKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwIG9mIHByb3ZpZGVycykge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbE9wdGlvbnNNYXBbcF0gPSBhaVNlcnZpY2UuZ2V0UHJvdmlkZXJNb2RlbHMocCkgfHwgW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBZb3VUdWJlVXJsTW9kYWwodGhpcy5hcHAsIHtcbiAgICAgICAgICAgICAgICBvblByb2Nlc3M6IHRoaXMucHJvY2Vzc1lvdVR1YmVWaWRlby5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIG9uT3BlbkZpbGU6IHRoaXMub3BlbkZpbGVCeVBhdGguYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICBpbml0aWFsVXJsOiBpbml0aWFsVXJsLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVycyxcbiAgICAgICAgICAgICAgICBtb2RlbE9wdGlvbnM6IG1vZGVsT3B0aW9uc01hcCxcbiAgICAgICAgICAgICAgICBmZXRjaE1vZGVsczogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgdGhlIGFpU2VydmljZSB0byB0cnkgdG8gZmV0Y2ggbGF0ZXN0IG1vZGVscyBmb3IgYWxsIHByb3ZpZGVyc1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWFwID0gYXdhaXQgKHRoaXMuc2VydmljZUNvbnRhaW5lciEuYWlTZXJ2aWNlIGFzIGFueSkuZmV0Y2hMYXRlc3RNb2RlbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBlcnNpc3QgdG8gc2V0dGluZ3Mgc28gZnV0dXJlIG1vZGFsIG9wZW5zIHVzZSBjYWNoZWQgbGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubW9kZWxPcHRpb25zQ2FjaGUgPSBtYXA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcDtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbE9wdGlvbnNNYXA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIFBlcmZvcm1hbmNlIHNldHRpbmdzIGZyb20gcGx1Z2luIHNldHRpbmdzXG4gICAgICAgICAgICAgICAgcGVyZm9ybWFuY2VNb2RlOiB0aGlzLnNldHRpbmdzLnBlcmZvcm1hbmNlTW9kZSB8fCAnYmFsYW5jZWQnLFxuICAgICAgICAgICAgICAgIGVuYWJsZVBhcmFsbGVsUHJvY2Vzc2luZzogdGhpcy5zZXR0aW5ncy5lbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcgfHwgZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJlZmVyTXVsdGltb2RhbDogdGhpcy5zZXR0aW5ncy5wcmVmZXJNdWx0aW1vZGFsIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgIG9uUGVyZm9ybWFuY2VTZXR0aW5nc0NoYW5nZTogYXN5bmMgKHBlcmZvcm1hbmNlTW9kZTogYW55LCBlbmFibGVQYXJhbGxlbDogYm9vbGVhbiwgcHJlZmVyTXVsdGltb2RhbDogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgcGx1Z2luIHNldHRpbmdzIHdoZW4gY2hhbmdlZCBpbiBtb2RhbFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBlcmZvcm1hbmNlTW9kZSA9IHBlcmZvcm1hbmNlTW9kZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5lbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcgPSBlbmFibGVQYXJhbGxlbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5wcmVmZXJNdWx0aW1vZGFsID0gcHJlZmVyTXVsdGltb2RhbDtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVpbml0aWFsaXplIHNlcnZpY2UgY29udGFpbmVyIHRvIGFwcGx5IG5ldyBzZXR0aW5nc1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2VDb250YWluZXIgPSBuZXcgU2VydmljZUNvbnRhaW5lcih0aGlzLnNldHRpbmdzLCB0aGlzLmFwcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBtb2RhbCBjbG9zZSB0byByZXNldCB0aGUgbW9kYWwgc3RhdGVcbiAgICAgICAgICAgIG1vZGFsLm9uQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiBNb2RhbCBvbkNsb3NlIHRyaWdnZXJlZCBmb3IgVVJMOmAsIGluaXRpYWxVcmwpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXI6IE1vZGFsIHN0YXRlIGJlZm9yZSBjbG9zZSAtIGlzTW9kYWxPcGVuOmAsIHRoaXMuaXNNb2RhbE9wZW4sICdwZW5kaW5nTW9kYWxVcmw6JywgdGhpcy5wZW5kaW5nTW9kYWxVcmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNNb2RhbE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nTW9kYWxVcmwgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFlvdVR1YmVDbGlwcGVyOiBNb2RhbCBzdGF0ZSBhZnRlciBjbG9zZSAtIGlzTW9kYWxPcGVuOmAsIHRoaXMuaXNNb2RhbE9wZW4sICdwZW5kaW5nTW9kYWxVcmw6JywgdGhpcy5wZW5kaW5nTW9kYWxVcmwpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignWW91VHViZUNsaXBwZXI6IEVycm9yIHJlc2V0dGluZyBtb2RhbCBzdGF0ZTonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcmNlIHJlc2V0IGV2ZW4gaWYgdGhlcmUncyBhbiBlcnJvclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTW9kYWxPcGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ01vZGFsVXJsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgWW91VHViZUNsaXBwZXI6IEZvcmNlIHJlc2V0IG1vZGFsIHN0YXRlIGFmdGVyIGVycm9yIC0gaXNNb2RhbE9wZW46YCwgdGhpcy5pc01vZGFsT3Blbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IFJlc2V0IG1vZGFsIHN0YXRlIGFmdGVyIDEwIHNlY29uZHMgYXMgYSBzYWZldHkgbmV0XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01vZGFsT3BlbiAmJiB0aGlzLnBlbmRpbmdNb2RhbFVybCA9PT0gaW5pdGlhbFVybCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1lvdVR1YmVDbGlwcGVyOiBGYWxsYmFjayBtb2RhbCBzdGF0ZSByZXNldCB0cmlnZ2VyZWQgZm9yIFVSTDonLCBpbml0aWFsVXJsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc01vZGFsT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdNb2RhbFVybCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdVR1YmVDbGlwcGVyOiBNb2RhbCBzdGF0ZSBhZnRlciBmYWxsYmFjayByZXNldCAtIGlzTW9kYWxPcGVuOicsIHRoaXMuaXNNb2RhbE9wZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwMDAwKTtcblxuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9LCAnWW91VHViZSBVUkwgTW9kYWwnKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsICdPcGVuaW5nIFlvdVR1YmUgVVJMIG1vZGFsJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1lvdVR1YmVWaWRlbyh1cmw6IHN0cmluZywgZm9ybWF0OiBPdXRwdXRGb3JtYXQgPSAnZGV0YWlsZWQtZ3VpZGUnLCBwcm92aWRlck5hbWU/OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCBjdXN0b21Qcm9tcHQ/OiBzdHJpbmcsIHBlcmZvcm1hbmNlTW9kZT86IFBlcmZvcm1hbmNlTW9kZSwgZW5hYmxlUGFyYWxsZWw/OiBib29sZWFuLCBwcmVmZXJNdWx0aW1vZGFsPzogYm9vbGVhbik6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGlmICh0aGlzLmlzVW5sb2FkaW5nKSB7XG4gICAgICAgICAgICBDb25mbGljdFByZXZlbnRpb24ubG9nKCdQbHVnaW4gaXMgdW5sb2FkaW5nLCBjYW5jZWxsaW5nIHZpZGVvIHByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGx1Z2luIGlzIHNodXR0aW5nIGRvd24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENvbmZsaWN0UHJldmVudGlvbi5zYWZlT3BlcmF0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoTUVTU0FHRVMuUFJPQ0VTU0lORyk7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBWYWxpZGF0aW9uVXRpbHMudmFsaWRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb25maWd1cmF0aW9uIGludmFsaWQ6ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbignLCAnKX1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgeW91dHViZVNlcnZpY2UgPSB0aGlzLnNlcnZpY2VDb250YWluZXIhLnZpZGVvU2VydmljZTtcbiAgICAgICAgICAgIGNvbnN0IGFpU2VydmljZSA9IHRoaXMuc2VydmljZUNvbnRhaW5lciEuYWlTZXJ2aWNlO1xuICAgICAgICAgICAgY29uc3QgZmlsZVNlcnZpY2UgPSB0aGlzLnNlcnZpY2VDb250YWluZXIhLmZpbGVTZXJ2aWNlO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0U2VydmljZSA9IHRoaXMuc2VydmljZUNvbnRhaW5lciEucHJvbXB0U2VydmljZTtcblxuICAgICAgICAgICAgY29uc3QgdmlkZW9JZCA9IHlvdXR1YmVTZXJ2aWNlLmV4dHJhY3RWaWRlb0lkKHVybCk7XG4gICAgICAgICAgICBpZiAoIXZpZGVvSWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLlZJREVPX0lEX0VYVFJBQ1RJT04pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB2aWRlb0RhdGEgPSBhd2FpdCB5b3V0dWJlU2VydmljZS5nZXRWaWRlb0RhdGEodmlkZW9JZCk7XG4gICAgICAgICAgICAvLyBGb3IgJ2N1c3RvbScgZm9ybWF0LCB1c2UgdGhlIHByb3ZpZGVkIGN1c3RvbSBwcm9tcHQ7IG90aGVyd2lzZSBjaGVjayBzZXR0aW5nc1xuICAgICAgICAgICAgbGV0IHByb21wdFRvVXNlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSAnY3VzdG9tJykge1xuICAgICAgICAgICAgICAgIHByb21wdFRvVXNlID0gY3VzdG9tUHJvbXB0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9tcHRUb1VzZSA9IHRoaXMuc2V0dGluZ3MuY3VzdG9tUHJvbXB0cz8uW2Zvcm1hdF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBwcm9tcHRTZXJ2aWNlLmNyZWF0ZUFuYWx5c2lzUHJvbXB0KHZpZGVvRGF0YSwgdXJsLCBmb3JtYXQsIHByb21wdFRvVXNlKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0FJIFByb2Nlc3NpbmcgRGVidWc6Jyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnLSBQcm92aWRlciBzZWxlY3RlZDonLCBwcm92aWRlck5hbWUgfHwgJ0F1dG8nKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCctIE1vZGVsIG92ZXJyaWRlOicsIG1vZGVsIHx8ICdEZWZhdWx0Jyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnLSBQcm92aWRlcnMgYXZhaWxhYmxlOicsIGFpU2VydmljZS5nZXRQcm92aWRlck5hbWVzKCkpO1xuXG4gICAgICAgICAgICBsZXQgYWlSZXNwb25zZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3ZpZGVyTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2Ugc2VsZWN0ZWQgcHJvdmlkZXIgYW5kIG9wdGlvbmFsIG1vZGVsIG92ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIHdpdGggcHJvdmlkZXI6ICR7cHJvdmlkZXJOYW1lfSwgbW9kZWw6ICR7bW9kZWwgfHwgJ2RlZmF1bHQnfWApO1xuICAgICAgICAgICAgICAgICAgICBhaVJlc3BvbnNlID0gYXdhaXQgKGFpU2VydmljZSBhcyBhbnkpLnByb2Nlc3NXaXRoKHByb3ZpZGVyTmFtZSwgcHJvbXB0LCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Byb2Nlc3Npbmcgd2l0aCBhdXRvLXNlbGVjdGVkIHByb3ZpZGVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UgPSBhd2FpdCBhaVNlcnZpY2UucHJvY2Vzcyhwcm9tcHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQUkgUmVzcG9uc2UgcmVjZWl2ZWQ6Jywge1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcjogYWlSZXNwb25zZS5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IGFpUmVzcG9uc2UubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRMZW5ndGg6IGFpUmVzcG9uc2UuY29udGVudD8ubGVuZ3RoIHx8IDBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQUkgUHJvY2Vzc2luZyBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkQ29udGVudCA9IHByb21wdFNlcnZpY2UucHJvY2Vzc0FJUmVzcG9uc2UoXG4gICAgICAgICAgICAgICAgYWlSZXNwb25zZS5jb250ZW50LFxuICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgYWlSZXNwb25zZS5tb2RlbCxcbiAgICAgICAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgICAgICAgdmlkZW9EYXRhLFxuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBmaWxlU2VydmljZS5zYXZlVG9GaWxlKFxuICAgICAgICAgICAgICAgIHZpZGVvRGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub3V0cHV0UGF0aFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbmV3IE5vdGljZShNRVNTQUdFUy5TVUNDRVNTKHZpZGVvRGF0YS50aXRsZSkpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xuICAgICAgICB9LCAnWW91VHViZSBWaWRlbyBQcm9jZXNzaW5nJyk7XG5cbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHByb2Nlc3MgWW91VHViZSB2aWRlbycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIG9wZW5GaWxlQnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDMwMCkpO1xuICAgICAgICAgICAgY29uc3QgY2xlYW5QYXRoID0gZmlsZVBhdGguc3RhcnRzV2l0aCgnLycpID8gZmlsZVBhdGguc3Vic3RyaW5nKDEpIDogZmlsZVBhdGg7XG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGNsZWFuUGF0aCk7XG5cbiAgICAgICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgbm90IGZvdW5kIGF0IHBhdGg6ICR7Y2xlYW5QYXRofWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlIGJ5IHBhdGgnKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBvcGVuRmlsZUluTmV3VGFiKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpIGFzIFdvcmtzcGFjZUxlYWY7XG4gICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobGVhZik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBcdUQ4M0RcdURDQzIgT3BlbmVkOiAke2ZpbGUubmFtZX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgY3VycmVudExlYWYub3BlbkZpbGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHVEODNEXHVEQ0MyIE9wZW5lZDogJHtmaWxlLm5hbWV9YCk7XG4gICAgICAgICAgICB9IGNhdGNoIChmYWxsYmFja0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShmYWxsYmFja0Vycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlIGluIGN1cnJlbnQgdGFiJyk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm90ZSBzYXZlZCBhcyBcIiR7ZmlsZS5uYW1lfVwiIGJ1dCBjb3VsZCBub3QgYXV0by1vcGVuLiBQbGVhc2Ugb3BlbiBtYW51YWxseS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1BlcnNpc3RlbnRTYXZlQ29uZmlybWF0aW9uKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBTYXZlQ29uZmlybWF0aW9uTW9kYWwodGhpcy5hcHAsIGZpbGUsIChzaG91bGRPcGVuKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnU2hvd2luZyBzYXZlIGNvbmZpcm1hdGlvbicpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRmlsZSBzYXZlZDogJHtmaWxlLm5hbWV9LiBDbGljayB0byBvcGVuLmAsIDApLm5vdGljZUVsLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTZXR0aW5nc0NoYW5nZShuZXdTZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzID0geyAuLi5uZXdTZXR0aW5ncyB9O1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2VydmljZUNvbnRhaW5lcj8udXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnU2V0dGluZ3MgdXBkYXRlJyk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgbG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBnZXRTZXJ2aWNlQ29udGFpbmVyKCk6IFNlcnZpY2VDb250YWluZXIgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlQ29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgbG9nSW5mbyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgQ29uZmxpY3RQcmV2ZW50aW9uLmxvZyhgW0lORk9dICR7bWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGxvZ1dhcm5pbmcobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5sb2coYFtXQVJOXSAke21lc3NhZ2V9YCwgJ3dhcm4nKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGxvZ0Vycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I6IEVycm9yKTogdm9pZCB7XG4gICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5sb2coYFtFUlJPUl0gJHttZXNzYWdlfTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIENvbmZsaWN0IHByZXZlbnRpb24gdXRpbGl0aWVzIGZvciBZb3V0dWJlQ2xpcHBlciBQbHVnaW5cbiAqIERlc2lnbmVkIHRvIHByZXZlbnQgY29uZmxpY3RzIHdpdGggb3RoZXIgT2JzaWRpYW4gcGx1Z2luc1xuICovXG5cbmV4cG9ydCBjbGFzcyBDb25mbGljdFByZXZlbnRpb24ge1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFBMVUdJTl9JRCA9ICd5b3V0dWJlLWNsaXBwZXInO1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENTU19QUkVGSVggPSAneXRjJztcbiAgICBcbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhbm90aGVyIHBsdWdpbiBtaWdodCBiZSBjb25mbGljdGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBjaGVja0ZvclBvdGVudGlhbENvbmZsaWN0cygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIFdlYkNsaXBwZXItbGlrZSBwbHVnaW5zXG4gICAgICAgIGNvbnN0IHN1c3BpY2lvdXNFbGVtZW50cyA9IFtcbiAgICAgICAgICAgICdkaXZbZGF0YS1wbHVnaW49XCJ3ZWItY2xpcHBlclwiXScsXG4gICAgICAgICAgICAnLndlYi1jbGlwcGVyLW1vZGFsJyxcbiAgICAgICAgICAgICcuY2xpcHBlci1idXR0b24nLFxuICAgICAgICAgICAgJ1tpZCo9XCJjbGlwcGVyXCJdJyxcbiAgICAgICAgICAgICdbY2xhc3MqPVwiY2xpcFwiXSdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIHN1c3BpY2lvdXNFbGVtZW50cy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goYERldGVjdGVkIHBvdGVudGlhbCBwbHVnaW4gY29uZmxpY3Q6ICR7c2VsZWN0b3J9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHdhcm5pbmdzO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBBZGQgY29uZmxpY3QgcHJldmVudGlvbiBhdHRyaWJ1dGVzIHRvIGFuIGVsZW1lbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgbWFya0VsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQsIHR5cGU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nLCB0aGlzLlBMVUdJTl9JRCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXl0Yy10eXBlJywgdHlwZSk7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoYCR7dGhpcy5DU1NfUFJFRklYfS0ke3R5cGV9YCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBjb25mbGljdCBwcmV2ZW50aW9uIGF0dHJpYnV0ZXNcbiAgICAgKi9cbiAgICBzdGF0aWMgdW5tYXJrRWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEteXRjLXR5cGUnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgY2xhc3NlcyBzdGFydGluZyB3aXRoIG91ciBwcmVmaXhcbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IEFycmF5LmZyb20oZWxlbWVudC5jbGFzc0xpc3QpO1xuICAgICAgICBjbGFzc2VzLmZvckVhY2goY2xhc3NOYW1lID0+IHtcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuc3RhcnRzV2l0aCh0aGlzLkNTU19QUkVGSVgpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmFtZXNwYWNlZCBJRCB0byBwcmV2ZW50IGNvbmZsaWN0c1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVVbmlxdWVJZChiYXNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5DU1NfUFJFRklYfS0ke2Jhc2V9LSR7RGF0ZS5ub3coKX1gO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBhbGwgcGx1Z2luIGVsZW1lbnRzIGZyb20gRE9NXG4gICAgICovXG4gICAgc3RhdGljIGNsZWFudXBBbGxFbGVtZW50cygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1wbHVnaW49XCIke3RoaXMuUExVR0lOX0lEfVwiXWApO1xuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudW5tYXJrRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzYWZlIHN0b3JhZ2Uga2V5IHdpdGggbmFtZXNwYWNlXG4gICAgICovXG4gICAgc3RhdGljIGdldFN0b3JhZ2VLZXkoa2V5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5QTFVHSU5fSUR9LSR7a2V5fWA7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIExvZyBwbHVnaW4gYWN0aXZpdHkgd2l0aCBuYW1lc3BhY2VcbiAgICAgKi9cbiAgICBzdGF0aWMgbG9nKG1lc3NhZ2U6IHN0cmluZywgbGV2ZWw6ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcicgPSAnaW5mbycpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgICBjb25zdCBsb2dNZXNzYWdlID0gYFske3RoaXMuUExVR0lOX0lEfV0gJHt0aW1lc3RhbXB9IC0gJHttZXNzYWdlfWA7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlICd3YXJuJzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4obG9nTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihsb2dNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgcGx1Z2luIGlzIHNhZmUgdG8gb3BlcmF0ZVxuICAgICAqL1xuICAgIHN0YXRpYyBpc1NhZmVUb09wZXJhdGUoKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIGEgc2FmZSBzdGF0ZSB0byBvcGVyYXRlXG4gICAgICAgIGNvbnN0IGNvbmZsaWN0cyA9IHRoaXMuY2hlY2tGb3JQb3RlbnRpYWxDb25mbGljdHMoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFBvdGVudGlhbCBjb25mbGljdHMgZGV0ZWN0ZWQ6ICR7Y29uZmxpY3RzLmpvaW4oJywgJyl9YCwgJ3dhcm4nKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFdyYXAgYXN5bmMgb3BlcmF0aW9ucyB3aXRoIGNvbmZsaWN0IGNoZWNraW5nXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIHNhZmVPcGVyYXRpb248VD4oXG4gICAgICAgIG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgICAgICAgb3BlcmF0aW9uTmFtZTogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgICAgICBpZiAoIXRoaXMuaXNTYWZlVG9PcGVyYXRlKCkpIHtcbiAgICAgICAgICAgIHRoaXMubG9nKGBTa2lwcGluZyAke29wZXJhdGlvbk5hbWV9IGR1ZSB0byBwb3RlbnRpYWwgY29uZmxpY3RzYCwgJ3dhcm4nKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFN0YXJ0aW5nICR7b3BlcmF0aW9uTmFtZX1gKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5sb2coYENvbXBsZXRlZCAke29wZXJhdGlvbk5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2coYEVycm9yIGluICR7b3BlcmF0aW9uTmFtZX06ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICIvKipcbiAqIFVzZXItZmFjaW5nIG1lc3NhZ2VzIGFuZCBub3RpZmljYXRpb25zXG4gKi9cblxuZXhwb3J0IGNvbnN0IE1FU1NBR0VTID0ge1xuICAgIFBST0NFU1NJTkc6ICdQcm9jZXNzaW5nIFlvdVR1YmUgdmlkZW8uLi4nLFxuICAgIFNVQ0NFU1M6ICh0aXRsZTogc3RyaW5nKSA9PiBgU3VjY2Vzc2Z1bGx5IHByb2Nlc3NlZDogJHt0aXRsZX1gLFxuICAgIE9QRU5FRF9GSUxFOiAoZmlsZW5hbWU6IHN0cmluZykgPT4gYE9wZW5lZDogJHtmaWxlbmFtZX1gLFxuICAgIFxuICAgIEVSUk9SUzoge1xuICAgICAgICBJTlZBTElEX1VSTDogJ0ludmFsaWQgWW91VHViZSBVUkwuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgWW91VHViZSB2aWRlbyBVUkwgKGUuZy4sIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9VklERU9fSUQpJyxcbiAgICAgICAgTUlTU0lOR19BUElfS0VZUzogJ05vIHZhbGlkIEdlbWluaSBvciBHcm9xIEFQSSBrZXkgY29uZmlndXJlZC4gUGxlYXNlIHNldCBvbmUgaW4gcGx1Z2luIHNldHRpbmdzLicsXG4gICAgICAgIEdFTUlOSV9JTlZBTElEX0tFWTogJ0dlbWluaSBBUEkga2V5IGlzIGludmFsaWQgb3IgbWlzc2luZy4gUGxlYXNlIGNoZWNrIHlvdXIga2V5LicsXG4gICAgICAgIEdST1FfTU9ERUxfTk9UX0ZPVU5EOiAnR3JvcSBBUEkgZXJyb3I6IE1vZGVsIG5vdCBmb3VuZCBvciB5b3UgZG8gbm90IGhhdmUgYWNjZXNzLiBQbGVhc2UgY2hlY2sgeW91ciBBUEkga2V5IGFuZCBtb2RlbCBuYW1lLicsXG4gICAgICAgIEZFVENIX1ZJREVPX0RBVEE6IChzdGF0dXM6IG51bWJlcikgPT4gYEZhaWxlZCB0byBmZXRjaCB2aWRlbyBtZXRhZGF0YTogJHtzdGF0dXN9YCxcbiAgICAgICAgU0FWRV9GSUxFOiAobWVzc2FnZTogc3RyaW5nKSA9PiBgRmFpbGVkIHRvIHNhdmUgZmlsZTogJHttZXNzYWdlfWAsXG4gICAgICAgIEFJX1BST0NFU1NJTkc6IChtZXNzYWdlOiBzdHJpbmcpID0+IGBBSSBwcm9jZXNzaW5nIGZhaWxlZDogJHttZXNzYWdlfWAsXG4gICAgICAgIEZJTEVfTk9UX0VYSVNUUzogJ0ZpbGUgbm8gbG9uZ2VyIGV4aXN0cycsXG4gICAgICAgIENPVUxEX05PVF9PUEVOOiAobWVzc2FnZTogc3RyaW5nKSA9PiBgQ291bGQgbm90IG9wZW4gZmlsZTogJHttZXNzYWdlfWAsXG4gICAgICAgIEVOVEVSX1VSTDogJ1BsZWFzZSBlbnRlciBhIFlvdVR1YmUgVVJMJyxcbiAgICAgICAgVklERU9fSURfRVhUUkFDVElPTjogJ0NvdWxkIG5vdCBleHRyYWN0IHZpZGVvIElEIGZyb20gVVJMLiBQbGVhc2UgY2hlY2sgdGhlIFVSTCBmb3JtYXQuJyxcbiAgICAgICAgTkVUV09SS19FUlJPUjogJ05ldHdvcmsgZXJyb3Igb2NjdXJyZWQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4nXG4gICAgfSxcbiAgICBcbiAgICBXQVJOSU5HUzoge1xuICAgICAgICBDT1JTX1JFU1RSSUNUSU9OUzogJ0Rlc2NyaXB0aW9uIG5vdCBhdmFpbGFibGUgZHVlIHRvIENPUlMgcmVzdHJpY3Rpb25zJyxcbiAgICAgICAgRVhUUkFDVElPTl9GQUlMRUQ6ICdEZXNjcmlwdGlvbiBleHRyYWN0aW9uIGZhaWxlZCcsXG4gICAgICAgIEFVVE9fRVhUUkFDVElPTjogJ1ZpZGVvIGRlc2NyaXB0aW9uIGNvdWxkIG5vdCBiZSBleHRyYWN0ZWQgYXV0b21hdGljYWxseS4nXG4gICAgfSxcbiAgICBcbiAgICBNT0RBTFM6IHtcbiAgICAgICAgWU9VVFVCRV9QUk9DRVNTRUQ6ICdZb3VUdWJlIFZpZGVvIFByb2Nlc3NlZCcsXG4gICAgICAgIENPTkZJUk1fT1BFTjogKGZpbGVuYW1lOiBzdHJpbmcpID0+IGBTdWNjZXNzZnVsbHkgcHJvY2Vzc2VkIFlvdVR1YmUgdmlkZW8gYW5kIHNhdmVkIGFzIFwiJHtmaWxlbmFtZX1cIi4gV291bGQgeW91IGxpa2UgdG8gb3BlbiB0aGUgbm90ZSBub3c/YCxcbiAgICAgICAgQ0xPU0VfQ09ORklSTUFUSU9OOiAnQ2xvc2Ugd2l0aG91dCBvcGVuaW5nIHRoZSBub3RlPycsXG4gICAgICAgIFBST0NFU1NfVklERU86ICdQcm9jZXNzIFlvdVR1YmUgVmlkZW8nLFxuICAgICAgICBZRVNfT1BFTjogJ1llcywgb3BlbiBub3RlJyxcbiAgICAgICAgTk9fVEhBTktTOiAnTm8sIHRoYW5rcycsXG4gICAgICAgIENBTkNFTDogJ0NhbmNlbCcsXG4gICAgICAgIFBST0NFU1M6ICdQcm9jZXNzJ1xuICAgIH0sXG4gICAgXG4gICAgUExBQ0VIT0xERVJTOiB7XG4gICAgICAgIFlPVVRVQkVfVVJMOiAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0uLi4nLFxuICAgICAgICBHRU1JTklfS0VZOiAnQUl6YS4uLicsXG4gICAgICAgIEdST1FfS0VZOiAnZ3NrXy4uLicsXG4gICAgICAgIE9VVFBVVF9QQVRIOiAnWW91VHViZS9Qcm9jZXNzZWQgVmlkZW9zJ1xuICAgIH1cbn0gYXMgY29uc3Q7XG4iLCAiLyoqXG4gKiBJbnB1dCB2YWxpZGF0aW9uIHV0aWxpdGllc1xuICovXG5cbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5cbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uVXRpbHMge1xuICAgIC8qKlxuICAgICAqIFlvdVR1YmUgVVJMIHBhdHRlcm5zIGZvciB2YWxpZGF0aW9uIChvcmRlcmVkIGJ5IGZyZXF1ZW5jeSBmb3IgcGVyZm9ybWFuY2UpXG4gICAgICogRW5oYW5jZWQgcGF0dGVybnMgdG8gaGFuZGxlIHZhcmlvdXMgWW91VHViZSBVUkwgZm9ybWF0c1xuICAgICAqL1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFVSTF9QQVRURVJOUyA9IFtcbiAgICAgICAgLy8gU3RhbmRhcmQgeW91dHViZS5jb20vd2F0Y2g/dj0gZm9ybWF0IChtb3N0IGNvbW1vbilcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL3dhdGNoXFw/dj0oW2EtekEtWjAtOV8tXXsxMX0pKD86Ji4qKT8kLyxcbiAgICAgICAgLy8geW91dHUuYmUgc2hvcnQgZm9ybWF0IChzZWNvbmQgbW9zdCBjb21tb24pXG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT8oPzp3d3dcXC4pP3lvdXR1XFwuYmVcXC8oW2EtekEtWjAtOV8tXXsxMX0pKD86XFw/LiopPyQvLFxuICAgICAgICAvLyB5b3V0dWJlLmNvbS9lbWJlZCBmb3JtYXRcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL2VtYmVkXFwvKFthLXpBLVowLTlfLV17MTF9KSg/OlxcPy4qKT8kLyxcbiAgICAgICAgLy8geW91dHViZS5jb20vdiBmb3JtYXRcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL3ZcXC8oW2EtekEtWjAtOV8tXXsxMX0pKD86XFw/LiopPyQvLFxuICAgICAgICAvLyBNb2JpbGUgeW91dHViZS5jb20gZm9ybWF0XG4gICAgICAgIC8oPzpodHRwcz86XFwvXFwvKT8oPzptXFwuKT95b3V0dWJlXFwuY29tXFwvd2F0Y2hcXD92PShbYS16QS1aMC05Xy1dezExfSkoPzomLiopPyQvXG4gICAgXTtcblxuICAgIC8vIE1lbW9pemVkIHJlZ2V4IGZvciB2aWRlbyBJRCB2YWxpZGF0aW9uIChob3QgcGF0aCBvcHRpbWl6YXRpb24pXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVklERU9fSURfUkVHRVggPSAvXlthLXpBLVowLTlfLV17MTF9JC87XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVVJMX0NBQ0hFID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZyB8IG51bGw+KCk7XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiBhbmQgbm9ybWFsaXplIFlvdVR1YmUgVVJMXG4gICAgICovXG4gICAgc3RhdGljIGNsZWFuWW91VHViZVVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZW1vdmUgZXh0cmEgd2hpdGVzcGFjZSBhbmQgbm9ybWFsaXplXG4gICAgICAgIGxldCBjbGVhblVybCA9IHVybC50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgVVJMcyB0aGF0IG1pZ2h0IGhhdmUgYmVlbiBjb3B5LXBhc3RlZCB3aXRoIGV4dHJhIGNoYXJhY3RlcnNcbiAgICAgICAgY2xlYW5VcmwgPSBjbGVhblVybC5yZXBsYWNlKC9bXFx1MjAwQi1cXHUyMDBEXFx1RkVGRl0vZywgJycpOyAvLyBSZW1vdmUgemVyby13aWR0aCBjaGFyYWN0ZXJzXG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgaHR0cHM6Ly8gaWYgbWlzc2luZyBwcm90b2NvbFxuICAgICAgICBpZiAoIWNsZWFuVXJsLnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSAmJiAhY2xlYW5Vcmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKSkge1xuICAgICAgICAgICAgY2xlYW5VcmwgPSAnaHR0cHM6Ly8nICsgY2xlYW5Vcmw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb252ZXJ0IGh0dHAgdG8gaHR0cHMgZm9yIFlvdVR1YmVcbiAgICAgICAgaWYgKGNsZWFuVXJsLnN0YXJ0c1dpdGgoJ2h0dHA6Ly95b3V0dWJlLmNvbScpIHx8IGNsZWFuVXJsLnN0YXJ0c1dpdGgoJ2h0dHA6Ly93d3cueW91dHViZS5jb20nKSkge1xuICAgICAgICAgICAgY2xlYW5VcmwgPSBjbGVhblVybC5yZXBsYWNlKCdodHRwOi8vJywgJ2h0dHBzOi8vJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2xlYW5Vcmw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBZb3VUdWJlIHZpZGVvIElEIGZyb20gVVJMIChtZW1vaXplZCBmb3IgcGVyZm9ybWFuY2UpXG4gICAgICogRW5oYW5jZWQgZXh0cmFjdGlvbiB3aXRoIGJldHRlciBlcnJvciBoYW5kbGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBleHRyYWN0VmlkZW9JZCh1cmw6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBpZiAoIXVybCB8fCB0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBjYWNoZSBmaXJzdCAoTygxKSBmb3IgcmVwZWF0ZWQgVVJMcylcbiAgICAgICAgaWYgKHRoaXMuVVJMX0NBQ0hFLmhhcyh1cmwpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5VUkxfQ0FDSEUuZ2V0KHVybCkhO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xlYW5VcmwgPSB0aGlzLmNsZWFuWW91VHViZVVybCh1cmwpO1xuICAgICAgICBsZXQgcmVzdWx0OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgICAgICAvLyBEaXJlY3QgaW5kZXggYWNjZXNzIGZvciBtb3N0IGNvbW1vbiBwYXR0ZXJuIGZpcnN0IChtaWNyby1vcHRpbWl6YXRpb24pXG4gICAgICAgIGxldCBtYXRjaCA9IGNsZWFuVXJsLm1hdGNoKHRoaXMuVVJMX1BBVFRFUk5TWzBdKTsgLy8gTW9zdCBjb21tb24gcGF0dGVybiBmaXJzdFxuICAgICAgICBpZiAobWF0Y2g/LlsxXSAmJiB0aGlzLlZJREVPX0lEX1JFR0VYLnRlc3QobWF0Y2hbMV0pKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBtYXRjaFsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIHJlbWFpbmluZyBwYXR0ZXJuc1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLlVSTF9QQVRURVJOUy5sZW5ndGggJiYgIXJlc3VsdDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2ggPSBjbGVhblVybC5tYXRjaCh0aGlzLlVSTF9QQVRURVJOU1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoPy5bMV0gJiYgdGhpcy5WSURFT19JRF9SRUdFWC50ZXN0KG1hdGNoWzFdKSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYWNoZSByZXN1bHQgd2l0aCBzaW1wbGUgTFJVIGV2aWN0aW9uXG4gICAgICAgIGlmICh0aGlzLlVSTF9DQUNIRS5zaXplID4gMTAwKSB7XG4gICAgICAgICAgICB0aGlzLlVSTF9DQUNIRS5jbGVhcigpOyAvLyBTaW1wbGUgTFJVIGJ5IGNsZWFyaW5nIHdoZW4gZnVsbFxuICAgICAgICB9XG4gICAgICAgIHRoaXMuVVJMX0NBQ0hFLnNldCh1cmwsIHJlc3VsdCk7XG5cbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGV4dHJhY3QgdmlkZW8gSUQgZnJvbSBVUkw6JywgdXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgWW91VHViZSBVUkwgZm9ybWF0XG4gICAgICovXG4gICAgc3RhdGljIGlzVmFsaWRZb3VUdWJlVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RWaWRlb0lkKHVybCkgIT09IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FuaXRpemUgZmlsZW5hbWUgZm9yIGZpbGUgc3lzdGVtIGNvbXBhdGliaWxpdHlcbiAgICAgKi9cbiAgICBzdGF0aWMgc2FuaXRpemVGaWxlbmFtZShmaWxlbmFtZTogc3RyaW5nLCBtYXhMZW5ndGggPSAxMDApOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gZmlsZW5hbWVcbiAgICAgICAgICAgIC5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJycpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCAnICcpXG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAuc3Vic3RyaW5nKDAsIG1heExlbmd0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgQVBJIGtleSBmb3JtYXRcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNWYWxpZEFQSUtleShrZXk6IHN0cmluZywgcHJvdmlkZXI6ICdnZW1pbmknIHwgJ2dyb3EnKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICgha2V5IHx8IHR5cGVvZiBrZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKHByb3ZpZGVyKSB7XG4gICAgICAgICAgICBjYXNlICdnZW1pbmknOlxuICAgICAgICAgICAgICAgIHJldHVybiBrZXkuc3RhcnRzV2l0aCgnQUl6YScpICYmIGtleS5sZW5ndGggPiAxMDtcbiAgICAgICAgICAgIGNhc2UgJ2dyb3EnOlxuICAgICAgICAgICAgICAgIHJldHVybiBrZXkuc3RhcnRzV2l0aCgnZ3NrXycpICYmIGtleS5sZW5ndGggPiAxMDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgc2V0dGluZ3MgY29uZmlndXJhdGlvblxuICAgICAqL1xuICAgIHN0YXRpYyB2YWxpZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBhbnkpOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBjb25zdCB1c2luZ0VudiA9IEJvb2xlYW4oc2V0dGluZ3MudXNlRW52aXJvbm1lbnRWYXJpYWJsZXMpO1xuICAgICAgICBjb25zdCBoYXNEaXJlY3RLZXkgPSB0aGlzLmlzTm9uRW1wdHlTdHJpbmcoc2V0dGluZ3MuZ2VtaW5pQXBpS2V5KSB8fCB0aGlzLmlzTm9uRW1wdHlTdHJpbmcoc2V0dGluZ3MuZ3JvcUFwaUtleSk7XG5cbiAgICAgICAgaWYgKCFoYXNEaXJlY3RLZXkgJiYgIXVzaW5nRW52KSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChNRVNTQUdFUy5FUlJPUlMuTUlTU0lOR19BUElfS0VZUyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pc05vbkVtcHR5U3RyaW5nKHNldHRpbmdzLmdlbWluaUFwaUtleSkgJiYgIXRoaXMuaXNWYWxpZEFQSUtleShzZXR0aW5ncy5nZW1pbmlBcGlLZXksICdnZW1pbmknKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goJ0ludmFsaWQgR2VtaW5pIEFQSSBrZXkgZm9ybWF0Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pc05vbkVtcHR5U3RyaW5nKHNldHRpbmdzLmdyb3FBcGlLZXkpICYmICF0aGlzLmlzVmFsaWRBUElLZXkoc2V0dGluZ3MuZ3JvcUFwaUtleSwgJ2dyb3EnKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goJ0ludmFsaWQgR3JvcSBBUEkga2V5IGZvcm1hdCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHVzaW5nRW52ICYmICF0aGlzLmlzTm9uRW1wdHlTdHJpbmcoc2V0dGluZ3MuZW52aXJvbm1lbnRQcmVmaXgpKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCgnRW52aXJvbm1lbnQgdmFyaWFibGUgcHJlZml4IGlzIHJlcXVpcmVkIHdoZW4gdXNpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNldHRpbmdzLm91dHB1dFBhdGggfHwgdHlwZW9mIHNldHRpbmdzLm91dHB1dFBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCgnT3V0cHV0IHBhdGggaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgZXJyb3JzXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgZmlsZSBwYXRoXG4gICAgICovXG4gICAgc3RhdGljIGlzVmFsaWRQYXRoKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHlwZW9mIHBhdGggPT09ICdzdHJpbmcnICYmIHBhdGgudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgdGhhdCBhIHN0cmluZyBpcyBub3QgZW1wdHlcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNOb25FbXB0eVN0cmluZyh2YWx1ZTogYW55KTogdmFsdWUgaXMgc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJ1bmNhdGUgdGV4dCB0byBzcGVjaWZpZWQgbGVuZ3RoIHdpdGggZWxsaXBzaXNcbiAgICAgKi9cbiAgICBzdGF0aWMgdHJ1bmNhdGVUZXh0KHRleHQ6IHN0cmluZywgbWF4TGVuZ3RoOiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGV4dC5sZW5ndGggPD0gbWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGV4dC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoIC0gMykgKyAnLi4uJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiBIVE1MIGVudGl0aWVzIGFuZCBlc2NhcGUgc2VxdWVuY2VzIGZyb20gdGV4dFxuICAgICAqL1xuICAgIHN0YXRpYyBjbGVhblRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRleHRcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcbi9nLCAnXFxuJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcJy9nLCBcIidcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcdShbMC05YS1mQS1GXXs0fSkvZywgKG1hdGNoLCBjb2RlKSA9PiBcbiAgICAgICAgICAgICAgICBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGNvZGUsIDE2KSlcbiAgICAgICAgICAgICk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogQ2VudHJhbGl6ZWQgZXJyb3IgaGFuZGxpbmcgdG8gZWxpbWluYXRlIGNvZGUgZHVwbGljYXRpb25cbiAqL1xuXG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXJJbnRlcmZhY2UgfSBmcm9tICcuLi90eXBlcy90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBFcnJvckhhbmRsZXIgaW1wbGVtZW50cyBFcnJvckhhbmRsZXJJbnRlcmZhY2Uge1xuICAgIC8qKlxuICAgICAqIEhhbmRsZSBlcnJvcnMgd2l0aCBjb25zaXN0ZW50IGxvZ2dpbmcgYW5kIHVzZXIgZmVlZGJhY2tcbiAgICAgKi9cbiAgICBzdGF0aWMgaGFuZGxlKGVycm9yOiBFcnJvciwgY29udGV4dDogc3RyaW5nLCBzaG93Tm90aWNlID0gdHJ1ZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBgJHtjb250ZXh0fTogJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlLCBlcnJvcik7XG4gICAgICAgIFxuICAgICAgICBpZiAoc2hvd05vdGljZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYW4gb3BlcmF0aW9uIHdpdGggYXV0b21hdGljIGVycm9yIGhhbmRsaW5nXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIHdpdGhFcnJvckhhbmRsaW5nPFQ+KFxuICAgICAgICBvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sXG4gICAgICAgIGNvbnRleHQ6IHN0cmluZyxcbiAgICAgICAgc2hvd05vdGljZSA9IHRydWVcbiAgICApOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgb3BlcmF0aW9uKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZShlcnJvciBhcyBFcnJvciwgY29udGV4dCwgc2hvd05vdGljZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYSBzeW5jaHJvbm91cyBvcGVyYXRpb24gd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyB3aXRoU3luY0Vycm9ySGFuZGxpbmc8VD4oXG4gICAgICAgIG9wZXJhdGlvbjogKCkgPT4gVCxcbiAgICAgICAgY29udGV4dDogc3RyaW5nLFxuICAgICAgICBzaG93Tm90aWNlID0gdHJ1ZVxuICAgICk6IFQgfCBudWxsIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBvcGVyYXRpb24oKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlKGVycm9yIGFzIEVycm9yLCBjb250ZXh0LCBzaG93Tm90aWNlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc3RhbmRhcmRpemVkIGVycm9yIGZvciBBUEkgcmVzcG9uc2VzXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZUFQSUVycm9yKFxuICAgICAgICBwcm92aWRlcjogc3RyaW5nLFxuICAgICAgICBzdGF0dXM6IG51bWJlcixcbiAgICAgICAgc3RhdHVzVGV4dDogc3RyaW5nLFxuICAgICAgICBkZXRhaWxzPzogc3RyaW5nXG4gICAgKTogRXJyb3Ige1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gYCR7cHJvdmlkZXJ9IEFQSSBlcnJvcjogJHtzdGF0dXN9ICR7c3RhdHVzVGV4dH0ke2RldGFpbHMgPyBgLiAke2RldGFpbHN9YCA6ICcnfWA7XG4gICAgICAgIHJldHVybiBuZXcgRXJyb3IobWVzc2FnZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIEFQSSByZXNwb25zZSBlcnJvcnMgd2l0aCBjb25zaXN0ZW50IGZvcm1hdFxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBoYW5kbGVBUElFcnJvcihcbiAgICAgICAgcmVzcG9uc2U6IFJlc3BvbnNlLFxuICAgICAgICBwcm92aWRlcjogc3RyaW5nLFxuICAgICAgICBmYWxsYmFja01lc3NhZ2U/OiBzdHJpbmdcbiAgICApOiBQcm9taXNlPG5ldmVyPiB7XG4gICAgICAgIGxldCBlcnJvckRldGFpbHMgPSBmYWxsYmFja01lc3NhZ2UgfHwgJyc7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgZXJyb3JEZXRhaWxzID0gZXJyb3JEYXRhLmVycm9yPy5tZXNzYWdlIHx8IGVycm9yRGF0YS5tZXNzYWdlIHx8IGZhbGxiYWNrTWVzc2FnZSB8fCAnJztcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAvLyBJZ25vcmUgSlNPTiBwYXJzaW5nIGVycm9yc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZUFQSUVycm9yKHByb3ZpZGVyLCByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnN0YXR1c1RleHQsIGVycm9yRGV0YWlscyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcmVxdWlyZWQgY29uZmlndXJhdGlvbiBhbmQgdGhyb3cgZGVzY3JpcHRpdmUgZXJyb3JzXG4gICAgICovXG4gICAgc3RhdGljIHZhbGlkYXRlQ29uZmlndXJhdGlvbihjb25maWc6IFJlY29yZDxzdHJpbmcsIGFueT4sIHJlcXVpcmVkRmllbGRzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBjb25zdCBtaXNzaW5nID0gcmVxdWlyZWRGaWVsZHMuZmlsdGVyKGZpZWxkID0+ICFjb25maWdbZmllbGRdKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChtaXNzaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBjb25maWd1cmF0aW9uOiAke21pc3Npbmcuam9pbignLCAnKX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHVzZXItZnJpZW5kbHkgZXJyb3IgbWVzc2FnZSBmb3IgY29tbW9uIHNjZW5hcmlvc1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVVc2VyRnJpZW5kbHlFcnJvcihlcnJvcjogRXJyb3IsIG9wZXJhdGlvbjogc3RyaW5nKTogRXJyb3Ige1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gYEZhaWxlZCB0byAke29wZXJhdGlvbn06ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgICByZXR1cm4gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vIEluc3RhbmNlIG1ldGhvZHMgaW1wbGVtZW50aW5nIGludGVyZmFjZVxuICAgIGhhbmRsZShlcnJvcjogRXJyb3IsIGNvbnRleHQ6IHN0cmluZywgc2hvd05vdGljZSA9IHRydWUpOiB2b2lkIHtcbiAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciwgY29udGV4dCwgc2hvd05vdGljZSk7XG4gICAgfVxuXG4gICAgYXN5bmMgd2l0aEVycm9ySGFuZGxpbmc8VD4oXG4gICAgICAgIG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgICAgICAgY29udGV4dDogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgICAgICByZXR1cm4gRXJyb3JIYW5kbGVyLndpdGhFcnJvckhhbmRsaW5nKG9wZXJhdGlvbiwgY29udGV4dCk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU2F2ZSBDb25maXJtYXRpb24gTW9kYWxcbiAqIFNob3dzIGEgcGVyc2lzdGVudCBjb25maXJtYXRpb24gZGlhbG9nIHdoZW4gYSBmaWxlIGhhcyBiZWVuIHNhdmVkXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgVEZpbGUsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBTYXZlQ29uZmlybWF0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIG9uQ29uZmlybTogKHNob3VsZE9wZW46IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZTogVEZpbGUsIG9uQ29uZmlybTogKHNob3VsZE9wZW46IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5vbkNvbmZpcm0gPSBvbkNvbmZpcm07XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEVYQUNUIHNwZWNpZmljYXRpb24gZnJvbSB0YXNrc18xLm1kIFN0ZXAgNVxuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ05vdGUgY3JlYXRlZCBzdWNjZXNzZnVsbHkuIE9wZW4gbm93PycgfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBidXR0b25zIGNvbnRhaW5lclxuICAgICAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignc2F2ZS1jb25maXJtYXRpb24tYnV0dG9ucycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgYnV0dG9ucyBhcyBwZXIgc3BlY2lmaWNhdGlvbjogXCJPcGVuIE5vdGVcIiB8IFwiRGlzbWlzc1wiXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhidXR0b25Db250YWluZXIpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdPcGVuIE5vdGUnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNvbmZpcm0odHJ1ZSk7IC8vIFVzZXIgd2FudHMgdG8gb3BlbiB0aGUgZmlsZVxuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0Rpc21pc3MnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ29uZmlybShmYWxzZSk7IC8vIFVzZXIgZGlzbWlzc2VzXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgLy8gRm9jdXMgdGhlIE9wZW4gTm90ZSBidXR0b24gZm9yIGJldHRlciBVWFxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3BlbkJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcbiAgICAgICAgICAgICAgICBpZiAob3BlbkJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICAob3BlbkJ1dHRvbiBhcyBIVE1MRWxlbWVudCkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbU2F2ZUNvbmZpcm1hdGlvbk1vZGFsXSBFcnJvciBpbiBvbk9wZW46JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgY29udGVudFxuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0ZpbGUgU2F2ZWQnIH0pO1xuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBgRmlsZSBcIiR7dGhpcy5maWxlLm5hbWV9XCIgaGFzIGJlZW4gc2F2ZWQgc3VjY2Vzc2Z1bGx5LmAgfSk7XG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ09LJyB9KS5vbmNsaWNrID0gKCkgPT4gdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGh1bWFuLXJlYWRhYmxlIGZpbGUgc2l6ZVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0RmlsZVNpemUoKTogc3RyaW5nIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXQgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnN0YXQodGhpcy5maWxlLnBhdGgpO1xuICAgICAgICAgICAgaWYgKHN0YXQgJiYgdHlwZW9mIHN0YXQgPT09ICdvYmplY3QnICYmICdzaXplJyBpbiBzdGF0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnl0ZXMgPSAoc3RhdCBhcyBhbnkpLnNpemU7XG4gICAgICAgICAgICAgICAgaWYgKGJ5dGVzIDwgMTAyNCkgcmV0dXJuIGAke2J5dGVzfSBieXRlc2A7XG4gICAgICAgICAgICAgICAgaWYgKGJ5dGVzIDwgMTAyNCAqIDEwMjQpIHJldHVybiBgJHsoYnl0ZXMgLyAxMDI0KS50b0ZpeGVkKDEpfSBLQmA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAkeyhieXRlcyAvICgxMDI0ICogMTAyNCkpLnRvRml4ZWQoMSl9IE1CYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZpbGUgc2l6ZSBub3QgYXZhaWxhYmxlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgY3VzdG9tIHN0eWxlcyBmb3IgdGhlIG1vZGFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRTdHlsZXMoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIENTUyBjbGFzc2VzIGZvciBzdHlsaW5nXG4gICAgICAgIGNvbnRlbnRFbC5hZGRDbGFzcygneXRwLXNhdmUtY29uZmlybWF0aW9uLW1vZGFsJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgaW5saW5lIHN0eWxlcyBpZiBuZWVkZWRcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IGBcbiAgICAgICAgICAgIC55dHAtc2F2ZS1jb25maXJtYXRpb24tbW9kYWwge1xuICAgICAgICAgICAgICAgIG1pbi13aWR0aDogNDUwcHg7XG4gICAgICAgICAgICAgICAgbWF4LXdpZHRoOiA2NTBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLW1lc3NhZ2Uge1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMjBweCAwIDMwcHggMDtcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1maWxlbmFtZSB7XG4gICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxLjFlbTtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4O1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LWFjY2VudCk7XG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tbG9jYXRpb24tY29udGFpbmVyLFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLXNpemUtY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgICBnYXA6IDhweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLWxvY2F0aW9uIHtcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA0cHggOHB4O1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOWVtO1xuICAgICAgICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG4gICAgICAgICAgICAgICAgZmxleDogMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLXNpemUge1xuICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1zdWNjZXNzKTtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiA0cHggOHB4O1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOWVtO1xuICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1idXR0b25zIHtcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgICAgIGdhcDogMTVweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLWJ1dHRvbnMgLnNldHRpbmctaXRlbSB7XG4gICAgICAgICAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgICAgZ2FwOiAxMHB4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tYnV0dG9ucyBidXR0b24ge1xuICAgICAgICAgICAgICAgIG1pbi13aWR0aDogMTAwcHg7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogOHB4IDIwcHg7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1idXR0b25zIGJ1dHRvbjpmaXJzdC1jaGlsZCB7XG4gICAgICAgICAgICAgICAgLyogT3BlbiBGaWxlIGJ1dHRvbiAtIHByaW1hcnkgYWN0aW9uICovXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tYnV0dG9ucyBidXR0b246bGFzdC1jaGlsZCB7XG4gICAgICAgICAgICAgICAgLyogT0sgYnV0dG9uIC0gc2Vjb25kYXJ5IGFjdGlvbiAqL1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBTdG9yZSByZWZlcmVuY2UgdG8gY2xlYW4gdXAgbGF0ZXJcbiAgICAgICAgdGhpcy5tb2RhbEVsPy5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3R5bGUtaWQnLCAneXRwLXNhdmUtY29uZmlybWF0aW9uLXN0eWxlJyk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogWW91VHViZSBVUkwgaW5wdXQgbW9kYWwgY29tcG9uZW50XG4gKi9cblxuaW1wb3J0IHsgQXBwLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCYXNlTW9kYWwgfSBmcm9tICcuL2Jhc2UtbW9kYWwnO1xuaW1wb3J0IHsgTUVTU0FHRVMgfSBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCB7IFBST1ZJREVSX01PREVMX09QVElPTlMsIEFJX01PREVMUyB9IGZyb20gJy4vYXBpJztcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4vdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuL3NlcnZpY2VzL2Vycm9yLWhhbmRsZXInO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQZXJmb3JtYW5jZU1vZGUgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBZb3VUdWJlVXJsTW9kYWxPcHRpb25zIHtcbiAgICBvblByb2Nlc3M6ICh1cmw6IHN0cmluZywgZm9ybWF0OiBPdXRwdXRGb3JtYXQsIHByb3ZpZGVyPzogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgY3VzdG9tUHJvbXB0Pzogc3RyaW5nLCBwZXJmb3JtYW5jZU1vZGU/OiBQZXJmb3JtYW5jZU1vZGUsIGVuYWJsZVBhcmFsbGVsPzogYm9vbGVhbiwgcHJlZmVyTXVsdGltb2RhbD86IGJvb2xlYW4pID0+IFByb21pc2U8c3RyaW5nPjsgLy8gUmV0dXJuIGZpbGUgcGF0aFxuICAgIG9uT3BlbkZpbGU/OiAoZmlsZVBhdGg6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBpbml0aWFsVXJsPzogc3RyaW5nO1xuICAgIHByb3ZpZGVycz86IHN0cmluZ1tdOyAvLyBhdmFpbGFibGUgcHJvdmlkZXIgbmFtZXNcbiAgICBtb2RlbE9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47IC8vIG1hcHBpbmcgcHJvdmlkZXJOYW1lIC0+IG1vZGVsc1xuICAgIGRlZmF1bHRQcm92aWRlcj86IHN0cmluZztcbiAgICBkZWZhdWx0TW9kZWw/OiBzdHJpbmc7XG4gICAgZmV0Y2hNb2RlbHM/OiAoKSA9PiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPj47XG4gICAgLy8gUGVyZm9ybWFuY2Ugc2V0dGluZ3MgZnJvbSBwbHVnaW4gc2V0dGluZ3NcbiAgICBwZXJmb3JtYW5jZU1vZGU/OiBQZXJmb3JtYW5jZU1vZGU7XG4gICAgZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nPzogYm9vbGVhbjtcbiAgICBwcmVmZXJNdWx0aW1vZGFsPzogYm9vbGVhbjtcbiAgICBvblBlcmZvcm1hbmNlU2V0dGluZ3NDaGFuZ2U/OiAocGVyZm9ybWFuY2VNb2RlOiBQZXJmb3JtYW5jZU1vZGUsIGVuYWJsZVBhcmFsbGVsOiBib29sZWFuLCBwcmVmZXJNdWx0aW1vZGFsOiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+O1xufVxuXG50eXBlIFN0ZXBTdGF0ZSA9ICdwZW5kaW5nJyB8ICdhY3RpdmUnIHwgJ2NvbXBsZXRlJyB8ICdlcnJvcic7XG5cbmV4cG9ydCBjbGFzcyBZb3VUdWJlVXJsTW9kYWwgZXh0ZW5kcyBCYXNlTW9kYWwge1xuICAgIHByaXZhdGUgdXJsID0gJyc7XG4gICAgcHJpdmF0ZSBmb3JtYXQ6IE91dHB1dEZvcm1hdCA9ICdleGVjdXRpdmUtc3VtbWFyeSc7XG4gICAgcHJpdmF0ZSBoZWFkZXJFbD86IEhUTUxIZWFkaW5nRWxlbWVudDtcbiAgICBwcml2YXRlIHVybElucHV0PzogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcml2YXRlIHBhc3RlQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBjbGVhckJ1dHRvbj86IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgcHJvY2Vzc0J1dHRvbj86IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgb3BlbkJ1dHRvbj86IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgdGh1bWJuYWlsRWw/OiBIVE1MSW1hZ2VFbGVtZW50O1xuICAgIHByaXZhdGUgbWV0YWRhdGFDb250YWluZXI/OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGZldGNoSW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgIHByaXZhdGUgcHJvdmlkZXJTZWxlY3Q/OiBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICBwcml2YXRlIG1vZGVsU2VsZWN0PzogSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSByZWZyZXNoU3Bpbm5lcj86IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIHNlbGVjdGVkUHJvdmlkZXI/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzZWxlY3RlZE1vZGVsPzogc3RyaW5nO1xuICAgIHByaXZhdGUgcHJvZ3Jlc3NDb250YWluZXI/OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHByb2dyZXNzQmFyPzogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwcm9ncmVzc1RleHQ/OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHZhbGlkYXRpb25NZXNzYWdlPzogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwcm9ncmVzc1N0ZXBzOiB7IGxhYmVsOiBzdHJpbmc7IGVsZW1lbnQ6IEhUTUxMSUVsZW1lbnQgfVtdID0gW107XG4gICAgcHJpdmF0ZSBjdXJyZW50U3RlcEluZGV4ID0gMDtcbiAgICBwcml2YXRlIGlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgIHByaXZhdGUgcHJvY2Vzc2VkRmlsZVBhdGg/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBjdXN0b21Qcm9tcHRJbnB1dD86IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBjdXN0b21Qcm9tcHRDb250YWluZXI/OiBIVE1MRGl2RWxlbWVudDtcblxuICAgIC8vIFBlcmZvcm1hbmNlIHNldHRpbmdzXG4gICAgcHJpdmF0ZSBwZXJmb3JtYW5jZU1vZGU6IFBlcmZvcm1hbmNlTW9kZSA9ICdiYWxhbmNlZCc7XG4gICAgcHJpdmF0ZSBlbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICBwcml2YXRlIHByZWZlck11bHRpbW9kYWwgPSBmYWxzZTtcbiAgICBwcml2YXRlIHBlcmZvcm1hbmNlTW9kZVNlbGVjdD86IEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHByaXZhdGUgcGFyYWxsZWxUb2dnbGU/OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgbXVsdGltb2RhbFRvZ2dsZT86IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAvLyBQZXJmb3JtYW5jZSBvcHRpbWl6YXRpb246IGRlYm91bmNlZCB2YWxpZGF0aW9uXG4gICAgcHJpdmF0ZSB2YWxpZGF0aW9uVGltZXI/OiBudW1iZXI7XG4gICAgcHJpdmF0ZSBsYXN0VmFsaWRVcmw/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBsYXN0VmFsaWRSZXN1bHQ/OiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIG9wdGlvbnM6IFlvdVR1YmVVcmxNb2RhbE9wdGlvbnNcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcblxuICAgICAgICB0aGlzLnVybCA9IG9wdGlvbnMuaW5pdGlhbFVybCB8fCAnJztcblxuICAgICAgICAvLyBJbml0aWFsaXplIHBlcmZvcm1hbmNlIHNldHRpbmdzIGZyb20gb3B0aW9uc1xuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZSA9IG9wdGlvbnMucGVyZm9ybWFuY2VNb2RlIHx8ICdiYWxhbmNlZCc7XG4gICAgICAgIHRoaXMuZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nID0gb3B0aW9ucy5lbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMucHJlZmVyTXVsdGltb2RhbCA9IG9wdGlvbnMucHJlZmVyTXVsdGltb2RhbCB8fCBmYWxzZTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlTW9kYWxDb250ZW50KCk7XG4gICAgICAgIHRoaXMuc2V0dXBFdmVudEhhbmRsZXJzKCk7XG4gICAgICAgIC8vIElmIGFuIGluaXRpYWwgVVJMIHdhcyBwcm92aWRlZCwgdmFsaWRhdGUgYW5kIGZvY3VzIHRoZSBhcHByb3ByaWF0ZSBjb250cm9sXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW5pdGlhbFVybCkge1xuICAgICAgICAgICAgLy8gUHJldmVudCBjeWNsZXMgLSBpZiB0aGUgVVJMIGlzIGFscmVhZHkgYmVpbmcgcHJvY2Vzc2VkLCBkb24ndCByZXByb2Nlc3NcbiAgICAgICAgICAgIGlmICh0aGlzLnVybC50cmltKCkgPT09IHRoaXMub3B0aW9ucy5pbml0aWFsVXJsLnRyaW0oKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVVcmxNb2RhbDogU2FtZSBVUkwgYWxyZWFkeSBzZXQsIHByZXZlbnRpbmcgY3ljbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcmwodGhpcy5vcHRpb25zLmluaXRpYWxVcmwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2Nlc3NCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCgodGhpcy5vcHRpb25zLmluaXRpYWxVcmwgfHwgJycpLnRyaW0oKSk7XG4gICAgICAgICAgICBpZiAoaXNWYWxpZCAmJiB0aGlzLnByb2Nlc3NCdXR0b24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mb2N1c1VybElucHV0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIG1vZGFsIGNvbnRlbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZU1vZGFsQ29udGVudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5oZWFkZXJFbCA9IHRoaXMuY3JlYXRlSGVhZGVyKE1FU1NBR0VTLk1PREFMUy5QUk9DRVNTX1ZJREVPKTtcbiAgICAgICAgdGhpcy5jcmVhdGVVcmxJbnB1dFNlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5jcmVhdGVQZXJmb3JtYW5jZVNlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3JtYXRTZWxlY3Rpb25TZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUHJvdmlkZXJTZWxlY3Rpb25TZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUHJvZ3Jlc3NTZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uQnV0dG9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBjb21wYWN0IHBlcmZvcm1hbmNlIGFuZCBzcGVlZCBzZXR0aW5ncyBzZWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVQZXJmb3JtYW5jZVNlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ3l0Yy1wZXJmb3JtYW5jZS1zZWN0aW9uJztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxMnB4JztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpJztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc2cHgnO1xuICAgICAgICBjb250YWluZXIuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcblxuICAgICAgICAvLyBDb21wYWN0IGhlYWRlclxuICAgICAgICBjb25zdCBoZWFkZXJDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBoZWFkZXJDb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICBoZWFkZXJDb250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnc3BhY2UtYmV0d2Vlbic7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMTBweCc7XG5cbiAgICAgICAgY29uc3Qgc2VjdGlvbkhlYWRlciA9IGhlYWRlckNvbnRhaW5lci5jcmVhdGVFbCgnaDMnKTtcbiAgICAgICAgc2VjdGlvbkhlYWRlci50ZXh0Q29udGVudCA9ICdcdTI2QTEgUGVyZm9ybWFuY2UnO1xuICAgICAgICBzZWN0aW9uSGVhZGVyLnN0eWxlLm1hcmdpbiA9ICcwJztcbiAgICAgICAgc2VjdGlvbkhlYWRlci5zdHlsZS5mb250U2l6ZSA9ICcwLjlyZW0nO1xuICAgICAgICBzZWN0aW9uSGVhZGVyLnN0eWxlLmZvbnRXZWlnaHQgPSAnNjAwJztcbiAgICAgICAgc2VjdGlvbkhlYWRlci5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICBzZWN0aW9uSGVhZGVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIHNlY3Rpb25IZWFkZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICBzZWN0aW9uSGVhZGVyLnN0eWxlLmdhcCA9ICc2cHgnO1xuXG4gICAgICAgIC8vIENvbXBhY3QgcGVyZm9ybWFuY2UgbW9kZSBzZWxlY3Rpb25cbiAgICAgICAgY29uc3QgbW9kZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbW9kZUNvbnRhaW5lci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnOHB4JztcblxuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdCA9IG1vZGVDb250YWluZXIuY3JlYXRlRWwoJ3NlbGVjdCcpO1xuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vZGVTZWxlY3Quc3R5bGUucGFkZGluZyA9ICc2cHggOHB4JztcbiAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vZGVTZWxlY3Quc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgIHRoaXMucGVyZm9ybWFuY2VNb2RlU2VsZWN0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vZGVTZWxlY3Quc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknO1xuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW5vcm1hbCknO1xuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC5zdHlsZS5mb250U2l6ZSA9ICcwLjg1cmVtJztcbiAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vZGVTZWxlY3Quc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuXG4gICAgICAgIC8vIENvbXBhY3Qgb3B0aW9uc1xuICAgICAgICBjb25zdCBmYXN0T3B0aW9uID0gdGhpcy5wZXJmb3JtYW5jZU1vZGVTZWxlY3QuY3JlYXRlRWwoJ29wdGlvbicpO1xuICAgICAgICBmYXN0T3B0aW9uLnZhbHVlID0gJ2Zhc3QnO1xuICAgICAgICBmYXN0T3B0aW9uLnRleHRDb250ZW50ID0gJ1x1MjZBMSBGYXN0ICgxMC0zMHMpJztcblxuICAgICAgICBjb25zdCBiYWxhbmNlZE9wdGlvbiA9IHRoaXMucGVyZm9ybWFuY2VNb2RlU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nKTtcbiAgICAgICAgYmFsYW5jZWRPcHRpb24udmFsdWUgPSAnYmFsYW5jZWQnO1xuICAgICAgICBiYWxhbmNlZE9wdGlvbi50ZXh0Q29udGVudCA9ICdcdTI2OTZcdUZFMEYgQmFsYW5jZWQgKDMwLTYwcyknO1xuXG4gICAgICAgIGNvbnN0IHF1YWxpdHlPcHRpb24gPSB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC5jcmVhdGVFbCgnb3B0aW9uJyk7XG4gICAgICAgIHF1YWxpdHlPcHRpb24udmFsdWUgPSAncXVhbGl0eSc7XG4gICAgICAgIHF1YWxpdHlPcHRpb24udGV4dENvbnRlbnQgPSAnXHVEODNDXHVERkFGIFF1YWxpdHkgKDYwLTEyMHMpJztcblxuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC52YWx1ZSA9IHRoaXMucGVyZm9ybWFuY2VNb2RlO1xuICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZSA9IHRoaXMucGVyZm9ybWFuY2VNb2RlU2VsZWN0IS52YWx1ZSBhcyBQZXJmb3JtYW5jZU1vZGU7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVBlcmZvcm1hbmNlU2V0dGluZ3NDaGFuZ2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29tcGFjdCB0b2dnbGVzXG4gICAgICAgIGNvbnN0IHRvZ2dsZXNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRvZ2dsZXNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgdG9nZ2xlc0NvbnRhaW5lci5zdHlsZS5nYXAgPSAnMTZweCc7XG4gICAgICAgIHRvZ2dsZXNDb250YWluZXIuc3R5bGUubWFyZ2luVG9wID0gJzZweCc7XG5cbiAgICAgICAgLy8gQ29tcGFjdCBwYXJhbGxlbCB0b2dnbGVcbiAgICAgICAgY29uc3QgcGFyYWxsZWxDb250YWluZXIgPSB0b2dnbGVzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBwYXJhbGxlbExhYmVsID0gcGFyYWxsZWxDb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJyk7XG4gICAgICAgIHBhcmFsbGVsTGFiZWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgcGFyYWxsZWxMYWJlbC5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIHBhcmFsbGVsTGFiZWwuc3R5bGUuZ2FwID0gJzRweCc7XG4gICAgICAgIHBhcmFsbGVsTGFiZWwuc3R5bGUuZm9udFNpemUgPSAnMC44cmVtJztcbiAgICAgICAgcGFyYWxsZWxMYWJlbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIHBhcmFsbGVsTGFiZWwuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1ub3JtYWwpJztcblxuICAgICAgICBjb25zdCBwYXJhbGxlbFRvZ2dsZSA9IHBhcmFsbGVsTGFiZWwuY3JlYXRlRWwoJ2lucHV0Jyk7XG4gICAgICAgIHBhcmFsbGVsVG9nZ2xlLnR5cGUgPSAnY2hlY2tib3gnO1xuICAgICAgICBwYXJhbGxlbFRvZ2dsZS5pZCA9ICdwYXJhbGxlbC10b2dnbGUnO1xuICAgICAgICBwYXJhbGxlbFRvZ2dsZS5jaGVja2VkID0gdGhpcy5lbmFibGVQYXJhbGxlbFByb2Nlc3Npbmc7XG4gICAgICAgIHBhcmFsbGVsVG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nID0gcGFyYWxsZWxUb2dnbGUuY2hlY2tlZDtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlUGVyZm9ybWFuY2VTZXR0aW5nc0NoYW5nZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBwYXJhbGxlbExhYmVsLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdcdUQ4M0RcdUREMDQgUGFyYWxsZWwnKSk7XG4gICAgICAgIHBhcmFsbGVsQ29udGFpbmVyLmFwcGVuZENoaWxkKHBhcmFsbGVsTGFiZWwpO1xuXG4gICAgICAgIC8vIENvbXBhY3QgbXVsdGltb2RhbCB0b2dnbGVcbiAgICAgICAgY29uc3QgbXVsdGltb2RhbENvbnRhaW5lciA9IHRvZ2dsZXNDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IG11bHRpbW9kYWxMYWJlbCA9IG11bHRpbW9kYWxDb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJyk7XG4gICAgICAgIG11bHRpbW9kYWxMYWJlbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBtdWx0aW1vZGFsTGFiZWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICBtdWx0aW1vZGFsTGFiZWwuc3R5bGUuZ2FwID0gJzRweCc7XG4gICAgICAgIG11bHRpbW9kYWxMYWJlbC5zdHlsZS5mb250U2l6ZSA9ICcwLjhyZW0nO1xuICAgICAgICBtdWx0aW1vZGFsTGFiZWwuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICBtdWx0aW1vZGFsTGFiZWwuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1ub3JtYWwpJztcblxuICAgICAgICBjb25zdCBtdWx0aW1vZGFsVG9nZ2xlID0gbXVsdGltb2RhbExhYmVsLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICBtdWx0aW1vZGFsVG9nZ2xlLnR5cGUgPSAnY2hlY2tib3gnO1xuICAgICAgICBtdWx0aW1vZGFsVG9nZ2xlLmlkID0gJ211bHRpbW9kYWwtdG9nZ2xlJztcbiAgICAgICAgbXVsdGltb2RhbFRvZ2dsZS5jaGVja2VkID0gdGhpcy5wcmVmZXJNdWx0aW1vZGFsO1xuICAgICAgICBtdWx0aW1vZGFsVG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJlZmVyTXVsdGltb2RhbCA9IG11bHRpbW9kYWxUb2dnbGUuY2hlY2tlZDtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlUGVyZm9ybWFuY2VTZXR0aW5nc0NoYW5nZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBtdWx0aW1vZGFsTGFiZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1x1RDgzQ1x1REZBNSBNdWx0aW1vZGFsJykpO1xuICAgICAgICBtdWx0aW1vZGFsQ29udGFpbmVyLmFwcGVuZENoaWxkKG11bHRpbW9kYWxMYWJlbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGVuaGFuY2VkIHBlcmZvcm1hbmNlIHRvZ2dsZSBjb21wb25lbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVBlcmZvcm1hbmNlVG9nZ2xlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlkOiBzdHJpbmcsIGljb246IHN0cmluZywgbGFiZWw6IHN0cmluZywgY2hlY2tlZDogYm9vbGVhbiwgb25DaGFuZ2U6IChjaGVja2VkOiBib29sZWFuKSA9PiB2b2lkLCBkZXNjcmlwdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdG9nZ2xlQ29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTJweCc7XG4gICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KSc7XG4gICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNnB4JztcbiAgICAgICAgdG9nZ2xlQ29udGFpbmVyLnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgdG9nZ2xlQ29udGFpbmVyLnN0eWxlLnRyYW5zaXRpb24gPSAnYWxsIDAuMnMgZWFzZSc7XG4gICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlSGVhZGVyID0gdG9nZ2xlQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0b2dnbGVIZWFkZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgdG9nZ2xlSGVhZGVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICAgICAgdG9nZ2xlSGVhZGVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xuICAgICAgICB0b2dnbGVIZWFkZXIuc3R5bGUubWFyZ2luQm90dG9tID0gJzRweCc7XG5cbiAgICAgICAgY29uc3QgbGFiZWxDb250YWluZXIgPSB0b2dnbGVIZWFkZXIuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBsYWJlbENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBsYWJlbENvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIGxhYmVsQ29udGFpbmVyLnN0eWxlLmdhcCA9ICc4cHgnO1xuXG4gICAgICAgIGNvbnN0IGljb25TcGFuID0gbGFiZWxDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nKTtcbiAgICAgICAgaWNvblNwYW4udGV4dENvbnRlbnQgPSBpY29uO1xuICAgICAgICBpY29uU3Bhbi5zdHlsZS5mb250U2l6ZSA9ICcxcmVtJztcblxuICAgICAgICBjb25zdCBsYWJlbFRleHQgPSBsYWJlbENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICBsYWJlbFRleHQudGV4dENvbnRlbnQgPSBsYWJlbDtcbiAgICAgICAgbGFiZWxUZXh0LnN0eWxlLmZvbnRXZWlnaHQgPSAnNTAwJztcbiAgICAgICAgbGFiZWxUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlID0gdG9nZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICB0b2dnbGUudHlwZSA9ICdjaGVja2JveCc7XG4gICAgICAgIHRvZ2dsZS5pZCA9IGlkO1xuICAgICAgICB0b2dnbGUuY2hlY2tlZCA9IGNoZWNrZWQ7XG4gICAgICAgIHRvZ2dsZS5zdHlsZS53aWR0aCA9ICcyMHB4JztcbiAgICAgICAgdG9nZ2xlLnN0eWxlLmhlaWdodCA9ICcyMHB4JztcbiAgICAgICAgdG9nZ2xlLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvblRleHQgPSB0b2dnbGVDb250YWluZXIuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBkZXNjcmlwdGlvblRleHQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgZGVzY3JpcHRpb25UZXh0LnN0eWxlLmZvbnRTaXplID0gJzAuOHJlbSc7XG4gICAgICAgIGRlc2NyaXB0aW9uVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgIGRlc2NyaXB0aW9uVGV4dC5zdHlsZS5tYXJnaW5Ub3AgPSAnNHB4JztcbiAgICAgICAgZGVzY3JpcHRpb25UZXh0LnN0eWxlLmxpbmVIZWlnaHQgPSAnMS4zJztcblxuICAgICAgICAvLyBBZGQgaG92ZXIgZWZmZWN0c1xuICAgICAgICB0b2dnbGVDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICAgICAgdG9nZ2xlQ29udGFpbmVyLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWludGVyYWN0aXZlLWFjY2VudCknO1xuICAgICAgICAgICAgdG9nZ2xlQ29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKC0ycHgpJztcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5ib3hTaGFkb3cgPSAnMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMSknO1xuICAgICAgICB9KTtcblxuICAgICAgICB0b2dnbGVDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KSc7XG4gICAgICAgICAgICB0b2dnbGVDb250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgwKSc7XG4gICAgICAgICAgICB0b2dnbGVDb250YWluZXIuc3R5bGUuYm94U2hhZG93ID0gJ25vbmUnO1xuICAgICAgICB9KTtcblxuICAgICAgICB0b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4gb25DaGFuZ2UodG9nZ2xlLmNoZWNrZWQpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgcGVyZm9ybWFuY2UgcHJldmlldyB3aXRoIG1vZGUgZGVzY3JpcHRpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRQZXJmb3JtYW5jZVByZXZpZXcoY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmV2aWV3Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBwcmV2aWV3Q29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxNnB4JztcbiAgICAgICAgcHJldmlld0NvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzEycHgnO1xuICAgICAgICBwcmV2aWV3Q29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgIHByZXZpZXdDb250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzZweCc7XG4gICAgICAgIHByZXZpZXdDb250YWluZXIuc3R5bGUuYm9yZGVyID0gJzFweCBkYXNoZWQgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG5cbiAgICAgICAgY29uc3QgcHJldmlld1RpdGxlID0gcHJldmlld0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIHByZXZpZXdUaXRsZS50ZXh0Q29udGVudCA9ICdcdUQ4M0RcdURDQ0IgQ3VycmVudCBDb25maWd1cmF0aW9uJztcbiAgICAgICAgcHJldmlld1RpdGxlLnN0eWxlLmZvbnRXZWlnaHQgPSAnNjAwJztcbiAgICAgICAgcHJldmlld1RpdGxlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc4cHgnO1xuICAgICAgICBwcmV2aWV3VGl0bGUuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1hY2NlbnQpJztcblxuICAgICAgICBjb25zdCBwcmV2aWV3VGV4dCA9IHByZXZpZXdDb250YWluZXIuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBwcmV2aWV3VGV4dC5jbGFzc05hbWUgPSAneXRjLXBlcmZvcm1hbmNlLXByZXZpZXcnO1xuICAgICAgICBwcmV2aWV3VGV4dC5zdHlsZS5mb250U2l6ZSA9ICcwLjg1cmVtJztcbiAgICAgICAgcHJldmlld1RleHQuc3R5bGUubGluZUhlaWdodCA9ICcxLjQnO1xuICAgICAgICBwcmV2aWV3VGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgIHRoaXMudXBkYXRlUGVyZm9ybWFuY2VQcmV2aWV3KHByZXZpZXdUZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgcGVyZm9ybWFuY2UgcHJldmlldyB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVQZXJmb3JtYW5jZVByZXZpZXcocHJldmlld0VsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGVUZXh0ID0gdGhpcy5wZXJmb3JtYW5jZU1vZGUgPT09ICdmYXN0JyA/ICdcdTI2QTEgRmFzdCBNb2RlJyA6XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZU1vZGUgPT09ICdiYWxhbmNlZCcgPyAnXHUyNjk2XHVGRTBGIEJhbGFuY2VkIE1vZGUnIDogJ1x1RDgzQ1x1REZBRiBRdWFsaXR5IE1vZGUnO1xuICAgICAgICBjb25zdCBwYXJhbGxlbFRleHQgPSB0aGlzLmVuYWJsZVBhcmFsbGVsUHJvY2Vzc2luZyA/ICdcdUQ4M0RcdUREMDQgRW5hYmxlZCcgOiAnXHUyM0Y4XHVGRTBGIERpc2FibGVkJztcbiAgICAgICAgY29uc3QgbXVsdGltb2RhbFRleHQgPSB0aGlzLnByZWZlck11bHRpbW9kYWwgPyAnXHVEODNDXHVERkE1IEVuYWJsZWQnIDogJ1x1RDgzRFx1RENDNCBUZXh0IE9ubHknO1xuXG4gICAgICAgIHByZXZpZXdFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxzdHJvbmc+TW9kZTo8L3N0cm9uZz4gJHttb2RlVGV4dH08YnI+XG4gICAgICAgICAgICA8c3Ryb25nPlBhcmFsbGVsIFByb2Nlc3Npbmc6PC9zdHJvbmc+ICR7cGFyYWxsZWxUZXh0fTxicj5cbiAgICAgICAgICAgIDxzdHJvbmc+TXVsdGltb2RhbCBBbmFseXNpczo8L3N0cm9uZz4gJHttdWx0aW1vZGFsVGV4dH1cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc3VidGxlIGFuaW1hdGlvbiB3aGVuIHBlcmZvcm1hbmNlIG1vZGUgY2hhbmdlc1xuICAgICAqL1xuICAgIHByaXZhdGUgYWRkUGVyZm9ybWFuY2VNb2RlQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmV2aWV3RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy55dGMtcGVyZm9ybWFuY2UtcHJldmlldycpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBpZiAocHJldmlld0VsZW1lbnQpIHtcbiAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnYWxsIDAuM3MgZWFzZSc7XG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMS4wMiknO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJztcbiAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgcGVyZm9ybWFuY2Ugc2V0dGluZ3MgY2hhbmdlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVQZXJmb3JtYW5jZVNldHRpbmdzQ2hhbmdlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLm9uUGVyZm9ybWFuY2VTZXR0aW5nc0NoYW5nZSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcHRpb25zLm9uUGVyZm9ybWFuY2VTZXR0aW5nc0NoYW5nZShcbiAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1hbmNlTW9kZSxcbiAgICAgICAgICAgICAgICB0aGlzLmVuYWJsZVBhcmFsbGVsUHJvY2Vzc2luZyxcbiAgICAgICAgICAgICAgICB0aGlzLnByZWZlck11bHRpbW9kYWxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByb3ZpZGVyU2VsZWN0aW9uU2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gY29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogJ0FJIFByb3ZpZGVyICYgTW9kZWw6JyB9KTtcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAneXRjLXByb3ZpZGVyLXNlbGVjdCcpO1xuXG4gICAgICAgIGNvbnN0IHJvdyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIHJvdy5zdHlsZS5nYXAgPSAnOHB4JztcbiAgICAgICAgcm93LnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcblxuICAgICAgICAvLyBQcm92aWRlciBzZWxlY3Qgd2l0aCBhY2Nlc3NpYmlsaXR5XG4gICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5pZCA9ICd5dGMtcHJvdmlkZXItc2VsZWN0JztcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQUkgUHJvdmlkZXInKTtcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5zdHlsZS5mbGV4ID0gJzEnO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnN0eWxlLnBhZGRpbmcgPSAnNnB4JztcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNnB4JztcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZCh0aGlzLnByb3ZpZGVyU2VsZWN0KTtcblxuICAgICAgICAvLyBNb2RlbCBzZWxlY3Qgd2l0aCBhY2Nlc3NpYmlsaXR5XG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5pZCA9ICd5dGMtbW9kZWwtc2VsZWN0JztcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQUkgTW9kZWwnKTtcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5zdHlsZS53aWR0aCA9ICcyMjBweCc7XG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3Quc3R5bGUucGFkZGluZyA9ICc2cHgnO1xuICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LnN0eWxlLmJvcmRlclJhZGl1cyA9ICc2cHgnO1xuICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKHRoaXMubW9kZWxTZWxlY3QpO1xuXG4gICAgICAgIC8vIFBvcHVsYXRlIHByb3ZpZGVycyBpZiBwcm92aWRlZCB2aWEgb3B0aW9uc1xuICAgICAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLm9wdGlvbnMucHJvdmlkZXJzIHx8IFtdO1xuICAgICAgICBjb25zdCBtb2RlbE9wdGlvbnMgPSB0aGlzLm9wdGlvbnMubW9kZWxPcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIC8vIEFkZCBhbiBleHBsaWNpdCAnQXV0byAoZmFsbGJhY2sgb3JkZXIpJyBvcHRpb25cbiAgICAgICAgY29uc3QgYXV0b09wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBhdXRvT3B0LnZhbHVlID0gJyc7XG4gICAgICAgIGF1dG9PcHQudGV4dCA9ICdBdXRvIChmYWxsYmFjayknO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LmFwcGVuZENoaWxkKGF1dG9PcHQpO1xuXG4gICAgICAgIHByb3ZpZGVycy5mb3JFYWNoKChwKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgICAgIG9wdC52YWx1ZSA9IHA7XG4gICAgICAgICAgICBvcHQudGV4dCA9IHA7XG4gICAgICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0IS5hcHBlbmRDaGlsZChvcHQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZWZyZXNoIG1vZGVscyBidXR0b25cbiAgICAgICAgY29uc3QgcmVmcmVzaEJ0biA9IHRoaXMuY3JlYXRlSW5saW5lQnV0dG9uKHJvdywgJ1JlZnJlc2ggbW9kZWxzJywgKCkgPT4ge1xuICAgICAgICAgICAgdm9pZCB0aGlzLmhhbmRsZVJlZnJlc2hNb2RlbHMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5saW5lIHNwaW5uZXIgbmV4dCB0byByZWZyZXNoIGJ1dHRvblxuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUubWFyZ2luTGVmdCA9ICc4cHgnO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLndpZHRoID0gJzE2cHgnO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmhlaWdodCA9ICcxNnB4JztcbiAgICAgICAgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5ib3JkZXIgPSAnMnB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUuYm9yZGVyVG9wID0gJzJweCBzb2xpZCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNTAlJztcbiAgICAgICAgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5hbmltYXRpb24gPSAneXRwLXNwaW4gMXMgbGluZWFyIGluZmluaXRlJztcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKHRoaXMucmVmcmVzaFNwaW5uZXIpO1xuXG4gICAgICAgIC8vIFdpcmUgY2hhbmdlIGhhbmRsZXJcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkUHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVyU2VsZWN0IS52YWx1ZSB8fCB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnBvcHVsYXRlTW9kZWxzRm9yUHJvdmlkZXIodGhpcy5zZWxlY3RlZFByb3ZpZGVyIHx8ICcnLCBtb2RlbE9wdGlvbnMsIHRoaXMub3B0aW9ucy5kZWZhdWx0TW9kZWwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTZXQgZGVmYXVsdHNcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kZWZhdWx0UHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QudmFsdWUgPSB0aGlzLm9wdGlvbnMuZGVmYXVsdFByb3ZpZGVyO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFByb3ZpZGVyID0gdGhpcy5vcHRpb25zLmRlZmF1bHRQcm92aWRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBvcHVsYXRlIG1vZGVscyBmb3IgaW5pdGlhbCBwcm92aWRlciBzZWxlY3Rpb24gKG9yIGVtcHR5KVxuICAgICAgICB0aGlzLnBvcHVsYXRlTW9kZWxzRm9yUHJvdmlkZXIodGhpcy5zZWxlY3RlZFByb3ZpZGVyIHx8ICcnLCBtb2RlbE9wdGlvbnMsIHRoaXMub3B0aW9ucy5kZWZhdWx0TW9kZWwpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlUmVmcmVzaE1vZGVscygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmV0Y2hNb2RlbHMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ01vZGVsIHJlZnJlc2ggbm90IGF2YWlsYWJsZS4nLCAnZXJyb3InKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ1JlZnJlc2hpbmcgbW9kZWwgbGlzdHNcdTIwMjYnLCAnaW5mbycpO1xuICAgICAgICAvLyBzaG93IHNwaW5uZXJcbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaFNwaW5uZXIpIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgICAvLyBkaXNhYmxlIHJlZnJlc2ggdG8gYXZvaWQgZG91YmxlIGNsaWNrc1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbWFwID0gYXdhaXQgdGhpcy5vcHRpb25zLmZldGNoTW9kZWxzKCk7XG4gICAgICAgICAgICAvLyB1cGRhdGUgcHJvdmlkZXIgbGlzdCBpZiBjaGFuZ2VkXG4gICAgICAgICAgICBjb25zdCBwcm92aWRlcnMgPSBPYmplY3Qua2V5cyhtYXApO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvdmlkZXJTZWxlY3QpIHtcbiAgICAgICAgICAgICAgICAvLyBwcmVzZXJ2ZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnByb3ZpZGVyU2VsZWN0LnZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgY29uc3QgYXV0b09wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICAgICAgICAgIGF1dG9PcHQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICBhdXRvT3B0LnRleHQgPSAnQXV0byAoZmFsbGJhY2spJztcbiAgICAgICAgICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LmFwcGVuZENoaWxkKGF1dG9PcHQpO1xuICAgICAgICAgICAgICAgIHByb3ZpZGVycy5mb3JFYWNoKHAgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgb3B0LnZhbHVlID0gcDtcbiAgICAgICAgICAgICAgICAgICAgb3B0LnRleHQgPSBwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0IS5hcHBlbmRDaGlsZChvcHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ICYmIEFycmF5LmZyb20odGhpcy5wcm92aWRlclNlbGVjdC5vcHRpb25zKS5zb21lKG8gPT4gby52YWx1ZSA9PT0gY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC52YWx1ZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQcm92aWRlciA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB1cGRhdGUgbW9kZWxPcHRpb25zIGFuZCByZXBvcHVsYXRlIGZvciBzZWxlY3RlZCBwcm92aWRlclxuICAgICAgICAgICAgY29uc3QgbW9kZWxPcHRpb25zID0gbWFwO1xuICAgICAgICAgICAgdGhpcy5wb3B1bGF0ZU1vZGVsc0ZvclByb3ZpZGVyKHRoaXMuc2VsZWN0ZWRQcm92aWRlciB8fCAnJywgbW9kZWxPcHRpb25zLCB0aGlzLm9wdGlvbnMuZGVmYXVsdE1vZGVsKTtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ01vZGVsIGxpc3RzIHJlZnJlc2hlZC4nLCAnc3VjY2VzcycpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnRmFpbGVkIHRvIHJlZnJlc2ggbW9kZWxzLiBVc2luZyBjYWNoZWQgb3B0aW9ucy4nLCAnZXJyb3InKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlZnJlc2hTcGlubmVyKSB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHBvcHVsYXRlTW9kZWxzRm9yUHJvdmlkZXIocHJvdmlkZXJOYW1lOiBzdHJpbmcsIG1vZGVsT3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+LCBkZWZhdWx0TW9kZWw/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLm1vZGVsU2VsZWN0KSByZXR1cm47XG4gICAgICAgIC8vIENsZWFyIGV4aXN0aW5nXG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3QuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAgICAgY29uc3QgbW9kZWxzID0gbW9kZWxPcHRpb25zW3Byb3ZpZGVyTmFtZV0gfHwgW107XG4gICAgICAgIGlmIChtb2RlbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBBZGQgYSBzaW5nbGUgb3B0aW9uIGluZGljYXRpbmcgcHJvdmlkZXIgZGVmYXVsdFxuICAgICAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICBvcHQudmFsdWUgPSAnJztcbiAgICAgICAgICAgIG9wdC50ZXh0ID0gJ0RlZmF1bHQgbW9kZWwnO1xuICAgICAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5hcHBlbmRDaGlsZChvcHQpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsID0gJyc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBtb2RlbHMuZm9yRWFjaCgobSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICBvcHQudmFsdWUgPSBtO1xuICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBtZXRhZGF0YSBpbiBQUk9WSURFUl9NT0RFTF9PUFRJT05TLCBzaG93IGEgc21hbGwgYmFkZ2VcbiAgICAgICAgICAgIGxldCBsYWJlbCA9IG07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVyTW9kZWxzID0gUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdIHx8IFtdIGFzIGFueVtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gcHJvdmlkZXJNb2RlbHMuZmluZChwbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0eXBlb2YgcG0gPT09ICdzdHJpbmcnID8gcG0gOiAocG0gJiYgcG0ubmFtZSA/IHBtLm5hbWUgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcobmFtZSkudG9Mb3dlckNhc2UoKSA9PT0gU3RyaW5nKG0pLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgfSkgYXMgYW55IHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaC5zdXBwb3J0c0F1ZGlvVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSBgJHttfSAgXHVEODNDXHVERkE1YDsgLy8gc21hbGwgY2FtZXJhIGVtb2ppIGluZGljYXRlcyBtdWx0aW1vZGFsLWNhcGFibGVcbiAgICAgICAgICAgICAgICAgICAgb3B0LnRpdGxlID0gJ1N1cHBvcnRzIG11bHRpbW9kYWwgYXVkaW8vdmlkZW8gdG9rZW5zJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgYW5kIGZhbGwgYmFjayB0byBwbGFpbiBsYWJlbFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3B0LnRleHQgPSBsYWJlbDtcbiAgICAgICAgICAgIHRoaXMubW9kZWxTZWxlY3QhLmFwcGVuZENoaWxkKG9wdCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChkZWZhdWx0TW9kZWwgJiYgbW9kZWxzLmluY2x1ZGVzKGRlZmF1bHRNb2RlbCkpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWxTZWxlY3QudmFsdWUgPSBkZWZhdWx0TW9kZWw7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSBkZWZhdWx0TW9kZWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LnNlbGVjdGVkSW5kZXggPSAwO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsID0gdGhpcy5tb2RlbFNlbGVjdC52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsID0gdGhpcy5tb2RlbFNlbGVjdCEudmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBVUkwgaW5wdXQgc2VjdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlVXJsSW5wdXRTZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgbGFiZWwgPSBjb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiAnWW91VHViZSBVUkw6JyB9KTtcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAneXRjLXVybC1pbnB1dCcpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaW5wdXRSb3cgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGlucHV0Um93LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIGlucHV0Um93LnN0eWxlLmdhcCA9ICc4cHgnO1xuICAgICAgICBpbnB1dFJvdy5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnVybElucHV0ID0gdGhpcy5jcmVhdGVJbnB1dChcbiAgICAgICAgICAgIGlucHV0Um93LFxuICAgICAgICAgICAgJ3VybCcsXG4gICAgICAgICAgICBNRVNTQUdFUy5QTEFDRUhPTERFUlMuWU9VVFVCRV9VUkwgKyAnIChQcmVzcyBFbnRlciB0byBwcm9jZXNzKSdcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy51cmxJbnB1dC5pZCA9ICd5dGMtdXJsLWlucHV0JztcbiAgICAgICAgdGhpcy51cmxJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnWW91VHViZSBVUkwnKTtcbiAgICAgICAgdGhpcy51cmxJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknLCAneXRjLXVybC1oaW50Jyk7XG4gICAgICAgIHRoaXMudXJsSW5wdXQuc3R5bGUuZmxleCA9ICcxJztcbiAgICAgICAgdGhpcy51cmxJbnB1dC5zdHlsZS50cmFuc2l0aW9uID0gJ2JvcmRlci1jb2xvciAwLjJzIGVhc2UsIGJveC1zaGFkb3cgMC4ycyBlYXNlJztcbiAgICAgICAgXG4gICAgICAgIHRoaXMucGFzdGVCdXR0b24gPSB0aGlzLmNyZWF0ZUlubGluZUJ1dHRvbihpbnB1dFJvdywgJ1Bhc3RlJywgKCkgPT4ge1xuICAgICAgICAgICAgdm9pZCB0aGlzLmhhbmRsZVBhc3RlRnJvbUNsaXBib2FyZCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wYXN0ZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUGFzdGUgWW91VHViZSBVUkwgZnJvbSBjbGlwYm9hcmQnKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuY2xlYXJCdXR0b24gPSB0aGlzLmNyZWF0ZUlubGluZUJ1dHRvbihpbnB1dFJvdywgJ0NsZWFyJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDbGVhclVybCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jbGVhckJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQ2xlYXIgWW91VHViZSBVUkwgaW5wdXQnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCBpbml0aWFsIHZhbHVlIGlmIHByb3ZpZGVkXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW5pdGlhbFVybCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC52YWx1ZSA9IHRoaXMub3B0aW9ucy5pbml0aWFsVXJsO1xuICAgICAgICAgICAgdGhpcy51cmwgPSB0aGlzLm9wdGlvbnMuaW5pdGlhbFVybDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwZGF0ZSBVUkwgc3RhdGUgb24gaW5wdXRcbiAgICAgICAgdGhpcy51cmxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVybCA9IChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUHJvY2Vzc0J1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudmFsaWRhdGlvbk1lc3NhZ2UgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMudmFsaWRhdGlvbk1lc3NhZ2UuaWQgPSAneXRjLXVybC1oaW50JztcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5zdHlsZS5tYXJnaW5Ub3AgPSAnNnB4JztcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5zdHlsZS5mb250U2l6ZSA9ICcwLjg1cmVtJztcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgIHRoaXMudmFsaWRhdGlvbk1lc3NhZ2Uuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3N0YXR1cycpO1xuICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdQYXN0ZSBhIFlvdVR1YmUgbGluayB0byBiZWdpbiBwcm9jZXNzaW5nLicsICdpbmZvJyk7XG5cbiAgICAvLyBQcmV2aWV3IGNvbnRhaW5lciAodGh1bWJuYWlsICsgbWV0YWRhdGEpXG4gICAgY29uc3QgcHJldmlldyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICBwcmV2aWV3LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgcHJldmlldy5zdHlsZS5nYXAgPSAnOHB4JztcbiAgICBwcmV2aWV3LnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICBwcmV2aWV3LnN0eWxlLm1hcmdpblRvcCA9ICc2cHgnO1xuXG4gICAgdGhpcy50aHVtYm5haWxFbCA9IHByZXZpZXcuY3JlYXRlRWwoJ2ltZycpO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1ZpZGVvIHRodW1ibmFpbCcpO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUud2lkdGggPSAnOTBweCc7XG4gICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5oZWlnaHQgPSAnNTBweCc7XG4gICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5vYmplY3RGaXQgPSAnY292ZXInO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lciA9IHByZXZpZXcuY3JlYXRlRGl2KCk7XG4gICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnVmlkZW8gbWV0YWRhdGEnKTtcbiAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5zdHlsZS5mb250U2l6ZSA9ICcwLjlyZW0nO1xuICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1ub3JtYWwpJztcbiAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3l0LXByZXZpZXctdGl0bGUnIH0pO1xuICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAneXQtcHJldmlldy1jaGFubmVsJyB9KTtcblxuICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBjb21wYWN0IGZvcm1hdCBzZWxlY3Rpb24gc2VjdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlRm9ybWF0U2VsZWN0aW9uU2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAneXRjLWZvcm1hdC1zZWN0aW9uJztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxMnB4JztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnOHB4JztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSknO1xuICAgICAgICBjb250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzZweCc7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG5cbiAgICAgICAgY29uc3QgbGFiZWwgPSBjb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiAnXHVEODNEXHVEQ0REIEZvcm1hdCcgfSk7XG4gICAgICAgIGxhYmVsLmlkID0gJ2Zvcm1hdC1ncm91cC1sYWJlbCc7XG4gICAgICAgIGxhYmVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICBsYWJlbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnOHB4JztcbiAgICAgICAgbGFiZWwuc3R5bGUuZm9udFNpemUgPSAnMC45cmVtJztcbiAgICAgICAgbGFiZWwuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnO1xuICAgICAgICBsYWJlbC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW5vcm1hbCknO1xuXG4gICAgICAgIGNvbnN0IHJhZGlvQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZ3JvdXAnKTtcbiAgICAgICAgcmFkaW9Db250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCAnZm9ybWF0LWdyb3VwLWxhYmVsJyk7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZ3JpZCc7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAncmVwZWF0KDQsIDFmciknO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5nYXAgPSAnOHB4JztcbiAgICAgICAgXG4gICAgICAgIC8vIENvbXBhY3QgcmFkaW8gYnV0dG9uIGNyZWF0aW9uXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNvbXBhY3RGb3JtYXRSYWRpbyhyYWRpb0NvbnRhaW5lciwgJ2V4ZWN1dGl2ZS1yYWRpbycsICdleGVjdXRpdmUtc3VtbWFyeScsICdFeGVjdXRpdmUnLCAnJywgdGhpcy5mb3JtYXQgPT09ICdleGVjdXRpdmUtc3VtbWFyeScpO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVDb21wYWN0Rm9ybWF0UmFkaW8ocmFkaW9Db250YWluZXIsICd0dXRvcmlhbC1yYWRpbycsICdkZXRhaWxlZC1ndWlkZScsICdUdXRvcmlhbCcsICcnLCB0aGlzLmZvcm1hdCA9PT0gJ2RldGFpbGVkLWd1aWRlJyk7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNvbXBhY3RGb3JtYXRSYWRpbyhyYWRpb0NvbnRhaW5lciwgJ2JyaWVmLXJhZGlvJywgJ2JyaWVmJywgJ0JyaWVmJywgJycsIHRoaXMuZm9ybWF0ID09PSAnYnJpZWYnKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQ29tcGFjdEZvcm1hdFJhZGlvKHJhZGlvQ29udGFpbmVyLCAnY3VzdG9tLXJhZGlvJywgJ2N1c3RvbScsICdDdXN0b20nLCAnJywgdGhpcy5mb3JtYXQgPT09ICdjdXN0b20nKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvbXBhY3QgZm9ybWF0IHJhZGlvIGJ1dHRvbnM6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gb2xkIG1ldGhvZCBpZiBjb21wYWN0IG1ldGhvZCBmYWlsc1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3JtYXRSYWRpbyhyYWRpb0NvbnRhaW5lciwgJ2V4ZWN1dGl2ZS1yYWRpbycsICdleGVjdXRpdmUtc3VtbWFyeScsICdFeGVjdXRpdmUnLCAnUXVpY2sgaW5zaWdodHMgd2l0aCBhY3Rpb24gaXRlbXMnLCB0aGlzLmZvcm1hdCA9PT0gJ2V4ZWN1dGl2ZS1zdW1tYXJ5Jyk7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUZvcm1hdFJhZGlvKHJhZGlvQ29udGFpbmVyLCAndHV0b3JpYWwtcmFkaW8nLCAnZGV0YWlsZWQtZ3VpZGUnLCAnVHV0b3JpYWwnLCAnXHVEODNEXHVEQ0RBIFN0ZXAtYnktc3RlcCB3YWxrdGhyb3VnaCcsIHRoaXMuZm9ybWF0ID09PSAnZGV0YWlsZWQtZ3VpZGUnKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlRm9ybWF0UmFkaW8ocmFkaW9Db250YWluZXIsICdicmllZi1yYWRpbycsICdicmllZicsICdCcmllZicsICdcdUQ4M0RcdURDQ0IgS2V5IHBvaW50cyBhbmQgdGFrZWF3YXlzJywgdGhpcy5mb3JtYXQgPT09ICdicmllZicpO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3JtYXRSYWRpbyhyYWRpb0NvbnRhaW5lciwgJ2N1c3RvbS1yYWRpbycsICdjdXN0b20nLCAnQ3VzdG9tJywgJ1x1MjcwRlx1RkUwRiBZb3VyIGN1c3RvbSBhbmFseXNpcycsIHRoaXMuZm9ybWF0ID09PSAnY3VzdG9tJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDcmVhdGUgY3VzdG9tIHByb21wdCB0ZXh0YXJlYSBjb250YWluZXIgKGluaXRpYWxseSBoaWRkZW4pXG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSAnMTJweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTJweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc0cHgnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY3VzdG9tUHJvbXB0TGFiZWwgPSB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnLCB7XG4gICAgICAgICAgICB0ZXh0OiAnQ3VzdG9tIFByb21wdCAodGhpcyBzZXNzaW9uIG9ubHkpOidcbiAgICAgICAgfSk7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2N1c3RvbS1wcm9tcHQtaW5wdXQnKTtcbiAgICAgICAgY3VzdG9tUHJvbXB0TGFiZWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc2cHgnO1xuICAgICAgICBjdXN0b21Qcm9tcHRMYWJlbC5zdHlsZS5mb250V2VpZ2h0ID0gJzYwMCc7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnN0eWxlLmZvbnRTaXplID0gJzAuOTVyZW0nO1xuXG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQgPSB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5jcmVhdGVFbCgndGV4dGFyZWEnKTtcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5pZCA9ICdjdXN0b20tcHJvbXB0LWlucHV0JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQ3VzdG9tIEFJIHByb21wdCcpO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnRW50ZXIgeW91ciBjdXN0b20gcHJvbXB0IGhlcmUuIEF2YWlsYWJsZSBwbGFjZWhvbGRlcnM6IF9fVklERU9fVElUTEVfXywgX19WSURFT19ERVNDUklQVElPTl9fLCBfX1ZJREVPX1VSTF9fJyk7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUuaGVpZ2h0ID0gJzEwMHB4JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5wYWRkaW5nID0gJzhweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUuZm9udEZhbWlseSA9ICdtb25vc3BhY2UnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLmZvbnRTaXplID0gJzEycHgnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5yZXNpemUgPSAndmVydGljYWwnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc2cHgnO1xuXG4gICAgICAgIGNvbnN0IGhlbHBUZXh0ID0gdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuY3JlYXRlRWwoJ3NtYWxsJyk7XG4gICAgICAgIGhlbHBUZXh0LnRleHRDb250ZW50ID0gJ1BsYWNlaG9sZGVyczogX19WSURFT19USVRMRV9fLCBfX1ZJREVPX0RFU0NSSVBUSU9OX18sIF9fVklERU9fVVJMX18sIF9fVklERU9fSURfXywgX19FTUJFRF9VUkxfXywgX19EQVRFX18sIF9fVElNRVNUQU1QX18nO1xuICAgICAgICBoZWxwVGV4dC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgaGVscFRleHQuc3R5bGUubWFyZ2luVG9wID0gJzRweCc7XG4gICAgICAgIGhlbHBUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgaGVscFRleHQuc3R5bGUuZm9udFNpemUgPSAnMTFweCc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGVuaGFuY2VkIGZvcm1hdCByYWRpbyBidXR0b25cbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUZvcm1hdFJhZGlvKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGlkOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGlzQ2hlY2tlZDogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCByYWRpb0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUucGFkZGluZyA9ICcxMnB4JztcbiAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyID0gJzJweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnOHB4JztcbiAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLnRyYW5zaXRpb24gPSAnYWxsIDAuMnMgZWFzZSc7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuXG4gICAgICAgIGNvbnN0IHJhZGlvID0gcmFkaW9Db250YWluZXIuY3JlYXRlRWwoJ2lucHV0Jyk7XG4gICAgICAgIHJhZGlvLnR5cGUgPSAncmFkaW8nO1xuICAgICAgICByYWRpby5uYW1lID0gJ291dHB1dEZvcm1hdCc7XG4gICAgICAgIHJhZGlvLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHJhZGlvLmlkID0gaWQ7XG4gICAgICAgIHJhZGlvLmNoZWNrZWQgPSBpc0NoZWNrZWQ7XG4gICAgICAgIHJhZGlvLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc4cHgnO1xuXG4gICAgICAgIGNvbnN0IGljb24gPSByYWRpb0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIGljb24uc3R5bGUuZm9udFNpemUgPSAnMS41cmVtJztcbiAgICAgICAgaWNvbi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JztcblxuICAgICAgICAvLyBTZXQgaWNvbiBiYXNlZCBvbiBmb3JtYXQgdHlwZVxuICAgICAgICBpZiAodmFsdWUgPT09ICdleGVjdXRpdmUtc3VtbWFyeScpIHtcbiAgICAgICAgICAgIGljb24udGV4dENvbnRlbnQgPSAnXHVEODNDXHVERkFGJztcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gJ2RldGFpbGVkLWd1aWRlJykge1xuICAgICAgICAgICAgaWNvbi50ZXh0Q29udGVudCA9ICdcdUQ4M0RcdURDREEnO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAnYnJpZWYnKSB7XG4gICAgICAgICAgICBpY29uLnRleHRDb250ZW50ID0gJ1x1RDgzRFx1RENDQic7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09ICdjdXN0b20nKSB7XG4gICAgICAgICAgICBpY29uLnRleHRDb250ZW50ID0gJ1x1MjcwRlx1RkUwRic7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSByYWRpb0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIHRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRpdGxlO1xuICAgICAgICB0aXRsZUVsZW1lbnQuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnO1xuICAgICAgICB0aXRsZUVsZW1lbnQuc3R5bGUuZm9udFNpemUgPSAnMC45cmVtJztcbiAgICAgICAgdGl0bGVFbGVtZW50LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcycHgnO1xuXG4gICAgICAgIGNvbnN0IGRlc2NFbGVtZW50ID0gcmFkaW9Db250YWluZXIuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBkZXNjRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICAgICAgICBkZXNjRWxlbWVudC5zdHlsZS5mb250U2l6ZSA9ICcwLjc1cmVtJztcbiAgICAgICAgZGVzY0VsZW1lbnQuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1tdXRlZCknO1xuXG4gICAgICAgIC8vIEFkZCBob3ZlciBhbmQgc2VsZWN0aW9uIGVmZmVjdHNcbiAgICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG4gICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LWhvdmVyKSc7XG4gICAgICAgIH1cblxuICAgICAgICByYWRpb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG4gICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtMnB4KSc7XG4gICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5ib3hTaGFkb3cgPSAnMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMSknO1xuICAgICAgICB9KTtcblxuICAgICAgICByYWRpb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFyYWRpby5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgwKSc7XG4gICAgICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm94U2hhZG93ID0gJ25vbmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByYWRpby5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSB2YWx1ZSBhcyBPdXRwdXRGb3JtYXQ7XG5cbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgYWxsIHJhZGlvIGNvbnRhaW5lcnNcbiAgICAgICAgICAgICAgICBjb25zdCBhbGxDb250YWluZXJzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGFsbENvbnRhaW5lcnMuZm9yRWFjaCgoY29udGFpbmVyRWw6IEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGl2RWwgPSBjb250YWluZXJFbCBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZGl2RWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgICAgICAgICAgICAgZGl2RWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtcHJpbWFyeSknO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG4gICAgICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWludGVyYWN0aXZlLWFjY2VudC1ob3ZlciknO1xuXG4gICAgICAgICAgICAgICAgLy8gSGFuZGxlIGN1c3RvbSBwcm9tcHQgdmlzaWJpbGl0eVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICdjdXN0b20nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQ/LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDbGljayBjb250YWluZXIgdG8gc2VsZWN0IHJhZGlvXG4gICAgICAgIHJhZGlvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgcmFkaW8uY2hlY2tlZCA9IHRydWU7XG4gICAgICAgICAgICByYWRpby5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgY29tcGFjdCBmb3JtYXQgcmFkaW8gYnV0dG9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVDb21wYWN0Rm9ybWF0UmFkaW8oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaWQ6IHN0cmluZywgdmFsdWU6IHN0cmluZywgdGl0bGU6IHN0cmluZywgaWNvbjogc3RyaW5nLCBpc0NoZWNrZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFkaW9Db250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnOHB4IDRweCc7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcbiAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS50cmFuc2l0aW9uID0gJ2FsbCAwLjJzIGVhc2UnO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcblxuICAgICAgICBjb25zdCByYWRpbyA9IHJhZGlvQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICByYWRpby50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgcmFkaW8ubmFtZSA9ICdvdXRwdXRGb3JtYXQnO1xuICAgICAgICByYWRpby52YWx1ZSA9IHZhbHVlO1xuICAgICAgICByYWRpby5pZCA9IGlkO1xuICAgICAgICByYWRpby5jaGVja2VkID0gaXNDaGVja2VkO1xuICAgICAgICByYWRpby5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JztcblxuICAgICAgICAvLyBPbmx5IHNob3cgaWNvbiBpZiBpdCBleGlzdHNcbiAgICAgICAgaWYgKGljb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGljb25FbCA9IHJhZGlvQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgICAgIGljb25FbC50ZXh0Q29udGVudCA9IGljb247XG4gICAgICAgICAgICBpY29uRWwuc3R5bGUuZm9udFNpemUgPSAnMS4ycmVtJztcbiAgICAgICAgICAgIGljb25FbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMnB4JztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IHJhZGlvQ29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgdGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIHRpdGxlRWxlbWVudC5zdHlsZS5mb250V2VpZ2h0ID0gJzUwMCc7XG4gICAgICAgIHRpdGxlRWxlbWVudC5zdHlsZS5mb250U2l6ZSA9ICcwLjhyZW0nO1xuXG4gICAgICAgIC8vIEFkZCBob3ZlciBhbmQgc2VsZWN0aW9uIGVmZmVjdHNcbiAgICAgICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG4gICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LWhvdmVyKSc7XG4gICAgICAgIH1cblxuICAgICAgICByYWRpb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgcmFkaW9Db250YWluZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAndmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSc7XG4gICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtMXB4KSc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJhZGlvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXJhZGlvLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5ib3JkZXJDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuICAgICAgICAgICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKDApJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmICgoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkuY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0ID0gdmFsdWUgYXMgT3V0cHV0Rm9ybWF0O1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGFsbCByYWRpbyBjb250YWluZXJzXG4gICAgICAgICAgICAgICAgY29uc3QgYWxsQ29udGFpbmVycyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdkaXYnKTtcbiAgICAgICAgICAgICAgICBhbGxDb250YWluZXJzLmZvckVhY2goKGNvbnRhaW5lckVsOiBFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpdkVsID0gY29udGFpbmVyRWwgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGRpdkVsLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgICAgICAgICAgICAgIGRpdkVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmJvcmRlckNvbG9yID0gJ3ZhcigtLWludGVyYWN0aXZlLWFjY2VudCknO1xuICAgICAgICAgICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtaG92ZXIpJztcblxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBjdXN0b20gcHJvbXB0IHZpc2liaWxpdHlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnY3VzdG9tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0Py5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2xpY2sgY29udGFpbmVyIHRvIHNlbGVjdCByYWRpb1xuICAgICAgICByYWRpb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHJhZGlvLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmFkaW8uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2NoYW5nZScpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgXG4gICAgXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHByb2dyZXNzIHNlY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVByb2dyZXNzU2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW4gdXAgZXhpc3RpbmcgcHJvZ3Jlc3MgY29udGFpbmVyIGlmIGl0IGV4aXN0c1xuICAgICAgICBpZiAodGhpcy5wcm9ncmVzc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NTdGVwcyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgncm9sZScsICdyZWdpb24nKTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUHJvY2Vzc2luZyBwcm9ncmVzcycpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxNnB4JztcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgLy8gUHJvZ3Jlc3MgdGV4dFxuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dCA9IHRoaXMucHJvZ3Jlc3NDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NUZXh0LmlkID0gJ3Byb2dyZXNzLXRleHQnO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnOHB4JztcbiAgICAgICAgdGhpcy5wcm9ncmVzc1RleHQuc3R5bGUuZm9udFdlaWdodCA9ICc1MDAnO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9ICdQcm9jZXNzaW5nIHZpZGVvLi4uJztcbiAgICAgICAgXG4gICAgICAgIC8vIFByb2dyZXNzIGJhciBjb250YWluZXJcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJDb250YWluZXIgPSB0aGlzLnByb2dyZXNzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAncHJvZ3Jlc3NiYXInKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgJzAnKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJywgJzAnKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JywgJzEwMCcpO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICdwcm9ncmVzcy10ZXh0Jyk7XG4gICAgICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnNnB4JztcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICczcHgnO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgICBcbiAgICAgICAgLy8gUHJvZ3Jlc3MgYmFyXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIgPSBwcm9ncmVzc0JhckNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLXRleHQtYWNjZW50KSc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzNweCc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnO1xuICAgICAgICB0aGlzLnByb2dyZXNzQmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC4zcyBlYXNlJztcblxuICAgICAgICBjb25zdCBzdGVwTGlzdCA9IHRoaXMucHJvZ3Jlc3NDb250YWluZXIuY3JlYXRlRWwoJ29sJyk7XG4gICAgICAgIHN0ZXBMaXN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdQcm9jZXNzaW5nIHN0ZXBzJyk7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLm1hcmdpblRvcCA9ICcxMnB4JztcbiAgICAgICAgc3RlcExpc3Quc3R5bGUucGFkZGluZ0xlZnQgPSAnMjBweCc7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLmZvbnRTaXplID0gJzAuOXJlbSc7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG5cbiAgICAgICAgY29uc3QgbGFiZWxzID0gW1xuICAgICAgICAgICAgJ1ZhbGlkYXRlIFVSTCcsXG4gICAgICAgICAgICAnRmV0Y2ggdmlkZW8gaW5mbycsXG4gICAgICAgICAgICAnUnVuIEFJIGFuYWx5c2lzJyxcbiAgICAgICAgICAgICdTYXZlIG5vdGUnXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5wcm9ncmVzc1N0ZXBzID0gbGFiZWxzLm1hcCgobGFiZWwsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gc3RlcExpc3QuY3JlYXRlRWwoJ2xpJyk7XG4gICAgICAgICAgICBpdGVtLnNldEF0dHJpYnV0ZSgncm9sZScsICdzdGF0dXMnKTtcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUubWFyZ2luQm90dG9tID0gJzRweCc7XG4gICAgICAgICAgICBpdGVtLnRleHRDb250ZW50ID0gYFx1MjVDQiAke2xhYmVsfWA7XG4gICAgICAgICAgICByZXR1cm4geyBsYWJlbCwgZWxlbWVudDogaXRlbSB9O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYWN0aW9uIGJ1dHRvbnMgd2l0aCBhY2Nlc3NpYmlsaXR5XG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25CdXR0b25zKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNyZWF0ZUJ1dHRvbkNvbnRhaW5lcigpO1xuXG4gICAgICAgIC8vIENhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnRuID0gdGhpcy5jcmVhdGVCdXR0b24oXG4gICAgICAgICAgICBjb250YWluZXIsXG4gICAgICAgICAgICBNRVNTQUdFUy5NT0RBTFMuQ0FOQ0VMLFxuICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAoKSA9PiB0aGlzLmNsb3NlKClcbiAgICAgICAgKTtcbiAgICAgICAgY2FuY2VsQnRuLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDYW5jZWwgdmlkZW8gcHJvY2Vzc2luZycpO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgYnV0dG9uXG4gICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgY29udGFpbmVyLFxuICAgICAgICAgICAgTUVTU0FHRVMuTU9EQUxTLlBST0NFU1MsXG4gICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgKCkgPT4gdGhpcy5oYW5kbGVQcm9jZXNzKClcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdQcm9jZXNzIFlvdVR1YmUgdmlkZW8nKTtcblxuICAgICAgICAvLyBPcGVuIGJ1dHRvbiAoaGlkZGVuIGluaXRpYWxseSlcbiAgICAgICAgdGhpcy5vcGVuQnV0dG9uID0gdGhpcy5jcmVhdGVCdXR0b24oXG4gICAgICAgICAgICBjb250YWluZXIsXG4gICAgICAgICAgICAnT3BlbiBOb3RlJyxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAoKSA9PiB0aGlzLmhhbmRsZU9wZW5GaWxlKClcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5vcGVuQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdPcGVuIHRoZSBwcm9jZXNzZWQgbm90ZScpO1xuICAgICAgICB0aGlzLm9wZW5CdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICB0aGlzLnVwZGF0ZVByb2Nlc3NCdXR0b25TdGF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB1cCBldmVudCBoYW5kbGVyc1xuICAgICAqL1xuICAgIHByaXZhdGUgc2V0dXBFdmVudEhhbmRsZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNldHVwS2V5SGFuZGxlcnMoXG4gICAgICAgICAgICAoKSA9PiB0aGlzLmhhbmRsZVByb2Nlc3MoKSxcbiAgICAgICAgICAgICgpID0+IHRoaXMuY2xvc2UoKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvY3VzIG9uIFVSTCBpbnB1dFxuICAgICAqL1xuICAgIHByaXZhdGUgZm9jdXNVcmxJbnB1dCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudXJsSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNFbGVtZW50KHRoaXMudXJsSW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHByb2Nlc3MgYnV0dG9uIGVuYWJsZWQgc3RhdGUgKG9wdGltaXplZCB3aXRoIGRlYm91bmNpbmcgYW5kIG1lbW9pemF0aW9uKVxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlUHJvY2Vzc0J1dHRvblN0YXRlKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMucHJvY2Vzc0J1dHRvbikgcmV0dXJuO1xuXG4gICAgICAgIGlmICh0aGlzLmlzUHJvY2Vzc2luZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdHJpbW1lZFVybCA9IHRoaXMudXJsLnRyaW0oKTtcblxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzQnV0dG9uICYmIHRoaXMucHJvY2Vzc0J1dHRvbi50ZXh0Q29udGVudCAhPT0gTUVTU0FHRVMuTU9EQUxTLlBST0NFU1MgJiYgdHJpbW1lZFVybC5sZW5ndGggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnRleHRDb250ZW50ID0gTUVTU0FHRVMuTU9EQUxTLlBST0NFU1M7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE1lbW9pemUgdmFsaWRhdGlvbiByZXN1bHQgZm9yIHNhbWUgVVJMIChhdm9pZCByZXBlYXRlZCBleHBlbnNpdmUgdmFsaWRhdGlvbilcbiAgICAgICAgaWYgKHRyaW1tZWRVcmwgPT09IHRoaXMubGFzdFZhbGlkVXJsKSB7XG4gICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5sYXN0VmFsaWRSZXN1bHQhO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID0gIWlzVmFsaWQ7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uc3R5bGUub3BhY2l0eSA9IGlzVmFsaWQgPyAnMScgOiAnMC41JztcbiAgICAgICAgICAgIGlmICh0cmltbWVkVXJsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ1Bhc3RlIGEgWW91VHViZSBsaW5rIHRvIGJlZ2luIHByb2Nlc3NpbmcuJywgJ2luZm8nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZCA/ICdSZWFkeSB0byBwcm9jZXNzIHRoaXMgdmlkZW8uJyA6ICdFbnRlciBhIHZhbGlkIFlvdVR1YmUgdmlkZW8gVVJMLicsXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPyAnc3VjY2VzcycgOiAnZXJyb3InXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoaXNWYWxpZCA/ICd2YWxpZCcgOiAnaW52YWxpZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBEZWJvdW5jZWQgdmFsaWRhdGlvbiBmb3IgYmV0dGVyIFVYIGFuZCBwZXJmb3JtYW5jZVxuICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uVGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnZhbGlkYXRpb25UaW1lcik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMudmFsaWRhdGlvblRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCh0cmltbWVkVXJsKTtcbiAgICAgICAgICAgIHRoaXMubGFzdFZhbGlkVXJsID0gdHJpbW1lZFVybDtcbiAgICAgICAgICAgIHRoaXMubGFzdFZhbGlkUmVzdWx0ID0gaXNWYWxpZDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uIS5kaXNhYmxlZCA9ICFpc1ZhbGlkO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uIS5zdHlsZS5vcGFjaXR5ID0gaXNWYWxpZCA/ICcxJyA6ICcwLjUnO1xuXG4gICAgICAgICAgICBpZiAodHJpbW1lZFVybC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdQYXN0ZSBhIFlvdVR1YmUgbGluayB0byBiZWdpbiBwcm9jZXNzaW5nLicsICdpbmZvJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKCdpZGxlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPyAnUmVhZHkgdG8gcHJvY2VzcyB0aGlzIHZpZGVvLicgOiAnRW50ZXIgYSB2YWxpZCBZb3VUdWJlIHZpZGVvIFVSTC4nLFxuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKGlzVmFsaWQgPyAndmFsaWQnIDogJ2ludmFsaWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAvLyBJZiBVUkwgaXMgdmFsaWQsIGZldGNoIGEgbGlnaHR3ZWlnaHQgcHJldmlldyAodGh1bWJuYWlsICsgdGl0bGUpXG4gICAgICAgICAgICAgICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLm1heWJlRmV0Y2hQcmV2aWV3KHRyaW1tZWRVcmwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJQcmV2aWV3KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9LCAzMDApOyAvLyAzMDBtcyBkZWJvdW5jZVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIFVSTCBpbnB1dCAoc2ltcGxpZmllZCAtIHVzZWQgYnkgZGVib3VuY2VkIGhhbmRsZXIpXG4gICAgICovXG4gICAgcHJpdmF0ZSBpc1VybFZhbGlkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHRoaXMudXJsLnRyaW0oKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIHByb2Nlc3MgYnV0dG9uIGNsaWNrXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVQcm9jZXNzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB0cmltbWVkVXJsID0gdGhpcy51cmwudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0cmltbWVkVXJsKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKE1FU1NBR0VTLkVSUk9SUy5FTlRFUl9VUkwpO1xuICAgICAgICAgICAgdGhpcy5mb2N1c1VybElucHV0KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuaXNVcmxWYWxpZCgpKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKE1FU1NBR0VTLkVSUk9SUy5JTlZBTElEX1VSTCk7XG4gICAgICAgICAgICB0aGlzLmZvY3VzVXJsSW5wdXQoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBJZiB1c2VyIGV4cGxpY2l0bHkgc2VsZWN0ZWQgR29vZ2xlIEdlbWluaSBhbmQgY2hvc2UgYSBtb2RlbCB0aGF0XG4gICAgICAgICAgICAvLyBkb2VzIG5vdCBzdXBwb3J0IG11bHRpbW9kYWwgYXVkaW8vdmlkZW8gdG9rZW5zLCBidXQgdGhlIFVSTCBpcyBhXG4gICAgICAgICAgICAvLyBZb3VUdWJlIHZpZGVvLCBzdWdnZXN0IHN3aXRjaGluZyB0byBhIG11bHRpbW9kYWwtY2FwYWJsZSBtb2RlbC5cbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUHJvdmlkZXIgPT09ICdHb29nbGUgR2VtaW5pJyAmJiB0aGlzLnNlbGVjdGVkTW9kZWwgJiYgdGhpcy5pc1VybFZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBQUk9WSURFUl9NT0RFTF9PUFRJT05TWydHb29nbGUgR2VtaW5pJ10gfHwgW10gYXMgYW55W107XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbW9kZWxzLmZpbmQobSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IChtICYmIG0ubmFtZSA/IG0ubmFtZSA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcobmFtZSkudG9Mb3dlckNhc2UoKSA9PT0gU3RyaW5nKHRoaXMuc2VsZWN0ZWRNb2RlbCB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkgYXMgYW55IHwgdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1cHBvcnRzQXVkaW9WaWRlbyA9ICEhKG1hdGNoICYmIG1hdGNoLnN1cHBvcnRzQXVkaW9WaWRlbyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc3VwcG9ydHNBdWRpb1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWNvbW1lbmQgYSBtdWx0aW1vZGFsLWNhcGFibGUgbW9kZWwgKHByZWZlciBjb25maWd1cmVkIGRlZmF1bHQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWNvbW1lbmRlZCA9IChtb2RlbHMuZmluZChtID0+IChtICYmIG0uc3VwcG9ydHNBdWRpb1ZpZGVvKSkgfHwgeyBuYW1lOiBBSV9NT0RFTFMuR0VNSU5JIH0pLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgY3VzdG9tIHN0eWxlZCBjb25maXJtYXRpb24gbW9kYWwgaW5zdGVhZCBvZiBuYXRpdmUgY29uZmlybSgpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRTd2l0Y2ggPSBhd2FpdCB0aGlzLnNob3dDb25maXJtYXRpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTXVsdGltb2RhbCBNb2RlbCBSZWNvbW1lbmRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFRoZSBzZWxlY3RlZCBtb2RlbCAoJHt0aGlzLnNlbGVjdGVkTW9kZWx9KSBtYXkgbm90IHN1cHBvcnQgbXVsdGltb2RhbCBhbmFseXNpcy5cXG5cXG5Xb3VsZCB5b3UgbGlrZSB0byBzd2l0Y2ggdG8gYSBtdWx0aW1vZGFsLWNhcGFibGUgbW9kZWwgKCR7cmVjb21tZW5kZWR9KSBmb3IgYmV0dGVyIHZpZGVvIGFuYWx5c2lzP2AsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1N3aXRjaCB0byBNdWx0aW1vZGFsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnS2VlcCBDdXJyZW50IE1vZGVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRTd2l0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgdGhlIHJlY29tbWVuZGVkIG1vZGVsIGV4aXN0cyBpbiB0aGUgY3VycmVudCBtb2RlbFNlbGVjdDsgaWYgbm90LCBhZGQgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlbFNlbGVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdHMgPSBBcnJheS5mcm9tKHRoaXMubW9kZWxTZWxlY3Qub3B0aW9ucykuc29tZShvID0+IG8udmFsdWUgPT09IHJlY29tbWVuZGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0LnZhbHVlID0gcmVjb21tZW5kZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHQudGV4dCA9IHJlY29tbWVuZGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5hcHBlbmRDaGlsZChvcHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZWxTZWxlY3QudmFsdWUgPSByZWNvbW1lbmRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsID0gcmVjb21tZW5kZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsID0gcmVjb21tZW5kZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5vbi1mYXRhbDogZmFsbCBiYWNrIHRvIGRlZmF1bHQgYmVoYXZpb3JcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdbWW91VHViZVVybE1vZGFsXSBtb2RlbCByZWNvbW1lbmRhdGlvbiBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2hvd1Byb2Nlc3NpbmdTdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMCwgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGFydCBwcm9jZXNzaW5nIHdpdGggcHJvZ3Jlc3MgdXBkYXRlc1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9ncmVzcygyMCwgJ1ZhbGlkYXRpbmcgWW91VHViZSBVUkwuLi4nKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKDAsICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMSwgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKDQwLCAnRXh0cmFjdGluZyB2aWRlbyBkYXRhLi4uJyk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgICB0aGlzLnNldFN0ZXBTdGF0ZSgxLCAnY29tcGxldGUnKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKDIsICdhY3RpdmUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9ncmVzcyg2MCwgJ0FuYWx5emluZyB2aWRlbyBjb250ZW50Li4uJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENhbGwgdGhlIGFjdHVhbCBwcm9jZXNzaW5nIGZ1bmN0aW9uIChwYXNzIHByb3ZpZGVyL21vZGVsIHNlbGVjdGlvbiBhbmQgcGVyZm9ybWFuY2Ugc2V0dGluZ3MpXG4gICAgICAgICAgICBjb25zdCBjdXN0b21Qcm9tcHQgPSB0aGlzLmZvcm1hdCA9PT0gJ2N1c3RvbScgPyB0aGlzLmN1c3RvbVByb21wdElucHV0Py52YWx1ZSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYXdhaXQgdGhpcy5vcHRpb25zLm9uUHJvY2VzcyhcbiAgICAgICAgICAgICAgICB0cmltbWVkVXJsLFxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0LFxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQcm92aWRlcixcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwsXG4gICAgICAgICAgICAgICAgY3VzdG9tUHJvbXB0LFxuICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybWFuY2VNb2RlLFxuICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nLFxuICAgICAgICAgICAgICAgIHRoaXMucHJlZmVyTXVsdGltb2RhbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKDIsICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMywgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKDgwLCAnR2VuZXJhdGluZyBub3RlLi4uJyk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMzAwKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUHJvZ3Jlc3MoMTAwLCAnQ29tcGxldGUhJyk7XG4gICAgICAgICAgICB0aGlzLnNldFN0ZXBTdGF0ZSgzLCAnY29tcGxldGUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGZpbGUgcGF0aCBhbmQgc2hvdyBjb21wbGV0aW9uIHN0YXRlXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NlZEZpbGVQYXRoID0gZmlsZVBhdGg7XG4gICAgICAgICAgICB0aGlzLnNob3dDb21wbGV0aW9uU3RhdGUoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5mbGFnQWN0aXZlU3RlcEFzRXJyb3IoKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yU3RhdGUoZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciBhcyBFcnJvciwgJ1lvdVR1YmUgVVJMIHByb2Nlc3NpbmcnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBvcGVuIGZpbGUgYnV0dG9uIGNsaWNrXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVPcGVuRmlsZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc2VkRmlsZVBhdGggJiYgdGhpcy5vcHRpb25zLm9uT3BlbkZpbGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vcHRpb25zLm9uT3BlbkZpbGUodGhpcy5wcm9jZXNzZWRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHByb2Nlc3Npbmcgc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dQcm9jZXNzaW5nU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUHJvY2Vzc2luZyB2aWRlby4gVGhpcyBtYXkgdGFrZSBhIG1vbWVudC4uLicsICdpbmZvJyk7XG4gICAgICAgIHRoaXMucmVzZXRQcm9ncmVzc1N0ZXBzKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaG93IHByb2dyZXNzIHNlY3Rpb25cbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERpc2FibGUgaW5wdXRzIGFuZCBwcm9jZXNzIGJ1dHRvblxuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0J1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi50ZXh0Q29udGVudCA9ICdQcm9jZXNzaW5nLi4uJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcGVuQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW5CdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZSgnaWRsZScpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBjb21wbGV0aW9uIHN0YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93Q29tcGxldGlvblN0YXRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIFVSTCB0byBwcmVwYXJlIGZvciBuZXh0IHZpZGVvIGFuZCBwcmV2ZW50IGN5Y2xlc1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgdGhpcy51cmwgPSAnJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi50ZXh0Q29udGVudCA9ICdQcm9jZXNzIEFub3RoZXInO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wZW5CdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMub3BlbkJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oZWFkZXJFbCkge1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJFbC50ZXh0Q29udGVudCA9ICdcdTI3MDUgVmlkZW8gUHJvY2Vzc2VkIFN1Y2Nlc3NmdWxseSEnO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZShcIk5vdGUgc2F2ZWQgdG8gdG9kYXkncyBmb2xkZXIuIFlvdSBjYW4gb3BlbiBpdCBub3cgb3IgcHJvY2VzcyBhbm90aGVyIHZpZGVvLlwiLCAnc3VjY2VzcycpO1xuICAgICAgICB0aGlzLmZvY3VzVXJsSW5wdXQoKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTsgLy8gUmVzZXQgdG8gaWRsZSBzaW5jZSB3ZSBjbGVhcmVkIHRoZSBVUkxcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IGVycm9yIHN0YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93RXJyb3JTdGF0ZShlcnJvcjogRXJyb3IpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pc1Byb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByb2Nlc3NCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnRleHRDb250ZW50ID0gTUVTU0FHRVMuTU9EQUxTLlBST0NFU1M7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wZW5CdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMub3BlbkJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaGVhZGVyRWwpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyRWwudGV4dENvbnRlbnQgPSAnXHUyNzRDIFByb2Nlc3NpbmcgRmFpbGVkJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoZXJyb3IubWVzc2FnZSwgJ2Vycm9yJyk7XG4gICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcbiAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKHRoaXMudXJsLnRyaW0oKS5sZW5ndGggPiAwID8gJ2ludmFsaWQnIDogJ2lkbGUnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgcHJvZ3Jlc3MgYmFyIGFuZCB0ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVQcm9ncmVzcyhwZXJjZW50OiBudW1iZXIsIHRleHQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wcm9ncmVzc0Jhcikge1xuICAgICAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGAke3BlcmNlbnR9JWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgaW5pdGlhbCBVUkwgdmFsdWVcbiAgICAgKi9cbiAgICBzZXRVcmwodXJsOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgLy8gUHJldmVudCBjeWNsZXMgLSBkb24ndCBzZXQgdGhlIHNhbWUgVVJMIGFnYWluXG4gICAgICAgIGlmICh0aGlzLnVybC50cmltKCkgPT09IHVybC50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVVcmxNb2RhbDogc2V0VXJsIGNhbGxlZCB3aXRoIHNhbWUgVVJMLCBwcmV2ZW50aW5nIGN5Y2xlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgaWYgKHRoaXMudXJsSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMudXJsSW5wdXQudmFsdWUgPSB1cmw7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2Nlc3NCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgdHJpbW1lZCA9IHVybC50cmltKCk7XG4gICAgICAgICAgICBpZiAodHJpbW1lZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCh0cmltbWVkKSA/ICd2YWxpZCcgOiAnaW52YWxpZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgcmVzb3VyY2VzIHdoZW4gbW9kYWwgaXMgY2xvc2VkXG4gICAgICovXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW4gdXAgdmFsaWRhdGlvbiB0aW1lclxuICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uVGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnZhbGlkYXRpb25UaW1lcik7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25UaW1lciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENsZWFuIHVwIHByb2dyZXNzIGNvbnRhaW5lciBhbmQgc3RlcHNcbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NDb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NTdGVwcyA9IFtdO1xuXG4gICAgICAgIC8vIENhbGwgcGFyZW50IGNsZWFudXBcbiAgICAgICAgc3VwZXIub25DbG9zZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IFVSTCB2YWx1ZVxuICAgICAqL1xuICAgIGdldFVybCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy51cmw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNldFByb2dyZXNzU3RlcHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3VycmVudFN0ZXBJbmRleCA9IDA7XG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzU3RlcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb2dyZXNzU3RlcHMuZm9yRWFjaCgoc3RlcCkgPT4ge1xuICAgICAgICAgICAgc3RlcC5lbGVtZW50LnRleHRDb250ZW50ID0gYFx1MjVDQiAke3N0ZXAubGFiZWx9YDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRTdGVwU3RhdGUoaW5kZXg6IG51bWJlciwgc3RhdGU6IFN0ZXBTdGF0ZSk6IHZvaWQge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnByb2dyZXNzU3RlcHNbaW5kZXhdO1xuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5nZXRTdGVwUHJlZml4KHN0YXRlKTtcbiAgICAgICAgdGFyZ2V0LmVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHtwcmVmaXh9ICR7dGFyZ2V0LmxhYmVsfWA7XG5cbiAgICAgICAgaWYgKHN0YXRlID09PSAnYWN0aXZlJykge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RlcEluZGV4ID0gaW5kZXg7XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09ICdjb21wbGV0ZScgJiYgdGhpcy5jdXJyZW50U3RlcEluZGV4ID09PSBpbmRleCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RlcEluZGV4ID0gTWF0aC5taW4oaW5kZXggKyAxLCB0aGlzLnByb2dyZXNzU3RlcHMubGVuZ3RoIC0gMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGZsYWdBY3RpdmVTdGVwQXNFcnJvcigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKHRoaXMuY3VycmVudFN0ZXBJbmRleCwgJ2Vycm9yJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRTdGVwUHJlZml4KHN0YXRlOiBTdGVwU3RhdGUpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgICAgICBjYXNlICdhY3RpdmUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnXHUyNUNGJztcbiAgICAgICAgICAgIGNhc2UgJ2NvbXBsZXRlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1x1MjcxNCc7XG4gICAgICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdcdTI2QTAnO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1x1MjVDQic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUlubGluZUJ1dHRvbihjb250YWluZXI6IEhUTUxFbGVtZW50LCBsYWJlbDogc3RyaW5nLCBvbkNsaWNrOiAoKSA9PiB2b2lkKTogSFRNTEJ1dHRvbkVsZW1lbnQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBjb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogbGFiZWwgfSk7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5wYWRkaW5nID0gJzZweCAxMnB4JztcbiAgICAgICAgYnV0dG9uLnN0eWxlLmZvbnRTaXplID0gJzAuODVyZW0nO1xuICAgICAgICBidXR0b24uc3R5bGUuYm9yZGVyUmFkaXVzID0gJzZweCc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KSc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW5vcm1hbCknO1xuICAgICAgICBidXR0b24uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICBidXR0b24uc3R5bGUudHJhbnNpdGlvbiA9ICdiYWNrZ3JvdW5kLWNvbG9yIDAuMnMgZWFzZSc7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgIH0pO1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KSc7XG4gICAgICAgIH0pO1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrKTtcbiAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVBhc3RlRnJvbUNsaXBib2FyZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNQcm9jZXNzaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIW5hdmlnYXRvci5jbGlwYm9hcmQgfHwgIW5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ0NsaXBib2FyZCBhY2Nlc3MgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50LicsICdlcnJvcicpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnQ2xpcGJvYXJkIGFjY2VzcyBpcyBub3QgYXZhaWxhYmxlLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLnJlYWRUZXh0KCk7XG4gICAgICAgICAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdDbGlwYm9hcmQgaXMgZW1wdHkuIENvcHkgYSBZb3VUdWJlIFVSTCBmaXJzdC4nLCAnaW5mbycpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdHJpbW1lZCA9IHRleHQudHJpbSgpO1xuICAgICAgICAgICAgdGhpcy51cmwgPSB0cmltbWVkO1xuICAgICAgICAgICAgaWYgKHRoaXMudXJsSW5wdXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVybElucHV0LnZhbHVlID0gdHJpbW1lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGFzdFZhbGlkVXJsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9jZXNzQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcblxuICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCh0cmltbWVkKTtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgaXNWYWxpZCA/ICdSZWFkeSB0byBwcm9jZXNzIHRoaXMgdmlkZW8uJyA6ICdFbnRlciBhIHZhbGlkIFlvdVR1YmUgdmlkZW8gVVJMLicsXG4gICAgICAgICAgICAgICAgaXNWYWxpZCA/ICdzdWNjZXNzJyA6ICdlcnJvcidcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoaXNWYWxpZCA/ICd2YWxpZCcgOiAnaW52YWxpZCcpO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0J1dHRvbiAmJiAhdGhpcy5pc1Byb2Nlc3NpbmcgJiYgaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5mb2N1cygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVXJsSW5wdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsICdSZWFkaW5nIGNsaXBib2FyZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ0NvdWxkIG5vdCByZWFkIGZyb20gY2xpcGJvYXJkLiBQYXN0ZSBtYW51YWxseSBpbnN0ZWFkLicsICdlcnJvcicpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnQ291bGQgbm90IHJlYWQgZnJvbSBjbGlwYm9hcmQuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZUNsZWFyVXJsKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc1Byb2Nlc3NpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXJsID0gJyc7XG4gICAgICAgIGlmICh0aGlzLnVybElucHV0KSB7XG4gICAgICAgICAgICB0aGlzLnVybElucHV0LnZhbHVlID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0VmFsaWRVcmwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMudXBkYXRlUHJvY2Vzc0J1dHRvblN0YXRlKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUGFzdGUgYSBZb3VUdWJlIGxpbmsgdG8gYmVnaW4gcHJvY2Vzc2luZy4nLCAnaW5mbycpO1xuICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgdGhpcy5mb2N1c1VybElucHV0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGFzVXJsID0gdGhpcy51cmwudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgICAgIGlmICh0aGlzLmNsZWFyQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQnV0dG9uLmRpc2FibGVkID0gIWhhc1VybCB8fCB0aGlzLmlzUHJvY2Vzc2luZztcbiAgICAgICAgICAgIHRoaXMuY2xlYXJCdXR0b24uc3R5bGUub3BhY2l0eSA9IHRoaXMuY2xlYXJCdXR0b24uZGlzYWJsZWQgPyAnMC41JyA6ICcxJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXN0ZUJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5wYXN0ZUJ1dHRvbi5kaXNhYmxlZCA9IHRoaXMuaXNQcm9jZXNzaW5nO1xuICAgICAgICAgICAgdGhpcy5wYXN0ZUJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gdGhpcy5wYXN0ZUJ1dHRvbi5kaXNhYmxlZCA/ICcwLjUnIDogJzEnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRVcmxJbnB1dFN0YXRlKHN0YXRlOiAnaWRsZScgfCAndmFsaWQnIHwgJ2ludmFsaWQnKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGJvcmRlckNvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIGxldCBib3hTaGFkb3cgPSAnbm9uZSc7XG5cbiAgICAgICAgaWYgKHN0YXRlID09PSAndmFsaWQnKSB7XG4gICAgICAgICAgICBib3JkZXJDb2xvciA9ICd2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICAgICAgYm94U2hhZG93ID0gJzAgMCAwIDFweCB2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAnaW52YWxpZCcpIHtcbiAgICAgICAgICAgIGJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcbiAgICAgICAgICAgIGJveFNoYWRvdyA9ICcwIDAgMCAxcHggdmFyKC0tdGV4dC1lcnJvciknO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cmxJbnB1dC5zdHlsZS5ib3JkZXJDb2xvciA9IGJvcmRlckNvbG9yO1xuICAgICAgICB0aGlzLnVybElucHV0LnN0eWxlLmJveFNoYWRvdyA9IGJveFNoYWRvdztcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFZhbGlkYXRpb25NZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgdHlwZTogJ2luZm8nIHwgJ2Vycm9yJyB8ICdzdWNjZXNzJyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMudmFsaWRhdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudmFsaWRhdGlvbk1lc3NhZ2UudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuXG4gICAgICAgIGxldCBjb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgIGlmICh0eXBlID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICBjb2xvciA9ICd2YXIoLS10ZXh0LWVycm9yKSc7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICBjb2xvciA9ICd2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29sb3IgPSAndmFyKC0tdGV4dC1tdXRlZCknO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5zdHlsZS5jb2xvciA9IGNvbG9yO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyeSB0byBmZXRjaCBhIGxpZ2h0d2VpZ2h0IHByZXZpZXcgZm9yIHRoZSBwcm92aWRlZCBZb3VUdWJlIFVSTCB1c2luZyBvRW1iZWQuXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBtYXliZUZldGNoUHJldmlldyh1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5mZXRjaEluUHJvZ3Jlc3MpIHJldHVybjtcbiAgICAgICAgaWYgKCF1cmwpIHJldHVybjtcbiAgICAgICAgaWYgKHRoaXMubGFzdFZhbGlkVXJsID09PSB1cmwgJiYgdGhpcy50aHVtYm5haWxFbCAmJiB0aGlzLnRodW1ibmFpbEVsLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gYWxyZWFkeSBmZXRjaGVkIGZvciB0aGlzIFVSTFxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRGZXRjaGluZ1N0YXRlKHRydWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbWV0YSA9IGF3YWl0IHRoaXMuZmV0Y2hWaWRlb1ByZXZpZXcodXJsKTtcbiAgICAgICAgICAgIGlmIChtZXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93UHJldmlldyhtZXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclByZXZpZXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIHNpbGVudGx5IGNsZWFyIHByZXZpZXcgb24gZmFpbHVyZSwga2VlcCBVWCByZXNwb25zaXZlXG4gICAgICAgICAgICB0aGlzLmNsZWFyUHJldmlldygpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5zZXRGZXRjaGluZ1N0YXRlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2V0RmV0Y2hpbmdTdGF0ZShpc0ZldGNoaW5nOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmV0Y2hJblByb2dyZXNzID0gaXNGZXRjaGluZztcbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0J1dHRvbikge1xuICAgICAgICAgICAgLy8gZGlzYWJsZSBwcm9jZXNzaW5nIHdoaWxlIGZldGNoaW5nIHByZXZpZXdcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5kaXNhYmxlZCA9IGlzRmV0Y2hpbmcgfHwgISh0aGlzLmxhc3RWYWxpZFJlc3VsdCA/PyBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uc3R5bGUub3BhY2l0eSA9IHRoaXMucHJvY2Vzc0J1dHRvbi5kaXNhYmxlZCA/ICcwLjUnIDogJzEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRpb25NZXNzYWdlKSB7XG4gICAgICAgICAgICBpZiAoaXNGZXRjaGluZykgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnRmV0Y2hpbmcgcHJldmlldy4uLicsICdpbmZvJyk7XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmxhc3RWYWxpZFJlc3VsdCkgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUmVhZHkgdG8gcHJvY2VzcyB0aGlzIHZpZGVvLicsICdzdWNjZXNzJyk7XG4gICAgICAgICAgICBlbHNlIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ0VudGVyIGEgdmFsaWQgWW91VHViZSB2aWRlbyBVUkwuJywgJ2Vycm9yJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGZldGNoVmlkZW9QcmV2aWV3KHVybDogc3RyaW5nKTogUHJvbWlzZTx7IHRpdGxlOiBzdHJpbmc7IGF1dGhvcjogc3RyaW5nOyB0aHVtYm5haWw6IHN0cmluZyB9IHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgb2VtYmVkID0gYGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL29lbWJlZD91cmw9JHtlbmNvZGVVUklDb21wb25lbnQodXJsKX0mZm9ybWF0PWpzb25gO1xuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2gob2VtYmVkKTtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCAnJyxcbiAgICAgICAgICAgICAgICBhdXRob3I6IGRhdGEuYXV0aG9yX25hbWUgfHwgJycsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbF91cmwgfHwgJydcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1ByZXZpZXcobWV0YTogeyB0aXRsZTogc3RyaW5nOyBhdXRob3I6IHN0cmluZzsgdGh1bWJuYWlsOiBzdHJpbmcgfSk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMudGh1bWJuYWlsRWwgfHwgIXRoaXMubWV0YWRhdGFDb250YWluZXIpIHJldHVybjtcbiAgICAgICAgaWYgKG1ldGEudGh1bWJuYWlsKSB7XG4gICAgICAgICAgICB0aGlzLnRodW1ibmFpbEVsLnNyYyA9IG1ldGEudGh1bWJuYWlsO1xuICAgICAgICAgICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBvcHVsYXRlIG1ldGFkYXRhIGZpZWxkcyAoc3RydWN0dXJlIGNyZWF0ZWQgZWFybGllcilcbiAgICAgICAgY29uc3QgdGl0bGVFbCA9IHRoaXMubWV0YWRhdGFDb250YWluZXIucXVlcnlTZWxlY3RvcignLnl0LXByZXZpZXctdGl0bGUnKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgY29uc3QgY2hhbm5lbEVsID0gdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcueXQtcHJldmlldy1jaGFubmVsJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIGlmICh0aXRsZUVsKSB7XG4gICAgICAgICAgICB0aXRsZUVsLnRleHRDb250ZW50ID0gbWV0YS50aXRsZTtcbiAgICAgICAgICAgIHRpdGxlRWwuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnO1xuICAgICAgICAgICAgdGl0bGVFbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbm5lbEVsKSB7XG4gICAgICAgICAgICBjaGFubmVsRWwudGV4dENvbnRlbnQgPSBtZXRhLmF1dGhvcjtcbiAgICAgICAgICAgIGNoYW5uZWxFbC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgICAgICBjaGFubmVsRWwuc3R5bGUuZm9udFNpemUgPSAnMC44NXJlbSc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYXJQcmV2aWV3KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy50aHVtYm5haWxFbCkge1xuICAgICAgICAgICAgdGhpcy50aHVtYm5haWxFbC5zcmMgPSAnJztcbiAgICAgICAgICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZXRhZGF0YUNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29uc3QgdGl0bGVFbCA9IHRoaXMubWV0YWRhdGFDb250YWluZXIucXVlcnlTZWxlY3RvcignLnl0LXByZXZpZXctdGl0bGUnKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGNoYW5uZWxFbCA9IHRoaXMubWV0YWRhdGFDb250YWluZXIucXVlcnlTZWxlY3RvcignLnl0LXByZXZpZXctY2hhbm5lbCcpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgaWYgKHRpdGxlRWwpIHRpdGxlRWwudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGlmIChjaGFubmVsRWwpIGNoYW5uZWxFbC50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgIi8qKlxuICogUGx1Z2luIHNldHRpbmdzIHRhYiBjb21wb25lbnRcbiAqIERlc2lnbmVkIHRvIHByZXZlbnQgY29uZmxpY3RzIHdpdGggb3RoZXIgcGx1Z2luIHNldHRpbmdzXG4gKi9cblxuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgWW91VHViZVBsdWdpblNldHRpbmdzLCBPdXRwdXRGb3JtYXQgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBWYWxpZGF0aW9uVXRpbHMgfSBmcm9tICcuL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9zZXJ2aWNlcy9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IFNlY3VyZUNvbmZpZ1NlcnZpY2UgfSBmcm9tICcuL3NlY3VyZS1jb25maWcnO1xuXG4vLyBVbmlxdWUgQ1NTIGNsYXNzZXMgdG8gcHJldmVudCBjb25mbGljdHNcbmNvbnN0IFNFVFRJTkdTX0NTU19DTEFTU0VTID0ge1xuICAgIGNvbnRhaW5lcjogJ3l0Yy1zZXR0aW5ncy1jb250YWluZXInLFxuICAgIHNlY3Rpb246ICd5dGMtc2V0dGluZ3Mtc2VjdGlvbicsXG4gICAgaGVhZGVyOiAneXRjLXNldHRpbmdzLWhlYWRlcicsXG4gICAgdmFsaWRhdGlvbjogJ3l0Yy1zZXR0aW5ncy12YWxpZGF0aW9uJ1xufSBhcyBjb25zdDtcblxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nc1RhYk9wdGlvbnMge1xuICAgIHBsdWdpbjogYW55OyAvLyBQbHVnaW4gaW5zdGFuY2VcbiAgICBvblNldHRpbmdzQ2hhbmdlOiAoc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncykgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncztcbiAgICBwcml2YXRlIHZhbGlkYXRpb25FcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgcHJpdmF0ZSBzZWN1cmVDb25maWc6IFNlY3VyZUNvbmZpZ1NlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgb3B0aW9uczogU2V0dGluZ3NUYWJPcHRpb25zXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgb3B0aW9ucy5wbHVnaW4pO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0geyAuLi5vcHRpb25zLnBsdWdpbi5zZXR0aW5ncyB9O1xuICAgICAgICB0aGlzLnNlY3VyZUNvbmZpZyA9IG5ldyBTZWN1cmVDb25maWdTZXJ2aWNlKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdW5pcXVlIENTUyBjbGFzcyBmb3IgY29uZmxpY3QgcHJldmVudGlvblxuICAgICAgICBjb250YWluZXJFbC5hZGRDbGFzcyhTRVRUSU5HU19DU1NfQ0xBU1NFUy5jb250YWluZXIpO1xuICAgICAgICBjb250YWluZXJFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGx1Z2luJywgJ3lvdXR1YmUtY2xpcHBlcicpO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQVBJU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVTZWN1cml0eVNldHRpbmdzKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlRmlsZVNldHRpbmdzKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlVmFsaWRhdGlvblN0YXR1cygpO1xuICAgICAgICB0aGlzLmNyZWF0ZVVzYWdlSW5zdHJ1Y3Rpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGhlYWRlciB3aXRoIHZlcnNpb24gaW5mb3JtYXRpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUhlYWRlcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGVhZGVyRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdihTRVRUSU5HU19DU1NfQ0xBU1NFUy5oZWFkZXIpO1xuICAgICAgICBoZWFkZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdZb3VUdWJlQ2xpcHBlciBTZXR0aW5ncycgfSk7XG5cbiAgICAgICAgLy8gU3RyZWFtbGluZWQgc2V0dGluZ3Mgbm90ZVxuICAgICAgICBjb25zdCBub3RlRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgbm90ZUVsLmNyZWF0ZUVsKCdwJywge1xuICAgICAgICAgICAgdGV4dDogJ1x1RDgzRFx1RENDQyBQZXJmb3JtYW5jZSBzZXR0aW5ncyBoYXZlIGJlZW4gbW92ZWQgdG8gdGhlIFVSTCBpbnB1dCBtb2RhbCBmb3IgZWFzaWVyIGFjY2VzcyBhbmQgYmV0dGVyIHdvcmtmbG93IGludGVncmF0aW9uLicsXG4gICAgICAgICAgICBjbHM6ICdzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24nXG4gICAgICAgIH0pO1xuICAgICAgICBub3RlRWwuc3R5bGUubWFyZ2luQm90dG9tID0gJzE2cHgnO1xuICAgICAgICBub3RlRWwuc3R5bGUucGFkZGluZyA9ICc4cHggMTJweCc7XG4gICAgICAgIG5vdGVFbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICBub3RlRWwuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgIG5vdGVFbC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWludGVyYWN0aXZlLWFjY2VudCknO1xuXG4gICAgICAgIC8vIFZlcnNpb24gaW5mb1xuICAgICAgICBjb25zdCB2ZXJzaW9uRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoJ3l0Yy12ZXJzaW9uLWluZm8nKTtcbiAgICAgICAgdmVyc2lvbkVsLmNyZWF0ZUVsKCdzcGFuJywgeyBcbiAgICAgICAgICAgIHRleHQ6ICd2MS4yLjAgLSBQcm9kdWN0aW9uIFJlYWR5JyxcbiAgICAgICAgICAgIGNsczogJ3l0Yy12ZXJzaW9uLWJhZGdlJ1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFF1aWNrIHN0YXR1cyBjaGVja1xuICAgICAgICBjb25zdCBzdGF0dXNFbCA9IGhlYWRlckVsLmNyZWF0ZURpdigneXRjLXN0YXR1cy1pbmZvJyk7XG4gICAgICAgIGNvbnN0IGhhc1ZhbGlkQ29uZmlnID0gdGhpcy52YWxpZGF0ZUNvbmZpZ3VyYXRpb24oKTtcbiAgICAgICAgc3RhdHVzRWwuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgICB0ZXh0OiBoYXNWYWxpZENvbmZpZyA/ICdcdTI3MDUgUmVhZHkgdG8gdXNlJyA6ICdcdTI2QTBcdUZFMEYgQ29uZmlndXJhdGlvbiBuZWVkZWQnLFxuICAgICAgICAgICAgY2xzOiBoYXNWYWxpZENvbmZpZyA/ICd5dGMtc3RhdHVzLWdvb2QnIDogJ3l0Yy1zdGF0dXMtd2FybmluZydcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBEb2N1bWVudGF0aW9uIGxpbmtcbiAgICAgICAgY29uc3QgZG9jc0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KCd5dGMtZG9jcy1saW5rJyk7XG4gICAgICAgIGRvY3NFbC5jcmVhdGVFbCgnYScsIHtcbiAgICAgICAgICAgIHRleHQ6ICdcdUQ4M0RcdURDRDYgVmlldyBEb2N1bWVudGF0aW9uJyxcbiAgICAgICAgICAgIGhyZWY6ICcjJyxcbiAgICAgICAgICAgIGNsczogJ3l0Yy1kb2NzLWJ1dHRvbidcbiAgICAgICAgfSkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5zaG93RG9jdW1lbnRhdGlvbigpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBlbnRpcmUgY29uZmlndXJhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgdmFsaWRhdGVDb25maWd1cmF0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBoYXNBcGlLZXkgPSB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleT8udHJpbSgpIHx8IHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleT8udHJpbSgpO1xuICAgICAgICBjb25zdCBoYXNWYWxpZFBhdGggPSBWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFBhdGgodGhpcy5zZXR0aW5ncy5vdXRwdXRQYXRoKTtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4oaGFzQXBpS2V5ICYmIGhhc1ZhbGlkUGF0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBpbmxpbmUgZG9jdW1lbnRhdGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgc2hvd0RvY3VtZW50YXRpb24oKTogdm9pZCB7XG4gICAgICAgIHdpbmRvdy5vcGVuKCdodHRwczovL2dpdGh1Yi5jb20veW91dHViZS1jbGlwcGVyL29ic2lkaWFuLXBsdWdpbiNyZWFkbWUnLCAnX2JsYW5rJyk7XG4gICAgfSAgICAvKipcbiAgICAgKiBDcmVhdGUgQVBJIGNvbmZpZ3VyYXRpb24gc2V0dGluZ3NcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUFQSVNldHRpbmdzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgLy8gQVBJIEtleXMgc2VjdGlvblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdBUEkgQ29uZmlndXJhdGlvbicgfSk7XG5cbiAgICAgICAgLy8gU2VjdXJpdHkgTm90aWNlXG4gICAgICAgIGNvbnN0IHNlY3VyaXR5Tm90aWNlID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCd5dGMtc2VjdXJpdHktbm90aWNlJyk7XG4gICAgICAgIHNlY3VyaXR5Tm90aWNlLnN0eWxlLnBhZGRpbmcgPSAnMTJweCc7XG4gICAgICAgIHNlY3VyaXR5Tm90aWNlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxNnB4JztcbiAgICAgICAgc2VjdXJpdHlOb3RpY2Uuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcbiAgICAgICAgc2VjdXJpdHlOb3RpY2Uuc3R5bGUuYm9yZGVyTGVmdCA9ICc0cHggc29saWQgdmFyKC0tdGV4dC1hY2NlbnQpJztcbiAgICAgICAgc2VjdXJpdHlOb3RpY2Uuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBub3RpY2VUaXRsZSA9IHNlY3VyaXR5Tm90aWNlLmNyZWF0ZUVsKCdzdHJvbmcnKTtcbiAgICAgICAgbm90aWNlVGl0bGUudGV4dENvbnRlbnQgPSAnXHVEODNEXHVERDEyIFNlY3VyaXR5IE5vdGljZTogJztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5vdGljZVRleHQgPSBzZWN1cml0eU5vdGljZS5jcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICBub3RpY2VUZXh0LnRleHRDb250ZW50ID0gJ0FQSSBrZXlzIGFyZSBlbmNyeXB0ZWQgYW5kIHN0b3JlZCBzZWN1cmVseSBieSBPYnNpZGlhbi4gTmV2ZXIgc2hhcmUgeW91ciBrZXlzIG9yIGNvbW1pdCB0aGVtIHRvIHZlcnNpb24gY29udHJvbC4nO1xuICAgICAgICBub3RpY2VUZXh0LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICBub3RpY2VUZXh0LnN0eWxlLm1hcmdpblRvcCA9ICc0cHgnO1xuICAgICAgICBub3RpY2VUZXh0LnN0eWxlLmZvbnRTaXplID0gJzAuOWVtJztcbiAgICAgICAgbm90aWNlVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG5cbiAgICAgICAgLy8gR2VtaW5pIEFQSSBLZXkgKHBhc3N3b3JkIGZpZWxkKVxuICAgICAgICBjb25zdCBnZW1pbmlTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnR2VtaW5pIEFQSSBLZXknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgR29vZ2xlIEdlbWluaSBBUEkga2V5IGZvciBjb250ZW50IHByb2Nlc3NpbmcgKHBhc3N3b3JkIGZpZWxkIC0gc2VjdXJlZCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVXNlIHBhc3N3b3JkLWxpa2UgaW5wdXRcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEVsID0gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3NrLS4uLiAoeW91ciBrZXkgaXMgZW5jcnlwdGVkKScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSB8fCAnJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKCdnZW1pbmlBcGlLZXknLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5pbnB1dEVsO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE1ha2UgaXQgcGFzc3dvcmQgZmllbGRcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCB0b2dnbGUgdG8gc2hvdy9oaWRlXG4gICAgICAgICAgICAgICAgaW5wdXRFbC5zdHlsZS5mb250RmFtaWx5ID0gJ21vbm9zcGFjZSc7XG4gICAgICAgICAgICAgICAgaW5wdXRFbC5zdHlsZS5sZXR0ZXJTcGFjaW5nID0gJzAuMWVtJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHNob3cvaGlkZSB0b2dnbGUgZm9yIEdlbWluaSBrZXlcbiAgICAgICAgdGhpcy5hZGRLZXlUb2dnbGUoZ2VtaW5pU2V0dGluZywgdGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXkpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGNsZWFyIGJ1dHRvbiBmb3IgR2VtaW5pIGtleVxuICAgICAgICB0aGlzLmFkZEtleUNsZWFyQnV0dG9uKGdlbWluaVNldHRpbmcsICdnZW1pbmlBcGlLZXknKTtcblxuICAgICAgICAvLyBHcm9xIEFQSSBLZXkgKHBhc3N3b3JkIGZpZWxkKVxuICAgICAgICBjb25zdCBncm9xU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0dyb3EgQVBJIEtleScpXG4gICAgICAgICAgICAuc2V0RGVzYygnWW91ciBHcm9xIEFQSSBrZXkgZm9yIGZhbGxiYWNrIHByb2Nlc3NpbmcgKHBhc3N3b3JkIGZpZWxkIC0gc2VjdXJlZCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgLy8gVXNlIHBhc3N3b3JkLWxpa2UgaW5wdXRcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEVsID0gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2dza18uLi4gKHlvdXIga2V5IGlzIGVuY3J5cHRlZCknKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5IHx8ICcnKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmcoJ2dyb3FBcGlLZXknLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5pbnB1dEVsO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIE1ha2UgaXQgcGFzc3dvcmQgZmllbGRcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnR5cGUgPSAncGFzc3dvcmQnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFkZCB2aXN1YWwgZmVlZGJhY2tcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnN0eWxlLmZvbnRGYW1pbHkgPSAnbW9ub3NwYWNlJztcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnN0eWxlLmxldHRlclNwYWNpbmcgPSAnMC4xZW0nO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc2hvdy9oaWRlIHRvZ2dsZSBmb3IgR3JvcSBrZXlcbiAgICAgICAgdGhpcy5hZGRLZXlUb2dnbGUoZ3JvcVNldHRpbmcsIHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY2xlYXIgYnV0dG9uIGZvciBHcm9xIGtleVxuICAgICAgICB0aGlzLmFkZEtleUNsZWFyQnV0dG9uKGdyb3FTZXR0aW5nLCAnZ3JvcUFwaUtleScpO1xuXG4gICAgICAgIC8vIFRlc3QgQ29ubmVjdGl2aXR5XG4gICAgICAgIGNvbnN0IHRlc3RTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCd5dGMtdGVzdC1jb25uZWN0aW9uJyk7XG4gICAgICAgIHRlc3RTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9ICcxNnB4JztcbiAgICAgICAgdGVzdFNlY3Rpb24uc3R5bGUucGFkZGluZ1RvcCA9ICcxMnB4JztcbiAgICAgICAgdGVzdFNlY3Rpb24uc3R5bGUuYm9yZGVyVG9wID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcodGVzdFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGVzdCBBUEkgQ29ubmVjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnVmVyaWZ5IHlvdXIgQVBJIGtleXMgYXJlIHZhbGlkJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdUZXN0IEtleXMnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYnRuLnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCgnVGVzdGluZy4uLicpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy50ZXN0QVBJS2V5cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoJ1x1MjcxMyBTdWNjZXNzIScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoJ1Rlc3QgS2V5cycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KCdcdTI3MTcgRmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnQVBJIGtleSB0ZXN0IGZhaWxlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoJ1Rlc3QgS2V5cycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgc2hvdy9oaWRlIHRvZ2dsZSBmb3Igc2Vuc2l0aXZlIEFQSSBrZXlzXG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRLZXlUb2dnbGUoc2V0dGluZzogU2V0dGluZywga2V5VmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICAvLyBBbHdheXMgYWRkIHRvZ2dsZSBidXR0b24sIGV2ZW4gaWYga2V5IGlzIGVtcHR5ICh1c2VyIG1pZ2h0IGJlIGVudGVyaW5nIGl0IG5vdylcbiAgICAgICAgY29uc3QgdG9nZ2xlQnRuID0gc2V0dGluZy5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1RDgzRFx1REM0MVx1RkUwRiBTaG93JylcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKCdUb2dnbGUga2V5IHZpc2liaWxpdHknKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dHMgPSBzZXR0aW5nLnNldHRpbmdFbC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwicGFzc3dvcmRcIl0sIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJyk7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNQYXNzd29yZCA9IGlucHV0LnR5cGUgPT09ICdwYXNzd29yZCc7XG5cbiAgICAgICAgICAgICAgICBpbnB1dC50eXBlID0gaXNQYXNzd29yZCA/ICd0ZXh0JyA6ICdwYXNzd29yZCc7XG4gICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoaXNQYXNzd29yZCA/ICdcdUQ4M0RcdURDNDFcdUZFMEZcdTIwMERcdUQ4M0RcdURERThcdUZFMEYgSGlkZScgOiAnXHVEODNEXHVEQzQxXHVGRTBGIFNob3cnKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgY2xlYXIgYnV0dG9uIHRvIHJlbW92ZSBBUEkga2V5XG4gICAgICovXG4gICAgcHJpdmF0ZSBhZGRLZXlDbGVhckJ1dHRvbihzZXR0aW5nOiBTZXR0aW5nLCBzZXR0aW5nS2V5OiAnZ2VtaW5pQXBpS2V5JyB8ICdncm9xQXBpS2V5Jyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjbGVhckJ0biA9IHNldHRpbmcuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdcdUQ4M0RcdURERDFcdUZFMEYgQ2xlYXInKVxuICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1JlbW92ZSB0aGlzIEFQSSBrZXknKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIENvbmZpcm0gYmVmb3JlIGNsZWFyaW5nXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5TmFtZSA9IHNldHRpbmdLZXkgPT09ICdnZW1pbmlBcGlLZXknID8gJ0dlbWluaScgOiAnR3JvcSc7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciB0aGUgJHtrZXlOYW1lfSBBUEkga2V5P2ApKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZyhzZXR0aW5nS2V5LCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIGRpc3BsYXkgdG8gc2hvdyBlbXB0eSBmaWVsZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdCBBUEkga2V5cyBmb3IgdmFsaWRpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHRlc3RBUElLZXlzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZ2VtaW5pQXBpS2V5KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgICAgICAgICAgICdodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzP2tleT0nICsgdGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goYEdlbWluaSBBUEkga2V5IGludmFsaWQgKCR7cmVzcG9uc2Uuc3RhdHVzfSlgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKCdHZW1pbmkgQVBJIGtleSB0ZXN0IGZhaWxlZCAobmV0d29yayBlcnJvciknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKCdHZW1pbmkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIFxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBzZWN1cml0eSBjb25maWd1cmF0aW9uIHNldHRpbmdzXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVTZWN1cml0eVNldHRpbmdzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgLy8gU2VjdXJpdHkgU2V0dGluZ3Mgc2VjdGlvblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdTZWN1cml0eSBDb25maWd1cmF0aW9uJyB9KTtcblxuICAgICAgICAvLyBVc2UgRW52aXJvbm1lbnQgVmFyaWFibGVzXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1VzZSBFbnZpcm9ubWVudCBWYXJpYWJsZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0xvYWQgQVBJIGtleXMgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgaW5zdGVhZCBvZiBzdG9yaW5nIHRoZW0gaW4gY29uZmlndXJhdGlvbicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy51c2VFbnZpcm9ubWVudFZhcmlhYmxlcyB8fCBmYWxzZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZygndXNlRW52aXJvbm1lbnRWYXJpYWJsZXMnLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBSZWZyZXNoIGRpc3BsYXkgdG8gc2hvdy9oaWRlIHJlbGV2YW50IHNldHRpbmdzXG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEVudmlyb25tZW50IFZhcmlhYmxlIFByZWZpeFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VFbnZpcm9ubWVudFZhcmlhYmxlcykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ0Vudmlyb25tZW50IFZhcmlhYmxlIFByZWZpeCcpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ1ByZWZpeCBmb3IgZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZXMgKGUuZy4sIFlUQ19HRU1JTklfQVBJX0tFWSknKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1lUQycpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzLmVudmlyb25tZW50UHJlZml4IHx8ICdZVEMnKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmcoJ2Vudmlyb25tZW50UHJlZml4JywgdmFsdWUgfHwgJ1lUQycpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIEVudmlyb25tZW50IFRlbXBsYXRlXG4gICAgICAgICAgICBjb25zdCBlbnZUZW1wbGF0ZSA9IHRoaXMuc2VjdXJlQ29uZmlnLmdldEVudmlyb25tZW50VGVtcGxhdGUoKTtcbiAgICAgICAgICAgIGNvbnN0IGVudlNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3l0Yy1lbnYtdGVtcGxhdGUnKTtcbiAgICAgICAgICAgIGVudlNlY3Rpb24uY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnRW52aXJvbm1lbnQgVmFyaWFibGVzIFRlbXBsYXRlJyB9KTtcbiAgICAgICAgICAgIGVudlNlY3Rpb24uY3JlYXRlRWwoJ3AnLCB7IFxuICAgICAgICAgICAgICAgIHRleHQ6ICdDb3B5IHRoZXNlIGVudmlyb25tZW50IHZhcmlhYmxlcyB0byB5b3VyIHNoZWxsIHByb2ZpbGU6JyxcbiAgICAgICAgICAgICAgICBjbHM6ICdzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcHJlRWwgPSBlbnZTZWN0aW9uLmNyZWF0ZUVsKCdwcmUnKTtcbiAgICAgICAgICAgIHByZUVsLmNyZWF0ZUVsKCdjb2RlJywgeyB0ZXh0OiBlbnZUZW1wbGF0ZSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ29weSBidXR0b25cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGVudlNlY3Rpb24pXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ0NvcHkgVGVtcGxhdGUnKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdDb3B5IHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdGVtcGxhdGUgdG8gY2xpcGJvYXJkJylcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0NvcHkgdG8gQ2xpcGJvYXJkJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZW52VGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ0NvcGllZCEnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gYnV0dG9uLnNldEJ1dHRvblRleHQoJ0NvcHkgdG8gQ2xpcGJvYXJkJyksIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWN1cml0eSBWYWxpZGF0aW9uXG4gICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnNlY3VyZUNvbmZpZy52YWxpZGF0ZVNlY3VyaXR5Q29uZmlndXJhdGlvbigpO1xuICAgICAgICBpZiAoIXZhbGlkYXRpb24uaXNTZWN1cmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHdhcm5pbmdFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigneXRjLXNlY3VyaXR5LXdhcm5pbmdzJyk7XG4gICAgICAgICAgICB3YXJuaW5nRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnXHUyNkEwXHVGRTBGIFNlY3VyaXR5IFdhcm5pbmdzJywgY2xzOiAneXRjLXdhcm5pbmctaGVhZGVyJyB9KTtcbiAgICAgICAgICAgIHZhbGlkYXRpb24ud2FybmluZ3MuZm9yRWFjaCh3YXJuaW5nID0+IHtcbiAgICAgICAgICAgICAgICB3YXJuaW5nRWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IHdhcm5pbmcsIGNsczogJ3l0Yy13YXJuaW5nLXRleHQnIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGZpbGUgY29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlRmlsZVNldHRpbmdzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsZSBTZXR0aW5ncyBzZWN0aW9uXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0ZpbGUgQ29uZmlndXJhdGlvbicgfSk7XG5cbiAgICAgICAgLy8gT3V0cHV0IFBhdGhcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT3V0cHV0IFBhdGgnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0RpcmVjdG9yeSBwYXRoIHdoZXJlIHByb2Nlc3NlZCB2aWRlb3Mgd2lsbCBiZSBzYXZlZCAocmVsYXRpdmUgdG8gdmF1bHQgcm9vdCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKE1FU1NBR0VTLlBMQUNFSE9MREVSUy5PVVRQVVRfUEFUSClcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5vdXRwdXRQYXRoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKCdvdXRwdXRQYXRoJywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdmFsaWRhdGlvbiBzdGF0dXMgZGlzcGxheVxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlVmFsaWRhdGlvblN0YXR1cygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRpb25FcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgICAgICBlcnJvclNlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gJzIwcHgnO1xuICAgICAgICAgICAgZXJyb3JTZWN0aW9uLnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XG4gICAgICAgICAgICBlcnJvclNlY3Rpb24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZXJyb3IpJztcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZXJyb3JTZWN0aW9uLmNyZWF0ZUVsKCdoNCcsIHsgXG4gICAgICAgICAgICAgICAgdGV4dDogJ1x1MjZBMFx1RkUwRiBDb25maWd1cmF0aW9uIElzc3VlcycsXG4gICAgICAgICAgICAgICAgYXR0cjogeyBzdHlsZTogJ2NvbG9yOiB2YXIoLS10ZXh0LWVycm9yKTsgbWFyZ2luLXRvcDogMDsnIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBlcnJvckxpc3QgPSBlcnJvclNlY3Rpb24uY3JlYXRlRWwoJ3VsJyk7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25FcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgZXJyb3JMaXN0LmNyZWF0ZUVsKCdsaScsIHsgdGV4dDogZXJyb3IgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3NTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgICAgICBzdWNjZXNzU2VjdGlvbi5zdHlsZS5tYXJnaW5Ub3AgPSAnMjBweCc7XG4gICAgICAgICAgICBzdWNjZXNzU2VjdGlvbi5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICAgICAgc3VjY2Vzc1NlY3Rpb24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItc3VjY2VzcyknO1xuICAgICAgICAgICAgc3VjY2Vzc1NlY3Rpb24uc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHN1Y2Nlc3NTZWN0aW9uLmNyZWF0ZUVsKCdoNCcsIHsgXG4gICAgICAgICAgICAgICAgdGV4dDogJ1x1MjcwNSBDb25maWd1cmF0aW9uIFZhbGlkJyxcbiAgICAgICAgICAgICAgICBhdHRyOiB7IHN0eWxlOiAnY29sb3I6IHZhcigtLXRleHQtc3VjY2Vzcyk7IG1hcmdpbi10b3A6IDA7JyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB1c2FnZSBpbnN0cnVjdGlvbnNcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVVzYWdlSW5zdHJ1Y3Rpb25zKCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnVXNhZ2UgSW5zdHJ1Y3Rpb25zJyB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGluc3RydWN0aW9ucyA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuICAgICAgICBpbnN0cnVjdGlvbnMuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgPHA+PHN0cm9uZz5Ib3cgdG8gdXNlOjwvc3Ryb25nPjwvcD5cbiAgICAgICAgICAgIDxvbD5cbiAgICAgICAgICAgICAgICA8bGk+U2V0IHlvdXIgR2VtaW5pIG9yIEdyb3EgQVBJIGtleSBhYm92ZTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPkNvbmZpZ3VyZSB5b3VyIHByZWZlcnJlZCBvdXRwdXQgZGlyZWN0b3J5PC9saT5cbiAgICAgICAgICAgICAgICA8bGk+Q2xpY2sgdGhlIHZpZGVvIGljb24gaW4gdGhlIHJpYmJvbiBvciB1c2UgdGhlIGNvbW1hbmQgcGFsZXR0ZTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPlBhc3RlIGEgWW91VHViZSBVUkwgYW5kIGFkanVzdCBwZXJmb3JtYW5jZSBzZXR0aW5ncyBpbiB0aGUgbW9kYWw8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5DbGljayBQcm9jZXNzIHRvIGFuYWx5emUgdGhlIHZpZGVvIGFuZCBjcmVhdGUgYSBzdHJ1Y3R1cmVkIG5vdGU8L2xpPlxuICAgICAgICAgICAgPC9vbD5cblxuICAgICAgICAgICAgPHA+PHN0cm9uZz5QZXJmb3JtYW5jZSBTZXR0aW5nczo8L3N0cm9uZz48L3A+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+U3BlZWQgJiBQZXJmb3JtYW5jZTo8L3N0cm9uZz4gQXZhaWxhYmxlIGRpcmVjdGx5IGluIHRoZSBVUkwgaW5wdXQgbW9kYWwgZm9yIGVhc3kgYWNjZXNzPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+PHN0cm9uZz5QZXJmb3JtYW5jZSBNb2RlOjwvc3Ryb25nPiBDaG9vc2UgYmV0d2VlbiBGYXN0LCBCYWxhbmNlZCwgb3IgUXVhbGl0eSBwcm9jZXNzaW5nPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+PHN0cm9uZz5QYXJhbGxlbCBQcm9jZXNzaW5nOjwvc3Ryb25nPiBSYWNlIG11bHRpcGxlIEFJIHByb3ZpZGVycyBmb3IgZmFzdGVyIHJlc3BvbnNlczwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+TXVsdGltb2RhbCBBbmFseXNpczo8L3N0cm9uZz4gRW5hYmxlIGF1ZGlvICsgdmlzdWFsIGFuYWx5c2lzIGZvciB2aWRlby1hd2FyZSBtb2RlbHM8L2xpPlxuICAgICAgICAgICAgPC91bD5cblxuICAgICAgICAgICAgPHA+PHN0cm9uZz5BUEkgS2V5IEluZm9ybWF0aW9uOjwvc3Ryb25nPjwvcD5cbiAgICAgICAgICAgIDx1bD5cbiAgICAgICAgICAgICAgICA8bGk+PHN0cm9uZz5HZW1pbmkgQVBJOjwvc3Ryb25nPiBHZXQgeW91ciBrZXkgZnJvbSA8YSBocmVmPVwiaHR0cHM6Ly9haXN0dWRpby5nb29nbGUuY29tL2FwcC9hcGlrZXlcIj5Hb29nbGUgQUkgU3R1ZGlvPC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+R3JvcSBBUEk6PC9zdHJvbmc+IEdldCB5b3VyIGtleSBmcm9tIDxhIGhyZWY9XCJodHRwczovL2NvbnNvbGUuZ3JvcS5jb20va2V5c1wiPkdyb3EgQ29uc29sZTwvYT48L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5BdCBsZWFzdCBvbmUgQVBJIGtleSBpcyByZXF1aXJlZCBmb3IgdGhlIHBsdWdpbiB0byBmdW5jdGlvbjwvbGk+XG4gICAgICAgICAgICA8L3VsPlxuXG4gICAgICAgICAgICA8cD48c3Ryb25nPk5vdGU6PC9zdHJvbmc+IFRoaXMgcGx1Z2luIHJlcXVpcmVzIGFuIGFjdGl2ZSBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCBhIHZhbGlkIEFQSSBrZXkuPC9wPlxuICAgICAgICAgICAgPHA+PHN0cm9uZz5MaW1pdGF0aW9uczo8L3N0cm9uZz4gRHVlIHRvIENPUlMgcmVzdHJpY3Rpb25zLCBmdWxsIHRyYW5zY3JpcHQgZXh0cmFjdGlvbiBtYXkgYmUgbGltaXRlZC4gVGhlIHBsdWdpbiB3b3JrcyB3aXRoIGF2YWlsYWJsZSBtZXRhZGF0YSBhbmQgZGVzY3JpcHRpb25zLjwvcD5cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYSBzZXR0aW5nIHZhbHVlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVTZXR0aW5nKFxuICAgICAgICBrZXk6IGtleW9mIFlvdVR1YmVQbHVnaW5TZXR0aW5ncywgXG4gICAgICAgIHZhbHVlOiBzdHJpbmcgfCBib29sZWFuXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAodGhpcy5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVBbmRTYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsIGBTZXR0aW5ncyB1cGRhdGUgZm9yICR7a2V5fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIHNhdmUgc2V0dGluZ3NcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQW5kU2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gVmFsaWRhdGlvblV0aWxzLnZhbGlkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMudmFsaWRhdGlvbkVycm9ycyA9IHZhbGlkYXRpb24uZXJyb3JzO1xuICAgICAgICBcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcHRpb25zLm9uU2V0dGluZ3NDaGFuZ2UodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlZnJlc2ggZGlzcGxheSB0byBzaG93IHZhbGlkYXRpb24gc3RhdHVzXG4gICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IHNldHRpbmdzXG4gICAgICovXG4gICAgZ2V0U2V0dGluZ3MoKTogWW91VHViZVBsdWdpblNldHRpbmdzIHtcbiAgICAgICAgcmV0dXJuIHsgLi4udGhpcy5zZXR0aW5ncyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzZXR0aW5ncyBmcm9tIGV4dGVybmFsIHNvdXJjZVxuICAgICAqL1xuICAgIHVwZGF0ZVNldHRpbmdzKG5ld1NldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHsgLi4ubmV3U2V0dGluZ3MgfTtcbiAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU2VjdXJlIGNvbmZpZ3VyYXRpb24gc2VydmljZSBmb3IgQVBJIGtleSBtYW5hZ2VtZW50XG4gKiBTdXBwb3J0cyBib3RoIGRpcmVjdCBjb25maWd1cmF0aW9uIGFuZCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAqL1xuXG5pbXBvcnQgeyBZb3VUdWJlUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFNlY3VyZUNvbmZpZ1NlcnZpY2Uge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncztcblxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBBUEkga2V5IHdpdGggZW52aXJvbm1lbnQgdmFyaWFibGUgZmFsbGJhY2tcbiAgICAgKi9cbiAgICBnZXRBcGlLZXkoa2V5VHlwZTogJ2dlbWluaScgfCAnZ3JvcScpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VFbnZpcm9ubWVudFZhcmlhYmxlcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnJvbUVudmlyb25tZW50KGtleVR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ga2V5VHlwZSA9PT0gJ2dlbWluaScgPyB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSA6IHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgQVBJIGtleSBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0RnJvbUVudmlyb25tZW50KGtleVR5cGU6ICdnZW1pbmknIHwgJ2dyb3EnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5zZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCB8fCAnWVRDJztcbiAgICAgICAgY29uc3QgZW52VmFyTmFtZSA9IGAke3ByZWZpeH1fJHtrZXlUeXBlLnRvVXBwZXJDYXNlKCl9X0FQSV9LRVlgO1xuICAgICAgICBcbiAgICAgICAgLy8gSW4gYnJvd3NlciBlbnZpcm9ubWVudCwgd2UgY2FuIG9ubHkgYWNjZXNzIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAgICAvLyB0aGF0IHdlcmUgc2V0IGR1cmluZyBidWlsZCB0aW1lIG9yIHRocm91Z2ggYSBzZWN1cmUgY29uZmlndXJhdGlvbiBzZXJ2aWNlXG4gICAgICAgIHJldHVybiB0aGlzLmdldFNlY3VyZUVudlZhcihlbnZWYXJOYW1lKSB8fCAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWN1cmUgZW52aXJvbm1lbnQgdmFyaWFibGUgYWNjZXNzXG4gICAgICogTm90ZTogSW4gT2JzaWRpYW4gcGx1Z2lucywgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBsaW1pdGVkXG4gICAgICogVGhpcyBtZXRob2QgY2FuIGJlIGV4dGVuZGVkIGZvciBzZXJ2ZXItc2lkZSBlbnZpcm9ubWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFNlY3VyZUVudlZhcih2YXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICAvLyBGb3IgT2JzaWRpYW4gcGx1Z2luIGVudmlyb25tZW50LCB3ZSBtaWdodCBuZWVkIHRvIHVzZSBhIGRpZmZlcmVudCBhcHByb2FjaFxuICAgICAgICAvLyBzdWNoIGFzIHJlYWRpbmcgZnJvbSBhIHNlY3VyZSBjb25maWd1cmF0aW9uIGZpbGUgb3Igc2VydmljZVxuICAgICAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52KSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzcy5lbnZbdmFyTmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZvciBicm93c2VyL09ic2lkaWFuIGVudmlyb25tZW50LCBpbXBsZW1lbnQgc2VjdXJlIHN0b3JhZ2UgYWNjZXNzXG4gICAgICAgIHJldHVybiB0aGlzLmdldEZyb21TZWN1cmVTdG9yYWdlKHZhck5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmcm9tIHNlY3VyZSBzdG9yYWdlIChpbXBsZW1lbnRhdGlvbiBkZXBlbmRzIG9uIGVudmlyb25tZW50KVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0RnJvbVNlY3VyZVN0b3JhZ2UodmFyTmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBpbXBsZW1lbnRlZCB0byByZWFkIGZyb206XG4gICAgICAgIC8vIC0gRW5jcnlwdGVkIGxvY2FsIHN0b3JhZ2VcbiAgICAgICAgLy8gLSBTeXN0ZW0ga2V5Y2hhaW5cbiAgICAgICAgLy8gLSBTZWN1cmUgY29uZmlndXJhdGlvbiBzZXJ2aWNlXG4gICAgICAgIC8vIEZvciBub3csIHJldHVybiB1bmRlZmluZWQgdG8gZmFsbCBiYWNrIHRvIGRpcmVjdCBjb25maWd1cmF0aW9uXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgY29uZmlndXJhdGlvbiBzZWN1cml0eVxuICAgICAqL1xuICAgIHZhbGlkYXRlU2VjdXJpdHlDb25maWd1cmF0aW9uKCk6IHsgaXNTZWN1cmU6IGJvb2xlYW47IHdhcm5pbmdzOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBpc1NlY3VyZSA9IHRydWU7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgQVBJIGtleXMgYXJlIHN0b3JlZCBkaXJlY3RseSBhbmQgd2FyblxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MudXNlRW52aXJvbm1lbnRWYXJpYWJsZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSAmJiB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgd2FybmluZ3MucHVzaCgnR2VtaW5pIEFQSSBrZXkgaXMgc3RvcmVkIGRpcmVjdGx5IGluIGNvbmZpZ3VyYXRpb24uIENvbnNpZGVyIHVzaW5nIGVudmlyb25tZW50IHZhcmlhYmxlcy4nKTtcbiAgICAgICAgICAgICAgICBpc1NlY3VyZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleSAmJiB0aGlzLnNldHRpbmdzLmdyb3FBcGlLZXkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goJ0dyb3EgQVBJIGtleSBpcyBzdG9yZWQgZGlyZWN0bHkgaW4gY29uZmlndXJhdGlvbi4gQ29uc2lkZXIgdXNpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzLicpO1xuICAgICAgICAgICAgICAgIGlzU2VjdXJlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBmb3Igd2VhayBBUEkga2V5c1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXkgPT09ICd5b3VyLWFwaS1rZXktaGVyZScgfHwgdGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5ID09PSAneW91ci1hcGkta2V5LWhlcmUnKSB7XG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKCdEZWZhdWx0IHBsYWNlaG9sZGVyIEFQSSBrZXlzIGRldGVjdGVkLiBQbGVhc2Ugc2V0IHJlYWwgQVBJIGtleXMuJyk7XG4gICAgICAgICAgICBpc1NlY3VyZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgaXNTZWN1cmUsIHdhcm5pbmdzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbmZpZ3VyYXRpb24gdGVtcGxhdGUgZm9yIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAqL1xuICAgIGdldEVudmlyb25tZW50VGVtcGxhdGUoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5zZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCB8fCAnWVRDJztcbiAgICAgICAgcmV0dXJuIGAjIFlvdVR1YmVDbGlwcGVyIEVudmlyb25tZW50IFZhcmlhYmxlc1xuIyBTZXQgdGhlc2UgaW4geW91ciBlbnZpcm9ubWVudCBmb3Igc2VjdXJlIEFQSSBrZXkgbWFuYWdlbWVudFxuXG4jIEdvb2dsZSBHZW1pbmkgQVBJIEtleVxuJHtwcmVmaXh9X0dFTUlOSV9BUElfS0VZPXlvdXJfZ2VtaW5pX2FwaV9rZXlfaGVyZVxuXG4jIEdyb3EgQVBJIEtleSAgXG4ke3ByZWZpeH1fR1JPUV9BUElfS0VZPXlvdXJfZ3JvcV9hcGlfa2V5X2hlcmVcblxuIyBVc2FnZTpcbiMgMS4gU2V0IHRoZXNlIHZhcmlhYmxlcyBpbiB5b3VyIHNoZWxsIHByb2ZpbGUgKC5iYXNocmMsIC56c2hyYywgZXRjLilcbiMgMi4gRW5hYmxlIFwiVXNlIEVudmlyb25tZW50IFZhcmlhYmxlc1wiIGluIHBsdWdpbiBzZXR0aW5nc1xuIyAzLiBSZXN0YXJ0IE9ic2lkaWFuIHRvIHBpY2sgdXAgdGhlIG5ldyBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbmA7XG4gICAgfVxufSIsICIvKipcbiAqIEFJIHNlcnZpY2UgdGhhdCBtYW5hZ2VzIG11bHRpcGxlIHByb3ZpZGVycyB3aXRoIHBhcmFsbGVsIHByb2Nlc3Npbmcgc3VwcG9ydFxuICovXG5cbmltcG9ydCB7IEFJU2VydmljZSBhcyBJQUlTZXJ2aWNlLCBBSVByb3ZpZGVyLCBBSVJlc3BvbnNlLCBZb3VUdWJlUGx1Z2luU2V0dGluZ3MsIFBlcmZvcm1hbmNlTW9kZSB9IGZyb20gJy4uL3R5cGVzL3R5cGVzJztcbmltcG9ydCB7IFBST1ZJREVSX01PREVMX09QVElPTlMsIFBST1ZJREVSX01PREVMX0xJU1RfVVJMUywgUFJPVklERVJfTU9ERUxfUkVHRVggfSBmcm9tICcuLi9hcGknO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi4vbWVzc2FnZXMnO1xuaW1wb3J0IHsgUEVSRk9STUFOQ0VfUFJFU0VUUywgUGVyZm9ybWFuY2VPcHRpbWl6ZXIgfSBmcm9tICcuLi9wZXJmb3JtYW5jZSc7XG5cbmV4cG9ydCBjbGFzcyBBSVNlcnZpY2UgaW1wbGVtZW50cyBJQUlTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHByb3ZpZGVyczogQUlQcm92aWRlcltdID0gW107XG4gICAgcHJpdmF0ZSBzZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzO1xuXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJzOiBBSVByb3ZpZGVyW10sIHNldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpIHtcbiAgICAgICAgaWYgKCFwcm92aWRlcnMgfHwgcHJvdmlkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5NSVNTSU5HX0FQSV9LRVlTKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3ZpZGVycyA9IHByb3ZpZGVycztcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLmFwcGx5UGVyZm9ybWFuY2VTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHBlcmZvcm1hbmNlIHNldHRpbmdzIHRvIHByb3ZpZGVyc1xuICAgICAqL1xuICAgIHByaXZhdGUgYXBwbHlQZXJmb3JtYW5jZVNldHRpbmdzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmVzZXQgPSBQRVJGT1JNQU5DRV9QUkVTRVRTW3RoaXMuc2V0dGluZ3MucGVyZm9ybWFuY2VNb2RlXSB8fCBQRVJGT1JNQU5DRV9QUkVTRVRTLmJhbGFuY2VkO1xuICAgICAgICBjb25zdCB0aW1lb3V0cyA9IHRoaXMuc2V0dGluZ3MuY3VzdG9tVGltZW91dHMgfHwgcHJlc2V0LnRpbWVvdXRzO1xuXG4gICAgICAgIHRoaXMucHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4ge1xuICAgICAgICAgICAgaWYgKHByb3ZpZGVyLm5hbWUgPT09ICdHb29nbGUgR2VtaW5pJyAmJiBwcm92aWRlci5zZXRUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXIuc2V0VGltZW91dCh0aW1lb3V0cy5nZW1pbmlUaW1lb3V0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvdmlkZXIubmFtZSA9PT0gJ0dyb3EnICYmIHByb3ZpZGVyLnNldFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICBwcm92aWRlci5zZXRUaW1lb3V0KHRpbWVvdXRzLmdyb3FUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNldHRpbmdzIGFuZCByZWFwcGx5IHBlcmZvcm1hbmNlIGNvbmZpZ3VyYXRpb25zXG4gICAgICovXG4gICAgdXBkYXRlU2V0dGluZ3MobmV3U2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyk6IHZvaWQge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gbmV3U2V0dGluZ3M7XG4gICAgICAgIHRoaXMuYXBwbHlQZXJmb3JtYW5jZVNldHRpbmdzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGF2YWlsYWJsZSBtb2RlbCBvcHRpb25zIGZvciBhIHByb3ZpZGVyIG5hbWUgKGZyb20gY29uc3RhbnRzIG1hcHBpbmcpXG4gICAgICovXG4gICAgZ2V0UHJvdmlkZXJNb2RlbHMocHJvdmlkZXJOYW1lOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHJhdyA9IFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSB8fCBbXSBhcyBhbnlbXTtcbiAgICAgICAgLy8gU3VwcG9ydCBib3RoIGxlZ2FjeSBzdHJpbmcgYXJyYXlzIGFuZCB0aGUgbmV3IG9iamVjdCBzaGFwZSAoUHJvdmlkZXJNb2RlbEVudHJ5KVxuICAgICAgICByZXR1cm4gcmF3Lm1hcChyID0+IHR5cGVvZiByID09PSAnc3RyaW5nJyA/IHIgOiAociAmJiByLm5hbWUgPyByLm5hbWUgOiBTdHJpbmcocikpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCZXN0LWVmZm9ydCBmZXRjaCBvZiBsYXRlc3QgbW9kZWxzIGZvciBhbGwgcHJvdmlkZXJzIGJ5IHNjcmFwaW5nIGtub3duIHByb3ZpZGVyIHBhZ2VzLlxuICAgICAqIFJldHVybnMgYSBtYXBwaW5nIHByb3ZpZGVyTmFtZSAtPiBsaXN0IG9mIGRpc2NvdmVyZWQgbW9kZWxzLiBGYWxscyBiYWNrIHRvIHN0YXRpYyBtYXBwaW5nLlxuICAgICAqL1xuICAgIGFzeW5jIGZldGNoTGF0ZXN0TW9kZWxzKCk6IFByb21pc2U8UmVjb3JkPHN0cmluZywgc3RyaW5nW10+PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge307XG4gICAgICAgIGNvbnN0IHByb3ZpZGVycyA9IHRoaXMuZ2V0UHJvdmlkZXJOYW1lcygpO1xuICAgICAgICBmb3IgKGNvbnN0IHAgb2YgcHJvdmlkZXJzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IHRoaXMuZmV0Y2hMYXRlc3RNb2RlbHNGb3JQcm92aWRlcihwKTtcbiAgICAgICAgICAgICAgICByZXN1bHRbcF0gPSBtb2RlbHMubGVuZ3RoID4gMCA/IG1vZGVscyA6IChQUk9WSURFUl9NT0RFTF9PUFRJT05TW3BdID8gKFBST1ZJREVSX01PREVMX09QVElPTlNbcF0gYXMgYW55W10pLm1hcChtID0+IHR5cGVvZiBtID09PSAnc3RyaW5nJyA/IG0gOiBtLm5hbWUpIDogW10pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcF0gPSBQUk9WSURFUl9NT0RFTF9PUFRJT05TW3BdID8gKFBST1ZJREVSX01PREVMX09QVElPTlNbcF0gYXMgYW55W10pLm1hcChtID0+IHR5cGVvZiBtID09PSAnc3RyaW5nJyA/IG0gOiBtLm5hbWUpIDogW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaCBsYXRlc3QgbW9kZWxzIGZvciBhIHNpbmdsZSBwcm92aWRlciAoYmVzdC1lZmZvcnQgc2NyYXBpbmcpLlxuICAgICAqL1xuICAgIGFzeW5jIGZldGNoTGF0ZXN0TW9kZWxzRm9yUHJvdmlkZXIocHJvdmlkZXJOYW1lOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IFBST1ZJREVSX01PREVMX0xJU1RfVVJMU1twcm92aWRlck5hbWVdO1xuICAgICAgICBjb25zdCByZWdleCA9IFBST1ZJREVSX01PREVMX1JFR0VYW3Byb3ZpZGVyTmFtZV07XG4gICAgICAgIGlmICghdXJsIHx8ICFyZWdleCkge1xuICAgICAgICAgICAgcmV0dXJuIFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSA/IChQUk9WSURFUl9NT0RFTF9PUFRJT05TW3Byb3ZpZGVyTmFtZV0gYXMgYW55W10pLm1hcChtID0+IHR5cGVvZiBtID09PSAnc3RyaW5nJyA/IG0gOiBtLm5hbWUpIDogW107XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKHVybCwgeyBtZXRob2Q6ICdHRVQnIH0pO1xuICAgICAgICAgICAgaWYgKCFyZXNwLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSA/IChQUk9WSURFUl9NT0RFTF9PUFRJT05TW3Byb3ZpZGVyTmFtZV0gYXMgYW55W10pLm1hcChtID0+IHR5cGVvZiBtID09PSAnc3RyaW5nJyA/IG0gOiBtLm5hbWUpIDogW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcC50ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGV4dC5tYXRjaChyZWdleCkgfHwgW107XG4gICAgICAgICAgICAvLyBOb3JtYWxpemUgYW5kIGRlZHVwZVxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IEFycmF5LmZyb20obmV3IFNldChtYXRjaGVzLm1hcChtID0+IG0udG9Mb3dlckNhc2UoKSkpKTtcbiAgICAgICAgICAgIHJldHVybiBub3JtYWxpemVkO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gT24gYW55IGVycm9yLCByZXR1cm4gc3RhdGljIGZhbGxiYWNrXG4gICAgICAgICAgICByZXR1cm4gUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdID8gKFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSBhcyBhbnlbXSkubWFwKG0gPT4gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IG0ubmFtZSkgOiBbXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcHJvbXB0IHdpdGggZmFsbGJhY2sgc3VwcG9ydCAob3JpZ2luYWwgc2VxdWVudGlhbCBtZXRob2QpXG4gICAgICovXG4gICAgYXN5bmMgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8QUlSZXNwb25zZT4ge1xuICAgICAgICBpZiAoIXByb21wdCB8fCB0eXBlb2YgcHJvbXB0ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWYWxpZCBwcm9tcHQgaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVzZSBwYXJhbGxlbCBwcm9jZXNzaW5nIGlmIGVuYWJsZWRcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzUGFyYWxsZWwocHJvbXB0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NTZXF1ZW50aWFsKHByb21wdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBwcm9tcHQgd2l0aCBzZXF1ZW50aWFsIGZhbGxiYWNrIChvcmlnaW5hbCBtZXRob2QpXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzU2VxdWVudGlhbChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8QUlSZXNwb25zZT4ge1xuICAgICAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgIC8vIFRyeSBlYWNoIHByb3ZpZGVyIGluIG9yZGVyXG4gICAgICAgIGZvciAoY29uc3QgcHJvdmlkZXIgb2YgdGhpcy5wcm92aWRlcnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEF0dGVtcHRpbmcgdG8gcHJvY2VzcyB3aXRoICR7cHJvdmlkZXIubmFtZX0uLi5gKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcHJvdmlkZXIucHJvY2Vzcyhwcm9tcHQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC50cmltKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiBwcm92aWRlci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHByb3ZpZGVyLm1vZGVsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbXB0eSByZXNwb25zZSBmcm9tIEFJIHByb3ZpZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvcjtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYCR7cHJvdmlkZXIubmFtZX0gZmFpbGVkOmAsIGVycm9yKTtcblxuICAgICAgICAgICAgICAgIC8vIENvbnRpbnVlIHRvIG5leHQgcHJvdmlkZXIgdW5sZXNzIHRoaXMgaXMgdGhlIGxhc3Qgb25lXG4gICAgICAgICAgICAgICAgaWYgKHByb3ZpZGVyID09PSB0aGlzLnByb3ZpZGVyc1t0aGlzLnByb3ZpZGVycy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGwgcHJvdmlkZXJzIGZhaWxlZFxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBsYXN0RXJyb3JcbiAgICAgICAgICAgID8gTUVTU0FHRVMuRVJST1JTLkFJX1BST0NFU1NJTkcobGFzdEVycm9yLm1lc3NhZ2UpXG4gICAgICAgICAgICA6ICdBbGwgQUkgcHJvdmlkZXJzIGZhaWxlZCB0byBwcm9jZXNzIHRoZSByZXF1ZXN0JztcblxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHByb21wdCB3aXRoIHBhcmFsbGVsIHByb3ZpZGVyIHJhY2luZyBmb3IgbWF4aW11bSBzcGVlZFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1BhcmFsbGVsKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxBSVJlc3BvbnNlPiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTdGFydGluZyBwYXJhbGxlbCBwcm92aWRlciByYWNpbmcuLi4nKTtcblxuICAgICAgICBjb25zdCBwcm92aWRlclByb21pc2VzID0gdGhpcy5wcm92aWRlcnMubWFwKGFzeW5jIChwcm92aWRlcikgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgKHByb3ZpZGVyIGFzIGFueSkucHJvY2Vzc1dpdGhUaW1lb3V0KHByb21wdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogcHJvdmlkZXIubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbXB0eSByZXNwb25zZSBmcm9tIEFJIHByb3ZpZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYCR7cHJvdmlkZXIubmFtZX0gZmFpbGVkIGluIHBhcmFsbGVsIHJhY2U6YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiBwcm92aWRlci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogcHJvdmlkZXIubW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZVRpbWU6IERhdGUubm93KClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXYWl0IGZvciBmaXJzdCBzdWNjZXNzZnVsIHJlc3BvbnNlIG9yIGFsbCB0byBjb21wbGV0ZVxuICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHByb3ZpZGVyUHJvbWlzZXMpO1xuXG4gICAgICAgIC8vIEZpbmQgZmlyc3Qgc3VjY2Vzc2Z1bCByZXNwb25zZVxuICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRzKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgJiYgcmVzdWx0LnZhbHVlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUGFyYWxsZWwgd2lubmVyOiAke3Jlc3VsdC52YWx1ZS5wcm92aWRlcn0gKCR7RGF0ZS5ub3coKSAtIHJlc3VsdC52YWx1ZS5yZXNwb25zZVRpbWV9bXMpYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogcmVzdWx0LnZhbHVlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiByZXN1bHQudmFsdWUucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiByZXN1bHQudmFsdWUubW9kZWxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWxsIHByb3ZpZGVycyBmYWlsZWQgLSBjb2xsZWN0IGVycm9yc1xuICAgICAgICBjb25zdCBlcnJvcnMgPSByZXN1bHRzXG4gICAgICAgICAgICAuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdmdWxmaWxsZWQnICYmICFyLnZhbHVlLnN1Y2Nlc3MpXG4gICAgICAgICAgICAubWFwKHIgPT4gKHIgYXMgYW55KS52YWx1ZS5lcnJvcik7XG5cbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3JzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgID8gTUVTU0FHRVMuRVJST1JTLkFJX1BST0NFU1NJTkcoZXJyb3JzLmpvaW4oJzsgJykpXG4gICAgICAgICAgICA6ICdBbGwgQUkgcHJvdmlkZXJzIGZhaWxlZCB0byBwcm9jZXNzIHRoZSByZXF1ZXN0JztcblxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHByb21wdCB1c2luZyBhIHNwZWNpZmljIHByb3ZpZGVyIG5hbWUuIE9wdGlvbmFsbHkgb3ZlcnJpZGUgdGhlIG1vZGVsIGlmIHN1cHBvcnRlZC5cbiAgICAgKi9cbiAgICBhc3luYyBwcm9jZXNzV2l0aChwcm92aWRlck5hbWU6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcsIG92ZXJyaWRlTW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLnByb3ZpZGVycy5maW5kKHAgPT4gcC5uYW1lID09PSBwcm92aWRlck5hbWUpO1xuICAgICAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFJIHByb3ZpZGVyIG5vdCBmb3VuZDogJHtwcm92aWRlck5hbWV9YCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBwcm92aWRlciBzdXBwb3J0cyBzZXRNb2RlbCwgYXBwbHkgb3ZlcnJpZGVcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChvdmVycmlkZU1vZGVsICYmIHR5cGVvZiAocHJvdmlkZXIgYXMgYW55KS5zZXRNb2RlbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIChwcm92aWRlciBhcyBhbnkpLnNldE1vZGVsKG92ZXJyaWRlTW9kZWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcHJvdmlkZXIucHJvY2Vzcyhwcm9tcHQpO1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC50cmltKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGNvbnRlbnQsIHByb3ZpZGVyOiBwcm92aWRlci5uYW1lLCBtb2RlbDogcHJvdmlkZXIubW9kZWwgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbXB0eSByZXNwb25zZSBmcm9tIEFJIHByb3ZpZGVyJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLkFJX1BST0NFU1NJTkcoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhbnkgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGVcbiAgICAgKi9cbiAgICBoYXNBdmFpbGFibGVQcm92aWRlcnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVycy5sZW5ndGggPiAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaXN0IG9mIGF2YWlsYWJsZSBwcm92aWRlciBuYW1lc1xuICAgICAqL1xuICAgIGdldFByb3ZpZGVyTmFtZXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm92aWRlcnMubWFwKHAgPT4gcC5uYW1lKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBuZXcgcHJvdmlkZXJcbiAgICAgKi9cbiAgICBhZGRQcm92aWRlcihwcm92aWRlcjogQUlQcm92aWRlcik6IHZvaWQge1xuICAgICAgICB0aGlzLnByb3ZpZGVycy5wdXNoKHByb3ZpZGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBwcm92aWRlciBieSBuYW1lXG4gICAgICovXG4gICAgcmVtb3ZlUHJvdmlkZXIocHJvdmlkZXJOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnByb3ZpZGVycy5maW5kSW5kZXgocCA9PiBwLm5hbWUgPT09IHByb3ZpZGVyTmFtZSk7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuIiwgIi8qKlxuICogUGVyZm9ybWFuY2UgcHJlc2V0cyBhbmQgc3BlZWQvcXVhbGl0eSBjb25maWd1cmF0aW9uc1xuICovXG5cbmltcG9ydCB7IFBlcmZvcm1hbmNlUHJlc2V0LCBNb2RlbFN0cmF0ZWd5LCBDdXN0b21UaW1lb3V0U2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IFBFUkZPUk1BTkNFX1BSRVNFVFM6IFJlY29yZDxzdHJpbmcsIFBlcmZvcm1hbmNlUHJlc2V0PiA9IHtcbiAgICBmYXN0OiB7XG4gICAgICAgIG5hbWU6ICdGYXN0JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdNYXhpbXVtIHNwZWVkIHdpdGggb3B0aW1pemVkIG1vZGVscyBhbmQgcGFyYWxsZWwgcHJvY2Vzc2luZy4gQmVzdCBmb3IgcXVpY2sgc3VtbWFyaWVzLicsXG4gICAgICAgIHRpbWVvdXRzOiB7XG4gICAgICAgICAgICBnZW1pbmlUaW1lb3V0OiAxNTAwMCxcbiAgICAgICAgICAgIGdyb3FUaW1lb3V0OiAxMDAwMCxcbiAgICAgICAgICAgIG1ldGFkYXRhVGltZW91dDogNTAwMFxuICAgICAgICB9LFxuICAgICAgICBlbmFibGVQYXJhbGxlbDogdHJ1ZSxcbiAgICAgICAgcHJlZmVyTXVsdGltb2RhbDogZmFsc2UsXG4gICAgICAgIG1vZGVsU3RyYXRlZ3k6IHtcbiAgICAgICAgICAgIGJyaWVmRm9ybWF0OiAnbGxhbWEtMy4xLThiLWluc3RhbnQnLFxuICAgICAgICAgICAgZXhlY3V0aXZlU3VtbWFyeTogJ2xsYW1hLTMuMy03MGItdmVyc2F0aWxlJyxcbiAgICAgICAgICAgIGRldGFpbGVkR3VpZGU6ICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnLFxuICAgICAgICAgICAgZmFsbGJhY2tNb2RlbDogJ2xsYW1hLTMuMS04Yi1pbnN0YW50J1xuICAgICAgICB9XG4gICAgfSxcbiAgICBiYWxhbmNlZDoge1xuICAgICAgICBuYW1lOiAnQmFsYW5jZWQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0JhbGFuY2VkIHNwZWVkIGFuZCBxdWFsaXR5IHdpdGggbXVsdGltb2RhbCBhbmFseXNpcyBmb3IgZGV0YWlsZWQgY29udGVudC4nLFxuICAgICAgICB0aW1lb3V0czoge1xuICAgICAgICAgICAgZ2VtaW5pVGltZW91dDogMzAwMDAsXG4gICAgICAgICAgICBncm9xVGltZW91dDogMjAwMDAsXG4gICAgICAgICAgICBtZXRhZGF0YVRpbWVvdXQ6IDEwMDAwXG4gICAgICAgIH0sXG4gICAgICAgIGVuYWJsZVBhcmFsbGVsOiB0cnVlLFxuICAgICAgICBwcmVmZXJNdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBtb2RlbFN0cmF0ZWd5OiB7XG4gICAgICAgICAgICBicmllZkZvcm1hdDogJ2xsYW1hLTMuMS04Yi1pbnN0YW50JyxcbiAgICAgICAgICAgIGV4ZWN1dGl2ZVN1bW1hcnk6ICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnLFxuICAgICAgICAgICAgZGV0YWlsZWRHdWlkZTogJ2dlbWluaS0yLjUtZmxhc2gnLFxuICAgICAgICAgICAgZmFsbGJhY2tNb2RlbDogJ2xsYW1hLTMuMy03MGItdmVyc2F0aWxlJ1xuICAgICAgICB9XG4gICAgfSxcbiAgICBxdWFsaXR5OiB7XG4gICAgICAgIG5hbWU6ICdRdWFsaXR5JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdNYXhpbXVtIHF1YWxpdHkgd2l0aCBjb21wcmVoZW5zaXZlIG11bHRpbW9kYWwgYW5hbHlzaXMuIFNsb3dlciBidXQgbW9zdCBkZXRhaWxlZC4nLFxuICAgICAgICB0aW1lb3V0czoge1xuICAgICAgICAgICAgZ2VtaW5pVGltZW91dDogNjAwMDAsXG4gICAgICAgICAgICBncm9xVGltZW91dDogMzAwMDAsXG4gICAgICAgICAgICBtZXRhZGF0YVRpbWVvdXQ6IDE1MDAwXG4gICAgICAgIH0sXG4gICAgICAgIGVuYWJsZVBhcmFsbGVsOiBmYWxzZSxcbiAgICAgICAgcHJlZmVyTXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgbW9kZWxTdHJhdGVneToge1xuICAgICAgICAgICAgYnJpZWZGb3JtYXQ6ICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnLFxuICAgICAgICAgICAgZXhlY3V0aXZlU3VtbWFyeTogJ2dlbWluaS0yLjUtZmxhc2gnLFxuICAgICAgICAgICAgZGV0YWlsZWRHdWlkZTogJ2dlbWluaS0yLjUtcHJvJyxcbiAgICAgICAgICAgIGZhbGxiYWNrTW9kZWw6ICdnZW1pbmktMi4wLWZsYXNoJ1xuICAgICAgICB9XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfVElNRU9VVFM6IEN1c3RvbVRpbWVvdXRTZXR0aW5ncyA9IHtcbiAgICBnZW1pbmlUaW1lb3V0OiAzMDAwMCxcbiAgICBncm9xVGltZW91dDogMjAwMDAsXG4gICAgbWV0YWRhdGFUaW1lb3V0OiAxMDAwMFxufTtcblxuZXhwb3J0IGNvbnN0IE1PREVMX0NIQVJBQ1RFUklTVElDUzogUmVjb3JkPHN0cmluZywge1xuICAgIHNwZWVkOiAnZmFzdCcgfCAnbWVkaXVtJyB8ICdzbG93JztcbiAgICBxdWFsaXR5OiAnYmFzaWMnIHwgJ2dvb2QnIHwgJ2V4Y2VsbGVudCc7XG4gICAgbXVsdGltb2RhbDogYm9vbGVhbjtcbiAgICBwcm92aWRlcjogc3RyaW5nO1xuICAgIGVzdGltYXRlZExhdGVuY3k6IG51bWJlcjsgLy8gaW4gc2Vjb25kc1xuICAgIG1heFRva2VuczogbnVtYmVyO1xufT4gPSB7XG4gICAgLy8gR3JvcSBNb2RlbHMgKFNwZWVkIG9wdGltaXplZClcbiAgICAnbGxhbWEtMy4xLThiLWluc3RhbnQnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdiYXNpYycsXG4gICAgICAgIG11bHRpbW9kYWw6IGZhbHNlLFxuICAgICAgICBwcm92aWRlcjogJ0dyb3EnLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAyLFxuICAgICAgICBtYXhUb2tlbnM6IDIwMDBcbiAgICB9LFxuICAgICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZSc6IHtcbiAgICAgICAgc3BlZWQ6ICdmYXN0JyxcbiAgICAgICAgcXVhbGl0eTogJ2dvb2QnLFxuICAgICAgICBtdWx0aW1vZGFsOiBmYWxzZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHcm9xJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogNSxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnbGxhbWEtNC1tYXZlcmljay0xN2ItMTI4ZS1pbnN0cnVjdCc6IHtcbiAgICAgICAgc3BlZWQ6ICdmYXN0JyxcbiAgICAgICAgcXVhbGl0eTogJ2V4Y2VsbGVudCcsXG4gICAgICAgIG11bHRpbW9kYWw6IGZhbHNlLFxuICAgICAgICBwcm92aWRlcjogJ0dyb3EnLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiA4LFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdsbGFtYS00LXNjb3V0LTE3Yi0xNmUtaW5zdHJ1Y3QnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdnb29kJyxcbiAgICAgICAgbXVsdGltb2RhbDogZmFsc2UsXG4gICAgICAgIHByb3ZpZGVyOiAnR3JvcScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDYsXG4gICAgICAgIG1heFRva2VuczogNDAwMFxuICAgIH0sXG5cbiAgICAvLyBHZW1pbmkgRmxhc2ggTW9kZWxzIChCYWxhbmNlZClcbiAgICAnZ2VtaW5pLTIuMC1mbGFzaCc6IHtcbiAgICAgICAgc3BlZWQ6ICdtZWRpdW0nLFxuICAgICAgICBxdWFsaXR5OiAnZ29vZCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDEwLFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdnZW1pbmktMi4wLWZsYXNoLWxpdGUnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdnb29kJyxcbiAgICAgICAgbXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHb29nbGUgR2VtaW5pJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogNixcbiAgICAgICAgbWF4VG9rZW5zOiAzMDAwXG4gICAgfSxcbiAgICAnZ2VtaW5pLTIuNS1mbGFzaCc6IHtcbiAgICAgICAgc3BlZWQ6ICdtZWRpdW0nLFxuICAgICAgICBxdWFsaXR5OiAnZXhjZWxsZW50JyxcbiAgICAgICAgbXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHb29nbGUgR2VtaW5pJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogMTIsXG4gICAgICAgIG1heFRva2VuczogNDAwMFxuICAgIH0sXG4gICAgJ2dlbWluaS0yLjUtZmxhc2gtbGl0ZSc6IHtcbiAgICAgICAgc3BlZWQ6ICdmYXN0JyxcbiAgICAgICAgcXVhbGl0eTogJ2dvb2QnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiA4LFxuICAgICAgICBtYXhUb2tlbnM6IDMwMDBcbiAgICB9LFxuXG4gICAgLy8gR2VtaW5pIFBybyBNb2RlbHMgKFF1YWxpdHkgb3B0aW1pemVkKVxuICAgICdnZW1pbmktMS41LXBybyc6IHtcbiAgICAgICAgc3BlZWQ6ICdzbG93JyxcbiAgICAgICAgcXVhbGl0eTogJ2V4Y2VsbGVudCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDIwLFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdnZW1pbmktMi4wLXBybyc6IHtcbiAgICAgICAgc3BlZWQ6ICdzbG93JyxcbiAgICAgICAgcXVhbGl0eTogJ2V4Y2VsbGVudCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDI1LFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdnZW1pbmktMi41LXBybyc6IHtcbiAgICAgICAgc3BlZWQ6ICdzbG93JyxcbiAgICAgICAgcXVhbGl0eTogJ2V4Y2VsbGVudCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDMwLFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdnZW1pbmktMi41LXByby10dHMnOiB7XG4gICAgICAgIHNwZWVkOiAnc2xvdycsXG4gICAgICAgIHF1YWxpdHk6ICdleGNlbGxlbnQnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAzNSxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfVxufTtcblxuZXhwb3J0IGNsYXNzIFBlcmZvcm1hbmNlT3B0aW1pemVyIHtcbiAgICBzdGF0aWMgZ2V0T3B0aW1hbE1vZGVsKFxuICAgICAgICBmb3JtYXQ6IHN0cmluZyxcbiAgICAgICAgdmlkZW9EdXJhdGlvbj86IG51bWJlcixcbiAgICAgICAgcGVyZm9ybWFuY2VNb2RlOiBzdHJpbmcgPSAnYmFsYW5jZWQnLFxuICAgICAgICBhdmFpbGFibGVNb2RlbHM6IHN0cmluZ1tdID0gW11cbiAgICApOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwcmVzZXQgPSBQRVJGT1JNQU5DRV9QUkVTRVRTW3BlcmZvcm1hbmNlTW9kZV0gfHwgUEVSRk9STUFOQ0VfUFJFU0VUUy5iYWxhbmNlZDtcbiAgICAgICAgY29uc3Qgc3RyYXRlZ3kgPSBwcmVzZXQubW9kZWxTdHJhdGVneTtcblxuICAgICAgICAvLyBTZWxlY3QgbW9kZWwgYmFzZWQgb24gZm9ybWF0XG4gICAgICAgIGxldCBzZWxlY3RlZE1vZGVsID0gc3RyYXRlZ3kuZmFsbGJhY2tNb2RlbDtcblxuICAgICAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgICAgICAgY2FzZSAnYnJpZWYnOlxuICAgICAgICAgICAgICAgIHNlbGVjdGVkTW9kZWwgPSBzdHJhdGVneS5icmllZkZvcm1hdDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2V4ZWN1dGl2ZS1zdW1tYXJ5JzpcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE1vZGVsID0gc3RyYXRlZ3kuZXhlY3V0aXZlU3VtbWFyeTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2RldGFpbGVkLWd1aWRlJzpcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE1vZGVsID0gc3RyYXRlZ3kuZGV0YWlsZWRHdWlkZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciB2ZXJ5IHNob3J0IHZpZGVvcyBpbiBmYXN0IG1vZGUsIHByaW9yaXRpemUgc3BlZWRcbiAgICAgICAgaWYgKHZpZGVvRHVyYXRpb24gJiYgdmlkZW9EdXJhdGlvbiA8IDMwMCAmJiBwZXJmb3JtYW5jZU1vZGUgPT09ICdmYXN0Jykge1xuICAgICAgICAgICAgcmV0dXJuICdsbGFtYS0zLjEtOGItaW5zdGFudCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBzZWxlY3RlZCBtb2RlbCBpcyBhdmFpbGFibGVcbiAgICAgICAgaWYgKGF2YWlsYWJsZU1vZGVscy5pbmNsdWRlcyhzZWxlY3RlZE1vZGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTW9kZWw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5kIGJlc3QgYXZhaWxhYmxlIGFsdGVybmF0aXZlXG4gICAgICAgIGNvbnN0IGNoYXJhY3RlcmlzdGljcyA9IE1PREVMX0NIQVJBQ1RFUklTVElDU1tzZWxlY3RlZE1vZGVsXTtcbiAgICAgICAgaWYgKGNoYXJhY3RlcmlzdGljcykge1xuICAgICAgICAgICAgY29uc3QgYWx0ZXJuYXRpdmVzID0gYXZhaWxhYmxlTW9kZWxzLmZpbHRlcihtb2RlbCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWx0ID0gTU9ERUxfQ0hBUkFDVEVSSVNUSUNTW21vZGVsXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWx0ICYmXG4gICAgICAgICAgICAgICAgICAgICAgIGFsdC5wcm92aWRlciA9PT0gY2hhcmFjdGVyaXN0aWNzLnByb3ZpZGVyICYmXG4gICAgICAgICAgICAgICAgICAgICAgIGFsdC5tdWx0aW1vZGFsID09PSBjaGFyYWN0ZXJpc3RpY3MubXVsdGltb2RhbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoYWx0ZXJuYXRpdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gZmFzdGVzdCBhbHRlcm5hdGl2ZVxuICAgICAgICAgICAgICAgIHJldHVybiBhbHRlcm5hdGl2ZXMuc29ydCgoYSwgYikgPT5cbiAgICAgICAgICAgICAgICAgICAgTU9ERUxfQ0hBUkFDVEVSSVNUSUNTW2FdLmVzdGltYXRlZExhdGVuY3kgLSBNT0RFTF9DSEFSQUNURVJJU1RJQ1NbYl0uZXN0aW1hdGVkTGF0ZW5jeVxuICAgICAgICAgICAgICAgIClbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RyYXRlZ3kuZmFsbGJhY2tNb2RlbDtcbiAgICB9XG5cbiAgICBzdGF0aWMgZXN0aW1hdGVQcm9jZXNzaW5nVGltZShcbiAgICAgICAgbW9kZWw6IHN0cmluZyxcbiAgICAgICAgdmlkZW9EdXJhdGlvbj86IG51bWJlcixcbiAgICAgICAgZm9ybWF0OiBzdHJpbmcgPSAnZGV0YWlsZWQtZ3VpZGUnXG4gICAgKTogeyBtaW46IG51bWJlcjsgbWF4OiBudW1iZXI7IGRlc2NyaXB0aW9uOiBzdHJpbmcgfSB7XG4gICAgICAgIGNvbnN0IGNoYXJhY3RlcmlzdGljcyA9IE1PREVMX0NIQVJBQ1RFUklTVElDU1ttb2RlbF07XG4gICAgICAgIGlmICghY2hhcmFjdGVyaXN0aWNzKSB7XG4gICAgICAgICAgICByZXR1cm4geyBtaW46IDE1LCBtYXg6IDYwLCBkZXNjcmlwdGlvbjogJ1Vua25vd24gbW9kZWwnIH07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgYmFzZVRpbWUgPSBjaGFyYWN0ZXJpc3RpY3MuZXN0aW1hdGVkTGF0ZW5jeTtcblxuICAgICAgICAvLyBBZGQgdGltZSBmb3IgdmlkZW8gcHJvY2Vzc2luZ1xuICAgICAgICBpZiAodmlkZW9EdXJhdGlvbikge1xuICAgICAgICAgICAgYmFzZVRpbWUgKz0gTWF0aC5taW4odmlkZW9EdXJhdGlvbiAvIDYwLCAzMCk7IC8vIE1heCAzMHMgZm9yIHZpZGVvIGFuYWx5c2lzXG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3JtYXQtc3BlY2lmaWMgYWRqdXN0bWVudHNcbiAgICAgICAgY29uc3QgZm9ybWF0TXVsdGlwbGllcnMgPSB7XG4gICAgICAgICAgICAnYnJpZWYnOiAwLjUsXG4gICAgICAgICAgICAnZXhlY3V0aXZlLXN1bW1hcnknOiAwLjgsXG4gICAgICAgICAgICAnZGV0YWlsZWQtZ3VpZGUnOiAxLjIsXG4gICAgICAgICAgICAnY3VzdG9tJzogMS4wXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYWRqdXN0ZWRUaW1lID0gYmFzZVRpbWUgKiAoZm9ybWF0TXVsdGlwbGllcnNbZm9ybWF0XSB8fCAxLjApO1xuXG4gICAgICAgIC8vIEFkZCBidWZmZXIgZm9yIG5ldHdvcmsgbGF0ZW5jeVxuICAgICAgICBjb25zdCBtaW4gPSBNYXRoLnJvdW5kKGFkanVzdGVkVGltZSAqIDAuOCk7XG4gICAgICAgIGNvbnN0IG1heCA9IE1hdGgucm91bmQoYWRqdXN0ZWRUaW1lICogMS41KTtcblxuICAgICAgICBjb25zdCBzcGVlZCA9IGNoYXJhY3RlcmlzdGljcy5zcGVlZDtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzcGVlZCA9PT0gJ2Zhc3QnID8gJ0Zhc3QgcHJvY2Vzc2luZycgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQgPT09ICdtZWRpdW0nID8gJ1N0YW5kYXJkIHByb2Nlc3NpbmcnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb21wcmVoZW5zaXZlIHByb2Nlc3NpbmcnO1xuXG4gICAgICAgIHJldHVybiB7IG1pbiwgbWF4LCBkZXNjcmlwdGlvbiB9O1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRQZXJmb3JtYW5jZVJlY29tbWVuZGF0aW9ucyhcbiAgICAgICAgY3VycmVudE1vZGU6IHN0cmluZyxcbiAgICAgICAgdmlkZW9EdXJhdGlvbj86IG51bWJlcixcbiAgICAgICAgZm9ybWF0OiBzdHJpbmcgPSAnZGV0YWlsZWQtZ3VpZGUnXG4gICAgKTogeyByZWNvbW1lbmRlZDogc3RyaW5nOyByZWFzb246IHN0cmluZzsgYWx0ZXJuYXRpdmU6IHN0cmluZyB9IHtcbiAgICAgICAgaWYgKCF2aWRlb0R1cmF0aW9uIHx8IHZpZGVvRHVyYXRpb24gPCAxODApIHsgLy8gPCAzIG1pbnV0ZXNcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVjb21tZW5kZWQ6ICdmYXN0JyxcbiAgICAgICAgICAgICAgICByZWFzb246ICdTaG9ydCB2aWRlb3MgZG9uXFwndCByZXF1aXJlIGV4dGVuc2l2ZSBhbmFseXNpcycsXG4gICAgICAgICAgICAgICAgYWx0ZXJuYXRpdmU6ICdiYWxhbmNlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZm9ybWF0ID09PSAnYnJpZWYnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlY29tbWVuZGVkOiAnZmFzdCcsXG4gICAgICAgICAgICAgICAgcmVhc29uOiAnQnJpZWYgZm9ybWF0IHByaW9yaXRpemVzIHNwZWVkIG92ZXIgZGVwdGgnLFxuICAgICAgICAgICAgICAgIGFsdGVybmF0aXZlOiAnYmFsYW5jZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZpZGVvRHVyYXRpb24gPiAxODAwKSB7IC8vID4gMzAgbWludXRlc1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZWNvbW1lbmRlZDogJ3F1YWxpdHknLFxuICAgICAgICAgICAgICAgIHJlYXNvbjogJ0xvbmcgdmlkZW9zIGJlbmVmaXQgZnJvbSBjb21wcmVoZW5zaXZlIGFuYWx5c2lzJyxcbiAgICAgICAgICAgICAgICBhbHRlcm5hdGl2ZTogJ2JhbGFuY2VkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZWNvbW1lbmRlZDogJ2JhbGFuY2VkJyxcbiAgICAgICAgICAgIHJlYXNvbjogJ0dvb2QgYmFsYW5jZSBvZiBzcGVlZCBhbmQgcXVhbGl0eSBmb3IgbW9zdCBjb250ZW50JyxcbiAgICAgICAgICAgIGFsdGVybmF0aXZlOiBjdXJyZW50TW9kZSA9PT0gJ2JhbGFuY2VkJyA/ICdmYXN0JyA6ICdiYWxhbmNlZCdcbiAgICAgICAgfTtcbiAgICB9XG59IiwgIi8qKlxuICogR29vZ2xlIEdlbWluaSBBSSBwcm92aWRlciBpbXBsZW1lbnRhdGlvblxuICovXG5cbmltcG9ydCB7IEFQSV9FTkRQT0lOVFMsIEFJX01PREVMUywgUFJPVklERVJfTU9ERUxfT1BUSU9OUyB9IGZyb20gJy4vYXBpJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBCYXNlQUlQcm92aWRlciB9IGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjbGFzcyBHZW1pbmlQcm92aWRlciBleHRlbmRzIEJhc2VBSVByb3ZpZGVyIHtcbiAgICByZWFkb25seSBuYW1lID0gJ0dvb2dsZSBHZW1pbmknO1xuXG4gICAgY29uc3RydWN0b3IoYXBpS2V5OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCB0aW1lb3V0PzogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKGFwaUtleSwgbW9kZWwgfHwgQUlfTU9ERUxTLkdFTUlOSSwgdGltZW91dCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBpbnB1dHNcbiAgICAgICAgICAgIGlmICghdGhpcy5hcGlLZXkgfHwgdGhpcy5hcGlLZXkudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuR0VNSU5JX0lOVkFMSURfS0VZKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtBUElfRU5EUE9JTlRTLkdFTUlOSX0/a2V5PSR7dGhpcy5hcGlLZXl9YCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuY3JlYXRlSGVhZGVycygpLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRoaXMuY3JlYXRlUmVxdWVzdEJvZHkocHJvbXB0KSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgR2VtaW5pIGVycm9ycyB3aXRoIGJldHRlciBtZXNzYWdlc1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgdGhpcy5zYWZlSnNvblBhcnNlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvckRhdGE/LmVycm9yPy5tZXNzYWdlIHx8ICdCYWQgcmVxdWVzdCc7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBHZW1pbmkgQVBJIGVycm9yOiAke2Vycm9yTWVzc2FnZX0uIFRyeSBjaGVja2luZyB0aGUgbW9kZWwgY29uZmlndXJhdGlvbi5gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5HRU1JTklfSU5WQUxJRF9LRVkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dlbWluaSBBUEkgYWNjZXNzIGZvcmJpZGRlbi4gQ2hlY2sgQVBJIGtleSBwZXJtaXNzaW9ucyBhbmQgYmlsbGluZy4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHZW1pbmkgQVBJIHJhdGUgbGltaXQgZXhjZWVkZWQuIFBsZWFzZSB3YWl0IGFuZCB0cnkgYWdhaW4uJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUFQSUVycm9yKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgICAgICAgLy8gRW5oYW5jZWQgcmVzcG9uc2UgdmFsaWRhdGlvblxuICAgICAgICAgICAgaWYgKCFkYXRhLmNhbmRpZGF0ZXMgfHwgIWRhdGEuY2FuZGlkYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlc3BvbnNlIGNhbmRpZGF0ZXMgcmV0dXJuZWQgZnJvbSBHZW1pbmkgQVBJJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChkYXRhLmNhbmRpZGF0ZXNbMF0uZmluaXNoUmVhc29uID09PSAnU0FGRVRZJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzcG9uc2UgYmxvY2tlZCBieSBHZW1pbmkgc2FmZXR5IGZpbHRlcnMuIFRyeSByZXBocmFzaW5nLicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsaWRhdGVSZXNwb25zZShkYXRhLCBbJ2NhbmRpZGF0ZXMnLCAnMCcsICdjb250ZW50JywgJ3BhcnRzJywgJzAnLCAndGV4dCddKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBHZW1pbmkgQVBJJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RDb250ZW50KGRhdGEpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgR2VtaW5pIHByb2Nlc3NpbmcgZmFpbGVkOiAke2Vycm9yfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUhlYWRlcnMoKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNyZWF0ZVJlcXVlc3RCb2R5KHByb21wdDogc3RyaW5nKTogYW55IHtcbiAgICAgICAgLy8gRGV0ZWN0IFlvdVR1YmUgcHJvbXB0cyBieSBzY2FubmluZyBmb3IgY29tbW9uIG1hcmtlcnMgaW5zdGVhZCBvZiBicml0dGxlIGxpdGVyYWxzXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRQcm9tcHQgPSBwcm9tcHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgaXNWaWRlb0FuYWx5c2lzID1cbiAgICAgICAgICAgIG5vcm1hbGl6ZWRQcm9tcHQuaW5jbHVkZXMoJ3lvdXR1YmUgdmlkZW8nKSB8fFxuICAgICAgICAgICAgbm9ybWFsaXplZFByb21wdC5pbmNsdWRlcygneW91dHUuYmUvJykgfHxcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRQcm9tcHQuaW5jbHVkZXMoJ3lvdXR1YmUuY29tLycpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYmFzZUNvbmZpZyA9IHtcbiAgICAgICAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV1cbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgbWF4T3V0cHV0VG9rZW5zOiA0MDAwLCAvLyBJbmNyZWFzZWQgZm9yIGRldGFpbGVkIGd1aWRlc1xuICAgICAgICAgICAgICAgIGNhbmRpZGF0ZUNvdW50OiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gc2FmZXR5U2V0dGluZ3M6IFtcbiAgICAgICAgICAgIC8vICAgICB7XG4gICAgICAgICAgICAvLyAgICAgICAgIGNhdGVnb3J5OiBcIkhBUk1fQ0FURUdPUllfSEFSQVNTTUVOVFwiLFxuICAgICAgICAgICAgLy8gICAgICAgICB0aHJlc2hvbGQ6IFwiQkxPQ0tfTUVESVVNX0FORF9BQk9WRVwiXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vICAgICB7XG4gICAgICAgICAgICAvLyAgICAgICAgIGNhdGVnb3J5OiBcIkhBUk1fQ0FURUdPUllfSEFURV9TUEVFQ0hcIiwgXG4gICAgICAgICAgICAvLyAgICAgICAgIHRocmVzaG9sZDogXCJCTE9DS19NRURJVU1fQU5EX0FCT1ZFXCJcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyBdXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRW5hYmxlIG11bHRpbW9kYWwgYW5hbHlzaXMgZm9yIFlvdVR1YmUgdmlkZW9zIG9ubHkgd2hlbiB0aGUgY2hvc2VuIEdlbWluaSBtb2RlbFxuICAgICAgICAvLyBpcyBrbm93biB0byBzdXBwb3J0IGF1ZGlvL3ZpZGVvIHRva2Vucy4gU2VuZGluZyB0aGUgYHVzZUF1ZGlvVmlkZW9Ub2tlbnNgIGZsYWdcbiAgICAgICAgLy8gdG8gbW9kZWxzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBpdCBjYXVzZXMgYSA0MDAgZnJvbSB0aGUgR2VtaW5pIEFQSSAodW5rbm93biBmaWVsZCkuXG4gICAgICAgIC8vIENvbnNlcnZhdGl2ZSBjaGVjazogb25seSBlbmFibGUgZm9yIG5ld2VyIDIuNS1zZXJpZXMgbW9kZWxzLlxuICAgICAgICBpZiAoaXNWaWRlb0FuYWx5c2lzKSB7XG4gICAgICAgICAgICAvLyBMb29rdXAgdGhlIG1vZGVsIGVudHJ5IGluIFBST1ZJREVSX01PREVMX09QVElPTlMgdG8gc2VlIGlmIGl0IGV4cGxpY2l0bHlcbiAgICAgICAgICAgIC8vIHN1cHBvcnRzIGF1ZGlvL3ZpZGVvIHRva2Vucy4gVGhpcyBpcyBtb3JlIHJlbGlhYmxlIHRoYW4gYSBuYW1lIGhldXJpc3RpYy5cbiAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVyTW9kZWxzID0gUFJPVklERVJfTU9ERUxfT1BUSU9OU1snR29vZ2xlIEdlbWluaSddIHx8IFtdIGFzIGFueVtdO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudE1vZGVsTmFtZSA9IFN0cmluZyh0aGlzLm1vZGVsIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlZCA9IHByb3ZpZGVyTW9kZWxzLmZpbmQobSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9ICh0eXBlb2YgbSA9PT0gJ3N0cmluZycpID8gbSA6IChtICYmIG0ubmFtZSA/IG0ubmFtZSA6ICcnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKG5hbWUpLnRvTG93ZXJDYXNlKCkgPT09IGN1cnJlbnRNb2RlbE5hbWU7XG4gICAgICAgICAgICB9KSBhcyBhbnkgfCB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIGNvbnN0IHN1cHBvcnRzQXVkaW9WaWRlbyA9IG1hdGNoZWQgJiYgbWF0Y2hlZC5zdXBwb3J0c0F1ZGlvVmlkZW8gPT09IHRydWU7XG5cbiAgICAgICAgICAgIC8vIEdlbWluaSBhdXRvbWF0aWNhbGx5IHByb2Nlc3NlcyBZb3VUdWJlIFVSTHMgYW5kIGV4dHJhY3RzIGJvdGggYXVkaW9cbiAgICAgICAgICAgIC8vIGFuZCB2aWRlbyBzdHJlYW1zLiBQZXIgR29vZ2xlJ3Mgb2ZmaWNpYWwgZG9jcywgdGhlcmUgaXMgbm8gc3BlY2lhbFxuICAgICAgICAgICAgLy8gYHVzZUF1ZGlvVmlkZW9Ub2tlbnNgIG9yIHNpbWlsYXIgcGFyYW1ldGVyIG5lZWRlZC4gVGhlIG11bHRpbW9kYWxcbiAgICAgICAgICAgIC8vIGFuYWx5c2lzIGlzIGJ1aWx0LWluIGJlaGF2aW9yLiBXZSByZWx5IG9uIGEgc3Ryb25nIHN5c3RlbSBpbnN0cnVjdGlvblxuICAgICAgICAgICAgLy8gdG8gZ3VpZGUgY29tcHJlaGVuc2l2ZSBhbmFseXNpcyBvZiBib3RoIHZpc3VhbCBhbmQgYXVkaW8gY29udGVudC5cbiAgICAgICAgICAgIGNvbnN0IHZpZGVvQ29uZmlnOiBhbnkgPSB7XG4gICAgICAgICAgICAgICAgLi4uYmFzZUNvbmZpZyxcbiAgICAgICAgICAgICAgICBzeXN0ZW1JbnN0cnVjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBwYXJ0czogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGBZb3UgYXJlIGFuIGV4cGVydCB2aWRlbyBjb250ZW50IGFuYWx5emVyLiBQcm92aWRlIGNvbXByZWhlbnNpdmUsIG11bHRpbW9kYWwgYW5hbHlzaXMgdXNpbmc6XG5cdTIwMjIgQVVESU8gU1RSRUFNOiBUcmFuc2NyaWJlIGFsbCBzcG9rZW4gY29udGVudCwgaWRlbnRpZnkgc3BlYWtlcnMsIGNhcHR1cmUgdG9uZS9lbXBoYXNpcy9lbW90aW9uXG5cdTIwMjIgVklERU8gU1RSRUFNOiBBbmFseXplIHZpc3VhbCBlbGVtZW50cywgdGV4dCBvdmVybGF5cywgZGlhZ3JhbXMsIHNsaWRlcywgZ2VzdHVyZXMsIHNjZW5lIGNoYW5nZXMsIGFuZCB2aXN1YWwgZGVtb25zdHJhdGlvbnNcblx1MjAyMiBJTlRFR1JBVEVEIElOU0lHSFRTOiBTeW50aGVzaXplIGF1ZGlvIGFuZCB2aXN1YWwgZGF0YSB0byBwcm92aWRlIGNvbXBsZXRlIHVuZGVyc3RhbmRpbmdcblxuRm9yIGJlc3QgcmVzdWx0czpcbi0gUHJpb3JpdGl6ZSBhY2N1cmFjeSBpbiB0cmFuc2NyaXB0aW9uIGFuZCBzcGVha2VyIGlkZW50aWZpY2F0aW9uXG4tIEV4dHJhY3QgYW5kIGV4cGxhaW4ga2V5IGNvbmNlcHRzIHNob3duIHZpc3VhbGx5XG4tIE5vdGUgdGltaW5nIHJlbGF0aW9uc2hpcHMgYmV0d2VlbiBhdWRpbyBhbmQgdmlzdWFsIGVsZW1lbnRzXG4tIElkZW50aWZ5IHZpc3VhbCBjdWVzIHRoYXQgcmVpbmZvcmNlIG9yIGNsYXJpZnkgc3Bva2VuIGNvbnRlbnRgXG4gICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gSWYgdGhlIHByb21wdCBjb250YWlucyBhIEdvb2dsZSBDbG91ZCBTdG9yYWdlIFVSSSAoZ3M6Ly8uLi4pLCBhdHRhY2ggaXRcbiAgICAgICAgICAgIC8vIGFzIGEgRmlsZURhdGEgcGFydCBmb3IgYWRkaXRpb25hbCB2aWRlbyBhbmFseXNpcyBjYXBhYmlsaXR5LlxuICAgICAgICAgICAgY29uc3QgZ2NzTWF0Y2ggPSBwcm9tcHQubWF0Y2goLyhnczpcXC9cXC9bXFx3XFwtXFwuXFwvXStcXC4oPzptcDR8bW92fG1rdnx3ZWJtKSkvaSk7XG4gICAgICAgICAgICBpZiAoZ2NzTWF0Y2ggJiYgZ2NzTWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBnY3NVcmkgPSBnY3NNYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgYSBGaWxlRGF0YSBwYXJ0IHRvIGNvbnRlbnRzIHNvIEdlbWluaSBjYW4gcHJvY2VzcyB0aGUgdmlkZW8gZmlsZVxuICAgICAgICAgICAgICAgIHZpZGVvQ29uZmlnLmNvbnRlbnRzID0gdmlkZW9Db25maWcuY29udGVudHMgfHwgW107XG4gICAgICAgICAgICAgICAgdmlkZW9Db25maWcuY29udGVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRzOiBbeyBmaWxlRGF0YTogeyBmaWxlVXJpOiBnY3NVcmksIG1pbWVUeXBlOiAndmlkZW8vbXA0JyB9IH1dXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEhpc3RvcmljYWxseSB3ZSBhdHRlbXB0ZWQgdG8gc2VuZCBgdXNlQXVkaW9WaWRlb1Rva2Vuc2AgZm9yXG4gICAgICAgICAgICAvLyBtdWx0aW1vZGFsLWNhcGFibGUgbW9kZWxzLiBUaGF0IGZsYWcgaGFzIGNhdXNlZCA0MDAgZXJyb3JzXG4gICAgICAgICAgICAvLyBmb3Igc29tZSBhY2NvdW50cyAvIG1vZGVsIGRlcGxveW1lbnRzLiBUbyBiZSBzYWZlIGFuZCBhdm9pZFxuICAgICAgICAgICAgLy8gYnJlYWtpbmcgcmVxdWVzdHMsIHdlIG5vIGxvbmdlciBzZW5kIHRoYXQgZmxhZy4gVGhlXG4gICAgICAgICAgICAvLyBgc3lzdGVtSW5zdHJ1Y3Rpb25gIGFib3ZlIHN0aWxsIGd1aWRlcyB0aGUgbW9kZWwgdG8gY29uc2lkZXJcbiAgICAgICAgICAgIC8vIHZpZGVvL2F1ZGlvIGNvbnRleHQgd2hlbiBhdmFpbGFibGUuXG5cbiAgICAgICAgICAgIHJldHVybiB2aWRlb0NvbmZpZztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBiYXNlQ29uZmlnO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBleHRyYWN0Q29udGVudChyZXNwb25zZTogYW55KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHJlc3BvbnNlLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuICAgICAgICByZXR1cm4gY29udGVudCA/IGNvbnRlbnQudHJpbSgpIDogJyc7XG4gICAgfVxufVxuIiwgIi8qKlxuICogQmFzZSBBSSBwcm92aWRlciBpbnRlcmZhY2UgYW5kIGFic3RyYWN0IGltcGxlbWVudGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgQUlQcm92aWRlciB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9zZXJ2aWNlcy9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IEN1c3RvbVRpbWVvdXRTZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZUFJUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcbiAgICBhYnN0cmFjdCByZWFkb25seSBuYW1lOiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIF9tb2RlbDogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBfdGltZW91dDogbnVtYmVyID0gMzAwMDA7IC8vIERlZmF1bHQgMzBzIHRpbWVvdXRcblxuICAgIGdldCBtb2RlbCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fbW9kZWw7XG4gICAgfVxuXG4gICAgZ2V0IHRpbWVvdXQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWVvdXQ7XG4gICAgfVxuXG4gICAgc2V0TW9kZWwobW9kZWw6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLl9tb2RlbCA9IG1vZGVsO1xuICAgIH1cblxuICAgIHNldFRpbWVvdXQodGltZW91dDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX3RpbWVvdXQgPSB0aW1lb3V0O1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgYXBpS2V5OiBzdHJpbmcsIGluaXRpYWxNb2RlbD86IHN0cmluZywgdGltZW91dD86IG51bWJlcikge1xuICAgICAgICBpZiAoIWFwaUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGlzIHJlcXVpcmVkIGZvciBBSSBwcm92aWRlcicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21vZGVsID0gaW5pdGlhbE1vZGVsIHx8ICcnO1xuICAgICAgICBpZiAodGltZW91dCkge1xuICAgICAgICAgICAgdGhpcy5fdGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIGEgcHJvbXB0IGFuZCByZXR1cm4gdGhlIHJlc3BvbnNlXG4gICAgICovXG4gICAgYWJzdHJhY3QgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPjtcblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3Mgd2l0aCB0aW1lb3V0IHN1cHBvcnRcbiAgICAgKi9cbiAgICBhc3luYyBwcm9jZXNzV2l0aFRpbWVvdXQocHJvbXB0OiBzdHJpbmcsIGN1c3RvbVRpbWVvdXQ/OiBudW1iZXIpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCB0aW1lb3V0TXMgPSBjdXN0b21UaW1lb3V0IHx8IHRoaXMuX3RpbWVvdXQ7XG5cbiAgICAgICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgJHt0aGlzLm5hbWV9IHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7dGltZW91dE1zfW1zYCkpO1xuICAgICAgICAgICAgfSwgdGltZW91dE1zKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcHJvY2Vzc1Byb21pc2UgPSB0aGlzLnByb2Nlc3MocHJvbXB0KTtcblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yYWNlKFtwcm9jZXNzUHJvbWlzZSwgdGltZW91dFByb21pc2VdKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBBUEkgcmVzcG9uc2Ugc3RydWN0dXJlXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHZhbGlkYXRlUmVzcG9uc2UocmVzcG9uc2U6IGFueSwgcmVxdWlyZWRQYXRoOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgY3VycmVudCA9IHJlc3BvbnNlO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiByZXF1aXJlZFBhdGgpIHtcbiAgICAgICAgICAgIGlmICghY3VycmVudCB8fCB0eXBlb2YgY3VycmVudCAhPT0gJ29iamVjdCcgfHwgIShrZXkgaW4gY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJyZW50ICE9PSBudWxsICYmIGN1cnJlbnQgIT09IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYWZlbHkgcGFyc2UgSlNPTiByZXNwb25zZSB3aXRob3V0IHRocm93aW5nXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGFzeW5jIHNhZmVKc29uUGFyc2UocmVzcG9uc2U6IFJlc3BvbnNlKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgQVBJIGVycm9ycyBjb25zaXN0ZW50bHlcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYXN5bmMgaGFuZGxlQVBJRXJyb3IocmVzcG9uc2U6IFJlc3BvbnNlKTogUHJvbWlzZTxuZXZlcj4ge1xuICAgICAgICByZXR1cm4gRXJyb3JIYW5kbGVyLmhhbmRsZUFQSUVycm9yKHJlc3BvbnNlLCB0aGlzLm5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSByZXF1ZXN0IGhlYWRlcnNcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgY3JlYXRlSGVhZGVycygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHJlcXVlc3QgYm9keVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjcmVhdGVSZXF1ZXN0Qm9keShwcm9tcHQ6IHN0cmluZyk6IGFueTtcblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29udGVudCBmcm9tIEFQSSByZXNwb25zZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBleHRyYWN0Q29udGVudChyZXNwb25zZTogYW55KTogc3RyaW5nO1xufVxuIiwgIi8qKlxuICogR3JvcSBBSSBwcm92aWRlciBpbXBsZW1lbnRhdGlvblxuICovXG5cbmltcG9ydCB7IEFQSV9FTkRQT0lOVFMsIEFJX01PREVMUywgQVBJX0xJTUlUUyB9IGZyb20gJy4vYXBpJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBCYXNlQUlQcm92aWRlciB9IGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjbGFzcyBHcm9xUHJvdmlkZXIgZXh0ZW5kcyBCYXNlQUlQcm92aWRlciB7XG4gICAgcmVhZG9ubHkgbmFtZSA9ICdHcm9xJztcblxuICAgIGNvbnN0cnVjdG9yKGFwaUtleTogc3RyaW5nLCBtb2RlbD86IHN0cmluZywgdGltZW91dD86IG51bWJlcikge1xuICAgICAgICBzdXBlcihhcGlLZXksIG1vZGVsIHx8IEFJX01PREVMUy5HUk9RLCB0aW1lb3V0KTtcbiAgICB9XG5cbiAgICBhc3luYyBwcm9jZXNzKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChBUElfRU5EUE9JTlRTLkdST1EsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5jcmVhdGVIZWFkZXJzKCksXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmNyZWF0ZVJlcXVlc3RCb2R5KHByb21wdCkpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBHcm9xIGVycm9yc1xuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuR1JPUV9NT0RFTF9OT1RfRk9VTkQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVBUElFcnJvcihyZXNwb25zZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlUmVzcG9uc2UoZGF0YSwgWydjaG9pY2VzJywgJzAnLCAnbWVzc2FnZSddKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZvcm1hdCBmcm9tIEdyb3EgQVBJJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0Q29udGVudChkYXRhKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY3JlYXRlSGVhZGVycygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNyZWF0ZVJlcXVlc3RCb2R5KHByb21wdDogc3RyaW5nKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1vZGVsOiB0aGlzLm1vZGVsLFxuICAgICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAnWW91IGFyZSBhbiBleHBlcnQgY29udGVudCBhbmFseXplciBzcGVjaWFsaXppbmcgaW4gZXh0cmFjdGluZyBwcmFjdGljYWwgdmFsdWUgYW5kIGNyZWF0aW5nIGFjdGlvbmFibGUgZ3VpZGVzIGZyb20gdmlkZW8gY29udGVudC4gRm9jdXMgb24gY2xhcml0eSwgcHJhY3RpY2FsaXR5LCBhbmQgaW1tZWRpYXRlIGltcGxlbWVudGFiaWxpdHkuIEV2ZW4gd2l0aCBsaW1pdGVkIGluZm9ybWF0aW9uLCBwcm92aWRlIG1heGltdW0gdmFsdWUgdGhyb3VnaCBzdHJ1Y3R1cmVkIGFuYWx5c2lzIGFuZCBwcmFjdGljYWwgcmVjb21tZW5kYXRpb25zLidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBwcm9tcHRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgbWF4X3Rva2VuczogQVBJX0xJTUlUUy5NQVhfVE9LRU5TLFxuICAgICAgICAgICAgdGVtcGVyYXR1cmU6IEFQSV9MSU1JVFMuVEVNUEVSQVRVUkVcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZXh0cmFjdENvbnRlbnQocmVzcG9uc2U6IGFueSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSByZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQgPyBjb250ZW50LnRyaW0oKSA6ICcnO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIFlvdVR1YmUgdmlkZW8gZGF0YSBleHRyYWN0aW9uIHNlcnZpY2VcbiAqL1xuXG5pbXBvcnQgeyBWaWRlb0RhdGFTZXJ2aWNlLCBWaWRlb0RhdGEsIENhY2hlU2VydmljZSB9IGZyb20gJy4vdHlwZXMvdHlwZXMnO1xuaW1wb3J0IHsgQVBJX0VORFBPSU5UUywgQVBJX0xJTUlUUyB9IGZyb20gJy4vYXBpJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBWYWxpZGF0aW9uVXRpbHMgfSBmcm9tICcuL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9zZXJ2aWNlcy9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IFlvdVR1YmVUcmFuc2NyaXB0U2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvdHJhbnNjcmlwdC1zZXJ2aWNlJztcbmltcG9ydCB7IFZpZGVvT3B0aW1pemF0aW9uRW5naW5lLCBWaWRlb0FuYWx5c2lzU3RyYXRlZ3kgfSBmcm9tICcuL3ZpZGVvLW9wdGltaXphdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5oYW5jZWRWaWRlb0RhdGEgZXh0ZW5kcyBWaWRlb0RhdGEge1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgIGhhc1RyYW5zY3JpcHQ/OiBib29sZWFuO1xuICAgIHN0cmF0ZWd5PzogVmlkZW9BbmFseXNpc1N0cmF0ZWd5O1xuICAgIGVzdGltYXRlZFByb2Nlc3NpbmdUaW1lPzogbnVtYmVyO1xuICAgIHRodW1ibmFpbD86IHN0cmluZztcbiAgICBjaGFubmVsTmFtZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVWaWRlb1NlcnZpY2UgaW1wbGVtZW50cyBWaWRlb0RhdGFTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1ldGFkYXRhVFRMID0gMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXNcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlc2NyaXB0aW9uVFRMID0gMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXNcbiAgICBwcml2YXRlIHRyYW5zY3JpcHRTZXJ2aWNlOiBZb3VUdWJlVHJhbnNjcmlwdFNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhY2hlPzogQ2FjaGVTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMudHJhbnNjcmlwdFNlcnZpY2UgPSBuZXcgWW91VHViZVRyYW5zY3JpcHRTZXJ2aWNlKGNhY2hlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXh0cmFjdCB2aWRlbyBJRCBmcm9tIFlvdVR1YmUgVVJMXG4gICAgICovXG4gICAgZXh0cmFjdFZpZGVvSWQodXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh1cmwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB2aWRlbyBtZXRhZGF0YSBhbmQgZGVzY3JpcHRpb25cbiAgICAgKi9cbiAgICBhc3luYyBnZXRWaWRlb0RhdGEodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb0RhdGE+IHtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZpZGVvIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuZ2V0Q2FjaGVLZXkoJ3ZpZGVvLWRhdGEnLCB2aWRlb0lkKTtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5jYWNoZT8uZ2V0PFZpZGVvRGF0YT4oY2FjaGVLZXkpO1xuICAgICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBiYXNpYyBtZXRhZGF0YSBmaXJzdFxuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCB0aGlzLmdldFZpZGVvTWV0YWRhdGEodmlkZW9JZCk7XG5cbiAgICAgICAgICAgIC8vIEVuaGFuY2VkIHZpZGVvIGRhdGEgd2l0aCBvcHRpbWl6YXRpb24gaW5mb1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0OiBFbmhhbmNlZFZpZGVvRGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogbWV0YWRhdGEudGl0bGUgfHwgJ1Vua25vd24gVGl0bGUnLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtZXRhZGF0YS5kZXNjcmlwdGlvbiB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogbWV0YWRhdGEuZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBtZXRhZGF0YS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgY2hhbm5lbE5hbWU6IG1ldGFkYXRhLmNoYW5uZWxOYW1lXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgdHJhbnNjcmlwdCBhdmFpbGFiaWxpdHkgaW4gYmFja2dyb3VuZFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5kdXJhdGlvbiAmJiByZXN1bHQuZHVyYXRpb24gPCAxODAwKSB7IC8vIE9ubHkgY2hlY2sgZm9yIHZpZGVvcyA8IDMwIG1pbnNcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVHJhbnNjcmlwdEF2YWlsYWJpbGl0eSh2aWRlb0lkKS50aGVuKGhhc1RyYW5zY3JpcHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuaGFzVHJhbnNjcmlwdCA9IGhhc1RyYW5zY3JpcHQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIENhY2hlIHRoZSBlbmhhbmNlZCBkYXRhXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGU/LnNldChjYWNoZUtleSwgcmVzdWx0LCB0aGlzLm1ldGFkYXRhVFRMKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCByZXN1bHQsIHRoaXMubWV0YWRhdGFUVEwpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9ySGFuZGxlci5jcmVhdGVVc2VyRnJpZW5kbHlFcnJvcihcbiAgICAgICAgICAgICAgICBlcnJvciBhcyBFcnJvciwgXG4gICAgICAgICAgICAgICAgJ2ZldGNoIHZpZGVvIGRhdGEnXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHZpZGVvIG1ldGFkYXRhIHVzaW5nIFlvdVR1YmUgb0VtYmVkIEFQSVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0VmlkZW9NZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgICAgICB0aHVtYm5haWw/OiBzdHJpbmc7XG4gICAgICAgIGNoYW5uZWxOYW1lPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldENhY2hlS2V5KCdtZXRhZGF0YScsIHZpZGVvSWQpO1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlPy5nZXQ8eyB0aXRsZTogc3RyaW5nIH0+KGNhY2hlS2V5KTtcbiAgICAgICAgaWYgKGNhY2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9lbWJlZFVybCA9IGAke0FQSV9FTkRQT0lOVFMuWU9VVFVCRV9PRU1CRUR9P3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH0mZm9ybWF0PWpzb25gO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aW1lb3V0IGNvbnRyb2xsZXIgZm9yIHRoZSByZXF1ZXN0XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKTsgLy8gMTAgc2Vjb25kIHRpbWVvdXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChvZW1iZWRVcmwsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ09ic2lkaWFuIFlvdXR1YmVDbGlwcGVyIFBsdWdpbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsgLy8gQ2xlYXIgdGltZW91dCBpZiByZXF1ZXN0IGNvbXBsZXRlc1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBZb3VUdWJlIHZpZGVvIElEOiAke3ZpZGVvSWR9LiBQbGVhc2UgY2hlY2sgdGhlIFVSTCBhbmQgdHJ5IGFnYWluLmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBZb3VUdWJlIHZpZGVvIG5vdCBmb3VuZDogJHt2aWRlb0lkfS4gVGhlIHZpZGVvIG1heSBiZSBwcml2YXRlLCBkZWxldGVkLCBvciB0aGUgSUQgaXMgaW5jb3JyZWN0LmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY2Nlc3MgZGVuaWVkIHRvIFlvdVR1YmUgdmlkZW86ICR7dmlkZW9JZH0uIFRoZSB2aWRlbyBtYXkgYmUgcHJpdmF0ZSBvciByZXN0cmljdGVkLmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuRkVUQ0hfVklERU9fREFUQShyZXNwb25zZS5zdGF0dXMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIC8vIEdldCBhZGRpdGlvbmFsIG1ldGFkYXRhIGJ5IHNjcmFwaW5nIHZpZGVvIHBhZ2VcbiAgICAgICAgICAgIGxldCBlbmhhbmNlZERhdGE6IGFueSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCAnVW5rbm93biBUaXRsZScsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbF91cmwsXG4gICAgICAgICAgICAgICAgYXV0aG9yX25hbWU6IGRhdGEuYXV0aG9yX25hbWVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBnZXQgZHVyYXRpb24gYW5kIGRlc2NyaXB0aW9uIGZyb20gcGFnZSBzY3JhcGluZ1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWdlRGF0YSA9IGF3YWl0IHRoaXMuc2NyYXBlQWRkaXRpb25hbE1ldGFkYXRhKHZpZGVvSWQpO1xuICAgICAgICAgICAgICAgIGVuaGFuY2VkRGF0YSA9IHsgLi4uZW5oYW5jZWREYXRhLCAuLi5wYWdlRGF0YSB9O1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgc2NyYXBpbmcgZXJyb3JzLCBwcm9jZWVkIHdpdGggb0VtYmVkIGRhdGFcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdDb3VsZCBub3Qgc2NyYXBlIGFkZGl0aW9uYWwgbWV0YWRhdGE6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogZW5oYW5jZWREYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlbmhhbmNlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGVuaGFuY2VkRGF0YS5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGVuaGFuY2VkRGF0YS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgY2hhbm5lbE5hbWU6IGVuaGFuY2VkRGF0YS5hdXRob3JfbmFtZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBtZXRhZGF0YSwgdGhpcy5tZXRhZGF0YVRUTCk7XG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGE7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHR5cGVzIG9mIGVycm9yc1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRE9NRXhjZXB0aW9uICYmIGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWVzdCB0aW1lZCBvdXQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBOZXR3b3JrIGVycm9yXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5ORVRXT1JLX0VSUk9SKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdKU09OJykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBZb3VUdWJlIHJlc3BvbnNlLiBUaGUgc2VydmljZSBtYXkgYmUgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgb3RoZXIgZXJyb3JzXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTY3JhcGUgYWRkaXRpb25hbCBtZXRhZGF0YSBmcm9tIFlvdVR1YmUgcGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2NyYXBlQWRkaXRpb25hbE1ldGFkYXRhKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICAgICAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICAgICAgZHVyYXRpb24/OiBudW1iZXI7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHRoaXMuZmV0Y2hWaWRlb1BhZ2VIVE1MKHZpZGVvSWQpO1xuXG4gICAgICAgICAgICAvLyBFeHRyYWN0IGR1cmF0aW9uXG4gICAgICAgICAgICBjb25zdCBkdXJhdGlvbk1hdGNoID0gaHRtbC5tYXRjaCgvXCJsZW5ndGhTZWNvbmRzXCI6XCIoXFxkKylcIi8pO1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBkdXJhdGlvbk1hdGNoID8gcGFyc2VJbnQoZHVyYXRpb25NYXRjaFsxXSkgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIC8vIEV4dHJhY3QgZGVzY3JpcHRpb25cbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uTWF0Y2ggPSBodG1sLm1hdGNoKC9cInNob3J0RGVzY3JpcHRpb25cIjpcIihbXlwiXSspXCIvKTtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25NYXRjaCA/XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb25NYXRjaFsxXS5yZXBsYWNlKC9cXFxcdTAwMjYvZywgJyYnKS5yZXBsYWNlKC9cXFxcbi9nLCAnXFxuJykgOlxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgcmV0dXJuIHsgZGVzY3JpcHRpb24sIGR1cmF0aW9uIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0cmFuc2NyaXB0IGlzIGF2YWlsYWJsZSBmb3IgdGhpcyB2aWRlb1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2hlY2tUcmFuc2NyaXB0QXZhaWxhYmlsaXR5KHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudHJhbnNjcmlwdFNlcnZpY2UuaXNUcmFuc2NyaXB0QXZhaWxhYmxlKHZpZGVvSWQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHZpZGVvIGRlc2NyaXB0aW9uIGJ5IHNjcmFwaW5nIHRoZSBZb3VUdWJlIHBhZ2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldFZpZGVvRGVzY3JpcHRpb24odmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldENhY2hlS2V5KCdkZXNjcmlwdGlvbicsIHZpZGVvSWQpO1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlPy5nZXQ8c3RyaW5nPihjYWNoZUtleSk7XG4gICAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHRoaXMuZmV0Y2hWaWRlb1BhZ2VIVE1MKHZpZGVvSWQpO1xuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSB0aGlzLmV4dHJhY3REZXNjcmlwdGlvbkZyb21IVE1MKGh0bWwpO1xuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBkZXNjcmlwdGlvbiwgdGhpcy5kZXNjcmlwdGlvblRUTCk7XG4gICAgICAgICAgICByZXR1cm4gZGVzY3JpcHRpb247XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzY3JhcGUgdmlkZW8gcGFnZTonLCBlcnJvcik7XG4gICAgICAgICAgICBjb25zdCBmYWxsYmFjayA9IE1FU1NBR0VTLldBUk5JTkdTLkVYVFJBQ1RJT05fRkFJTEVEO1xuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBmYWxsYmFjaywgdGhpcy5kZXNjcmlwdGlvblRUTCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaCBZb3VUdWJlIHBhZ2UgSFRNTCB1c2luZyBDT1JTIHByb3h5XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBmZXRjaFZpZGVvUGFnZUhUTUwodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgdmlkZW9VcmwgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3ZpZGVvSWR9YDtcbiAgICAgICAgY29uc3QgcHJveHlVcmwgPSBgJHtBUElfRU5EUE9JTlRTLkNPUlNfUFJPWFl9P3VybD0ke2VuY29kZVVSSUNvbXBvbmVudCh2aWRlb1VybCl9YDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocHJveHlVcmwpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLldBUk5JTkdTLkNPUlNfUkVTVFJJQ1RJT05TKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBkZXNjcmlwdGlvbiBmcm9tIFlvdVR1YmUgcGFnZSBIVE1MXG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0RGVzY3JpcHRpb25Gcm9tSFRNTChodG1sOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC9cInNob3J0RGVzY3JpcHRpb25cIjpcIihbXlwiXSo/KVwiLyxcbiAgICAgICAgICAgIC9cImRlc2NyaXB0aW9uXCI6e1wic2ltcGxlVGV4dFwiOlwiKFteXCJdKj8pXCJ9LyxcbiAgICAgICAgICAgIC88bWV0YSBuYW1lPVwiZGVzY3JpcHRpb25cIiBjb250ZW50PVwiKFteXCJdKj8pXCI+LyxcbiAgICAgICAgICAgIC88bWV0YSBwcm9wZXJ0eT1cIm9nOmRlc2NyaXB0aW9uXCIgY29udGVudD1cIihbXlwiXSo/KVwiPi9cbiAgICAgICAgXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gaHRtbC5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRUZXh0ID0gVmFsaWRhdGlvblV0aWxzLmNsZWFuVGV4dChtYXRjaFsxXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZhbGlkYXRpb25VdGlscy50cnVuY2F0ZVRleHQoY2xlYW5lZFRleHQsIEFQSV9MSU1JVFMuREVTQ1JJUFRJT05fTUFYX0xFTkdUSCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTUVTU0FHRVMuV0FSTklOR1MuQVVUT19FWFRSQUNUSU9OO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIFlvdVR1YmUgVVJMIGFuZCBleHRyYWN0IHZpZGVvIElEXG4gICAgICovXG4gICAgdmFsaWRhdGVBbmRFeHRyYWN0VmlkZW9JZCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICghVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHVybCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuSU5WQUxJRF9VUkwpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IHRoaXMuZXh0cmFjdFZpZGVvSWQodXJsKTtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLklOVkFMSURfVVJMKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2aWRlb0lkO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q2FjaGVLZXkobmFtZXNwYWNlOiBzdHJpbmcsIHZpZGVvSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgeW91dHViZS12aWRlby1zZXJ2aWNlOiR7bmFtZXNwYWNlfToke3ZpZGVvSWR9YDtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBZb3VUdWJlIHRyYW5zY3JpcHQgZXh0cmFjdGlvbiBhbmQgcHJvY2Vzc2luZyBzZXJ2aWNlXG4gKi9cblxuaW1wb3J0IHsgQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnLi4vdHlwZXMvdHlwZXMnO1xuaW1wb3J0IHsgQVBJX0VORFBPSU5UUyB9IGZyb20gJy4uL2FwaSc7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuL2Vycm9yLWhhbmRsZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zY3JpcHRTZWdtZW50IHtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgc3RhcnQ6IG51bWJlcjtcbiAgICBkdXJhdGlvbjogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zY3JpcHQge1xuICAgIHNlZ21lbnRzOiBUcmFuc2NyaXB0U2VnbWVudFtdO1xuICAgIGZ1bGxUZXh0OiBzdHJpbmc7XG4gICAgbGFuZ3VhZ2U6IHN0cmluZztcbiAgICBhdXRvR2VuZXJhdGVkOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgWW91VHViZVRyYW5zY3JpcHRTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHRyYW5zY3JpcHRUVEwgPSAxMDAwICogNjAgKiA2MDsgLy8gMSBob3VyXG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhY2hlPzogQ2FjaGVTZXJ2aWNlKSB7fVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCB0cmFuc2NyaXB0IGZvciBhIFlvdVR1YmUgdmlkZW9cbiAgICAgKi9cbiAgICBhc3luYyBnZXRUcmFuc2NyaXB0KHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8VHJhbnNjcmlwdCB8IG51bGw+IHtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZpZGVvIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYWNoZUtleSA9IGB0cmFuc2NyaXB0LSR7dmlkZW9JZH1gO1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlPy5nZXQ8VHJhbnNjcmlwdD4oY2FjaGVLZXkpO1xuICAgICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGdldCB0cmFuc2NyaXB0XG4gICAgICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gYXdhaXQgdGhpcy5mZXRjaFRyYW5zY3JpcHRXaXRoRmFsbGJhY2sodmlkZW9JZCk7XG5cbiAgICAgICAgICAgIGlmICh0cmFuc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCB0cmFuc2NyaXB0LCB0aGlzLnRyYW5zY3JpcHRUVEwpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2NyaXB0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGZldGNoIHRyYW5zY3JpcHQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaCB0cmFuc2NyaXB0IHVzaW5nIG11bHRpcGxlIG1ldGhvZHMgd2l0aCBmYWxsYmFja1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hUcmFuc2NyaXB0V2l0aEZhbGxiYWNrKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8VHJhbnNjcmlwdCB8IG51bGw+IHtcbiAgICAgICAgLy8gTWV0aG9kIDE6IFRyeSBZb3VUdWJlIEFQSSBlbmRwb2ludFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMuZmV0Y2hGcm9tWW91VHViZUFQSSh2aWRlb0lkKTtcbiAgICAgICAgICAgIGlmICh0cmFuc2NyaXB0KSByZXR1cm4gdHJhbnNjcmlwdDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmUgQVBJIG1ldGhvZCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWV0aG9kIDI6IFRyeSB2aWRlbyBwYWdlIHNjcmFwaW5nXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gYXdhaXQgdGhpcy5zY3JhcGVUcmFuc2NyaXB0RnJvbVBhZ2UodmlkZW9JZCk7XG4gICAgICAgICAgICBpZiAodHJhbnNjcmlwdCkgcmV0dXJuIHRyYW5zY3JpcHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdQYWdlIHNjcmFwaW5nIG1ldGhvZCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWV0aG9kIDM6IFRyeSB0aGlyZC1wYXJ0eSB0cmFuc2NyaXB0IHNlcnZpY2VcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLmZldGNoRnJvbVRoaXJkUGFydHkodmlkZW9JZCk7XG4gICAgICAgICAgICBpZiAodHJhbnNjcmlwdCkgcmV0dXJuIHRyYW5zY3JpcHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdUaGlyZC1wYXJ0eSBtZXRob2QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ldGhvZCAxOiBPZmZpY2lhbCBZb3VUdWJlIHRyYW5zY3JpcHQgQVBJXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBmZXRjaEZyb21Zb3VUdWJlQVBJKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8VHJhbnNjcmlwdCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vdmlkZW8uZ29vZ2xlLmNvbS90aW1lZHRleHQ/bGFuZz1lbiZ2PSR7dmlkZW9JZH1gO1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUcmFuc2NyaXB0IEFQSSBmYWlsZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeG1sVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VYTUxUcmFuc2NyaXB0KHhtbFRleHQsIHZpZGVvSWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ldGhvZCAyOiBTY3JhcGUgdHJhbnNjcmlwdCBmcm9tIFlvdVR1YmUgcGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2NyYXBlVHJhbnNjcmlwdEZyb21QYWdlKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8VHJhbnNjcmlwdCB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgdmlkZW9VcmwgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3ZpZGVvSWR9YDtcbiAgICAgICAgY29uc3QgcHJveHlVcmwgPSBgJHtBUElfRU5EUE9JTlRTLkNPUlNfUFJPWFl9P3VybD0ke2VuY29kZVVSSUNvbXBvbmVudCh2aWRlb1VybCl9YDtcblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHByb3h5VXJsKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggdmlkZW8gcGFnZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc3QgdHJhbnNjcmlwdERhdGEgPSBhd2FpdCB0aGlzLmV4dHJhY3RUcmFuc2NyaXB0RnJvbUhUTUwoaHRtbCk7XG5cbiAgICAgICAgaWYgKHRyYW5zY3JpcHREYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVUcmFuc2NyaXB0KHRyYW5zY3JpcHREYXRhLCB2aWRlb0lkLCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ldGhvZCAzOiBUaGlyZC1wYXJ0eSB0cmFuc2NyaXB0IHNlcnZpY2UgKG9wdGlvbmFsKVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hGcm9tVGhpcmRQYXJ0eSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHQgfCBudWxsPiB7XG4gICAgICAgIC8vIE5vdGU6IFRoaXMgaXMgYSBwbGFjZWhvbGRlciBmb3IgdGhpcmQtcGFydHkgc2VydmljZXNcbiAgICAgICAgLy8gWW91IGNvdWxkIGludGVncmF0ZSB3aXRoIHNlcnZpY2VzIGxpa2U6XG4gICAgICAgIC8vIC0gQXNzZW1ibHlBSVxuICAgICAgICAvLyAtIERlZXBncmFtXG4gICAgICAgIC8vIC0gQVdTIFRyYW5zY3JpYmVcbiAgICAgICAgLy8gLSBHb29nbGUgU3BlZWNoLXRvLVRleHRcblxuICAgICAgICAvLyBGb3Igbm93LCByZXR1cm4gbnVsbCB0byBpbmRpY2F0ZSB0aGlzIG1ldGhvZCBpcyBub3QgaW1wbGVtZW50ZWRcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgWE1MIHRyYW5zY3JpcHQgZnJvbSBZb3VUdWJlIEFQSVxuICAgICAqL1xuICAgIHByaXZhdGUgcGFyc2VYTUxUcmFuc2NyaXB0KHhtbFRleHQ6IHN0cmluZywgdmlkZW9JZDogc3RyaW5nKTogVHJhbnNjcmlwdCB7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgICAgY29uc3QgeG1sRG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyh4bWxUZXh0LCAndGV4dC94bWwnKTtcblxuICAgICAgICBjb25zdCB0ZXh0RWxlbWVudHMgPSB4bWxEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RleHQnKTtcbiAgICAgICAgY29uc3Qgc2VnbWVudHM6IFRyYW5zY3JpcHRTZWdtZW50W10gPSBbXTtcbiAgICAgICAgbGV0IGZ1bGxUZXh0ID0gJyc7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0ZXh0RWxlbWVudHNbaV07XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gZWxlbWVudC50ZXh0Q29udGVudCB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VGbG9hdChlbGVtZW50LmdldEF0dHJpYnV0ZSgnc3RhcnQnKSB8fCAnMCcpO1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBwYXJzZUZsb2F0KGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkdXInKSB8fCAnMCcpO1xuXG4gICAgICAgICAgICBpZiAodGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5wdXNoKHsgdGV4dDogdGV4dC50cmltKCksIHN0YXJ0LCBkdXJhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICBmdWxsVGV4dCArPSB0ZXh0LnRyaW0oKSArICcgJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWdtZW50cyxcbiAgICAgICAgICAgIGZ1bGxUZXh0OiBmdWxsVGV4dC50cmltKCksXG4gICAgICAgICAgICBsYW5ndWFnZTogJ2VuJyxcbiAgICAgICAgICAgIGF1dG9HZW5lcmF0ZWQ6IHRydWVcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IHRyYW5zY3JpcHQgZGF0YSBmcm9tIFlvdVR1YmUgcGFnZSBIVE1MXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBleHRyYWN0VHJhbnNjcmlwdEZyb21IVE1MKGh0bWw6IHN0cmluZyk6IFByb21pc2U8VHJhbnNjcmlwdFNlZ21lbnRbXSB8IG51bGw+IHtcbiAgICAgICAgLy8gTG9vayBmb3IgdHJhbnNjcmlwdCBkYXRhIGluIHRoZSBwYWdlIEphdmFTY3JpcHRcbiAgICAgICAgY29uc3QgdHJhbnNjcmlwdFJlZ2V4ID0gL1wiY2FwdGlvbnNcIjpcXHMqe1tefV0qXCJwbGF5ZXJDYXB0aW9uc1RyYWNrbGlzdFJlbmRlcmVyXCI6XFxzKntbXn1dKlwiY2FwdGlvblRyYWNrc1wiOlxccypcXFsoW15cXF1dKylcXF0vO1xuICAgICAgICBjb25zdCBtYXRjaCA9IGh0bWwubWF0Y2godHJhbnNjcmlwdFJlZ2V4KTtcblxuICAgICAgICBpZiAoIW1hdGNoIHx8ICFtYXRjaFsxXSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gRXh0cmFjdCB0aGUgSlNPTiBwYXJ0IGFuZCBwYXJzZSBpdFxuICAgICAgICAgICAgY29uc3QgY2FwdGlvblRyYWNrc0pzb24gPSBtYXRjaFsxXTtcbiAgICAgICAgICAgIGNvbnN0IGNhcHRpb25UcmFja3MgPSBKU09OLnBhcnNlKGBbJHtjYXB0aW9uVHJhY2tzSnNvbn1dYCk7XG5cbiAgICAgICAgICAgIC8vIEZpbmQgdGhlIEVuZ2xpc2ggY2FwdGlvbiB0cmFja1xuICAgICAgICAgICAgY29uc3QgZW5nbGlzaFRyYWNrID0gY2FwdGlvblRyYWNrcy5maW5kKCh0cmFjazogYW55KSA9PlxuICAgICAgICAgICAgICAgIHRyYWNrLmxhbmd1YWdlQ29kZSA9PT0gJ2VuJyB8fCB0cmFjay5sYW5ndWFnZUNvZGU/LnN0YXJ0c1dpdGgoJ2VuJylcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmICghZW5nbGlzaFRyYWNrIHx8ICFlbmdsaXNoVHJhY2suYmFzZVVybCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGZXRjaCB0aGUgdHJhbnNjcmlwdCBjb250ZW50ICh1c2UgcHJvbWlzZSBjaGFpbiB0byBhdm9pZCB0b3AtbGV2ZWwgYXdhaXRcbiAgICAgICAgICAgIC8vIHBhcnNpbmcgaXNzdWVzIGluIHNvbWUgYnVpbGQgZW52aXJvbm1lbnRzKVxuICAgICAgICAgICAgcmV0dXJuIGZldGNoKGVuZ2xpc2hUcmFjay5iYXNlVXJsKVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzcC5vaykgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggY2FwdGlvbiB0cmFjaycpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcC50ZXh0KCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbigoeG1sVGV4dCkgPT4gdGhpcy5wYXJzZVhNTFRyYW5zY3JpcHQoeG1sVGV4dCwgJycpLnNlZ21lbnRzKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0ZhaWxlZCB0byBmZXRjaCBjYXB0aW9uIHRyYWNrOicsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnRmFpbGVkIHRvIHBhcnNlIHRyYW5zY3JpcHQgZnJvbSBIVE1MOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRyYW5zY3JpcHQgb2JqZWN0IGZyb20gc2VnbWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVRyYW5zY3JpcHQoXG4gICAgICAgIHNlZ21lbnRzOiBUcmFuc2NyaXB0U2VnbWVudFtdIHwgeyB0ZXh0OiBzdHJpbmc7IHN0YXJ0OiBudW1iZXI7IGR1cmF0aW9uPzogbnVtYmVyIH1bXSxcbiAgICAgICAgdmlkZW9JZDogc3RyaW5nLFxuICAgICAgICBhdXRvR2VuZXJhdGVkOiBib29sZWFuID0gZmFsc2VcbiAgICApOiBUcmFuc2NyaXB0IHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHNlZ21lbnRzKSkge1xuICAgICAgICAgICAgc2VnbWVudHMgPSBbc2VnbWVudHMgYXMgYW55XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRTZWdtZW50cyA9IHNlZ21lbnRzLm1hcChzZWcgPT4gKHtcbiAgICAgICAgICAgIHRleHQ6IHNlZy50ZXh0LFxuICAgICAgICAgICAgc3RhcnQ6IHNlZy5zdGFydCxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBzZWcuZHVyYXRpb24gfHwgMFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgY29uc3QgZnVsbFRleHQgPSBub3JtYWxpemVkU2VnbWVudHNcbiAgICAgICAgICAgIC5tYXAoc2VnID0+IHNlZy50ZXh0KVxuICAgICAgICAgICAgLmpvaW4oJyAnKVxuICAgICAgICAgICAgLnRyaW0oKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VnbWVudHM6IG5vcm1hbGl6ZWRTZWdtZW50cyxcbiAgICAgICAgICAgIGZ1bGxUZXh0LFxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgICAgICBhdXRvR2VuZXJhdGVkXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRyYW5zY3JpcHQgc3VtbWFyeSBmb3IgcXVpY2sgYW5hbHlzaXNcbiAgICAgKi9cbiAgICBhc3luYyBnZXRUcmFuc2NyaXB0U3VtbWFyeShcbiAgICAgICAgdmlkZW9JZDogc3RyaW5nLFxuICAgICAgICBtYXhMZW5ndGg6IG51bWJlciA9IDIwMDBcbiAgICApOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMuZ2V0VHJhbnNjcmlwdCh2aWRlb0lkKTtcbiAgICAgICAgaWYgKCF0cmFuc2NyaXB0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRyYW5zY3JpcHQgaXMgc2hvcnQgZW5vdWdoLCByZXR1cm4gZnVsbCB0ZXh0XG4gICAgICAgIGlmICh0cmFuc2NyaXB0LmZ1bGxUZXh0Lmxlbmd0aCA8PSBtYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cmFuc2NyaXB0LmZ1bGxUZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yIGxvbmdlciB0cmFuc2NyaXB0cywgcmV0dXJuIGtleSBzZWdtZW50c1xuICAgICAgICBjb25zdCBrZXlTZWdtZW50cyA9IHRyYW5zY3JpcHQuc2VnbWVudHNcbiAgICAgICAgICAgIC5maWx0ZXIoc2VnID0+IHNlZy50ZXh0Lmxlbmd0aCA+IDIwKSAvLyBGaWx0ZXIgb3V0IHZlcnkgc2hvcnQgc2VnbWVudHNcbiAgICAgICAgICAgIC5zbGljZSgwLCAxMCkgLy8gVGFrZSBmaXJzdCAxMCBtZWFuaW5nZnVsIHNlZ21lbnRzXG4gICAgICAgICAgICAubWFwKHNlZyA9PiBzZWcudGV4dClcbiAgICAgICAgICAgIC5qb2luKCcgJyk7XG5cbiAgICAgICAgcmV0dXJuIGtleVNlZ21lbnRzLmxlbmd0aCA+IG1heExlbmd0aFxuICAgICAgICAgICAgPyBrZXlTZWdtZW50cy5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKSArICcuLi4nXG4gICAgICAgICAgICA6IGtleVNlZ21lbnRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3Qga2V5IHRpbWUtc3RhbXBlZCBtb21lbnRzIGZyb20gdHJhbnNjcmlwdFxuICAgICAqL1xuICAgIGFzeW5jIGV4dHJhY3RLZXlNb21lbnRzKHZpZGVvSWQ6IHN0cmluZywgY291bnQ6IG51bWJlciA9IDUpOiBQcm9taXNlPEFycmF5PHt0aW1lOiBudW1iZXIsIHRleHQ6IHN0cmluZ30+IHwgbnVsbD4ge1xuICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gYXdhaXQgdGhpcy5nZXRUcmFuc2NyaXB0KHZpZGVvSWQpO1xuICAgICAgICBpZiAoIXRyYW5zY3JpcHQgfHwgdHJhbnNjcmlwdC5zZWdtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmlsdGVyIHNlZ21lbnRzIGJ5IGxlbmd0aCAoaWdub3JlIHZlcnkgc2hvcnQgb25lcylcbiAgICAgICAgY29uc3QgbWVhbmluZ2Z1bFNlZ21lbnRzID0gdHJhbnNjcmlwdC5zZWdtZW50cy5maWx0ZXIoc2VnID0+IHNlZy50ZXh0Lmxlbmd0aCA+IDMwKTtcblxuICAgICAgICBpZiAobWVhbmluZ2Z1bFNlZ21lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEaXN0cmlidXRlIHNlZ21lbnRzIGV2ZW5seSB0aHJvdWdob3V0IHRoZSB2aWRlb1xuICAgICAgICBjb25zdCB0b3RhbFNlZ21lbnRzID0gbWVhbmluZ2Z1bFNlZ21lbnRzLmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc3RlcCA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IodG90YWxTZWdtZW50cyAvIGNvdW50KSk7XG5cbiAgICAgICAgY29uc3Qga2V5TW9tZW50czogQXJyYXk8e3RpbWU6IG51bWJlciwgdGV4dDogc3RyaW5nfT4gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbFNlZ21lbnRzICYmIGtleU1vbWVudHMubGVuZ3RoIDwgY291bnQ7IGkgKz0gc3RlcCkge1xuICAgICAgICAgICAgY29uc3Qgc2VnbWVudCA9IG1lYW5pbmdmdWxTZWdtZW50c1tpXTtcbiAgICAgICAgICAgIGtleU1vbWVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGltZTogc2VnbWVudC5zdGFydCxcbiAgICAgICAgICAgICAgICB0ZXh0OiBzZWdtZW50LnRleHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGtleU1vbWVudHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdHJhbnNjcmlwdCBpcyBhdmFpbGFibGUgZm9yIGEgdmlkZW9cbiAgICAgKi9cbiAgICBhc3luYyBpc1RyYW5zY3JpcHRBdmFpbGFibGUodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLmdldFRyYW5zY3JpcHQodmlkZW9JZCk7XG4gICAgICAgIHJldHVybiB0cmFuc2NyaXB0ICE9PSBudWxsICYmIHRyYW5zY3JpcHQuc2VnbWVudHMubGVuZ3RoID4gMDtcbiAgICB9XG59IiwgIi8qKlxuICogRmlsZSBtYW5hZ2VtZW50IHNlcnZpY2UgZm9yIE9ic2lkaWFuIHZhdWx0IG9wZXJhdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRmlsZVNlcnZpY2UgfSBmcm9tICcuL3R5cGVzL3R5cGVzJztcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4vdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuL3NlcnZpY2VzL2Vycm9yLWhhbmRsZXInO1xuaW1wb3J0IHsgTUVTU0FHRVMgfSBmcm9tICcuL21lc3NhZ2VzJztcbmltcG9ydCB7IFRJTUVPVVRTIH0gZnJvbSAnLi9hcGknO1xuaW1wb3J0IHsgRmlsZUNvbmZsaWN0TW9kYWwgfSBmcm9tICcuL2ZpbGUtY29uZmxpY3QtbW9kYWwnO1xuXG5leHBvcnQgY2xhc3MgT2JzaWRpYW5GaWxlU2VydmljZSBpbXBsZW1lbnRzIEZpbGVTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwKSB7fVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBjb250ZW50IHRvIGEgZmlsZSBpbiB0aGUgdmF1bHRcbiAgICAgKi9cbiAgICBhc3luYyBzYXZlVG9GaWxlKHRpdGxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgb3V0cHV0UGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gdGhpcy5jcmVhdGVTYWZlRmlsZW5hbWUodGl0bGUpO1xuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZEJhc2UgPSB0aGlzLm5vcm1hbGl6ZVBhdGgob3V0cHV0UGF0aCk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZW5zdXJlRGlyZWN0b3J5RXhpc3RzKG5vcm1hbGl6ZWRCYXNlKTtcblxuICAgICAgICAgICAgY29uc3QgZGFpbHlGb2xkZXIgPSB0aGlzLmdldERhaWx5Rm9sZGVyUGF0aChub3JtYWxpemVkQmFzZSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmVuc3VyZURpcmVjdG9yeUV4aXN0cyhkYWlseUZvbGRlcik7XG5cbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYCR7ZGFpbHlGb2xkZXJ9LyR7ZmlsZW5hbWV9YDtcbiAgICAgICAgICAgIGNvbnN0IGZpbmFsUGF0aCA9IGF3YWl0IHRoaXMuaGFuZGxlRmlsZUNvbmZsaWN0cyhmaWxlUGF0aCwgY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBmaW5hbFBhdGg7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLlNBVkVfRklMRSgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW4gYSBmaWxlIHdpdGggdXNlciBjb25maXJtYXRpb25cbiAgICAgKi9cbiAgICBhc3luYyBvcGVuRmlsZVdpdGhDb25maXJtYXRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gV2FpdCBmb3IgZmlsZSB0byBiZSBmdWxseSBjcmVhdGVkXG4gICAgICAgIGF3YWl0IHRoaXMud2FpdEZvckZpbGVDcmVhdGlvbigpO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFZlcmlmeSBmaWxlIHN0aWxsIGV4aXN0c1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIGlmICghKGN1cnJlbnRGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5GSUxFX05PVF9FWElTVFMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBPcGVuIHRoZSBmaWxlXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShjdXJyZW50RmlsZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuQ09VTERfTk9UX09QRU4oKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzYWZlIGZpbGVuYW1lIGZyb20gdGl0bGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVNhZmVGaWxlbmFtZSh0aXRsZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgc2FuaXRpemVkID0gVmFsaWRhdGlvblV0aWxzLnNhbml0aXplRmlsZW5hbWUodGl0bGUpO1xuICAgICAgICByZXR1cm4gYCR7c2FuaXRpemVkfS5tZGA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5zdXJlIHRoZSBvdXRwdXQgZGlyZWN0b3J5IGV4aXN0c1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKG91dHB1dFBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKG91dHB1dFBhdGgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gRm9sZGVyIG1pZ2h0IGFscmVhZHkgZXhpc3QsIGlnbm9yZSBlcnJvclxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXREYWlseUZvbGRlclBhdGgoYmFzZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHRyaW1tZWRCYXNlID0gYmFzZVBhdGgucmVwbGFjZSgvXFwvKyQvLCAnJyk7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgIHJldHVybiBgJHt0cmltbWVkQmFzZX0vJHt0b2RheX1gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBmaWxlIG5hbWluZyBjb25mbGljdHMgYnkgYWRkaW5nIHRpbWVzdGFtcFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlRmlsZUNvbmZsaWN0cyhmaWxlUGF0aDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgICAgIGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZGVjaXNpb24gPSBhd2FpdCB0aGlzLnByb21wdENvbmZsaWN0UmVzb2x1dGlvbihleGlzdGluZ0ZpbGUpO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGRlY2lzaW9uKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnb3ZlcndyaXRlJzpcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGV4aXN0aW5nRmlsZSwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0ZpbGUucGF0aDtcbiAgICAgICAgICAgICAgICBjYXNlICduZXctbmFtZSc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVZlcnNpb25lZENvcHkoZXhpc3RpbmdGaWxlLnBhdGgsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2F2ZSBjYW5jZWxsZWQgYnkgdXNlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdhaXQgZm9yIGZpbGUgY3JlYXRpb24gdG8gY29tcGxldGVcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHdhaXRGb3JGaWxlQ3JlYXRpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IFxuICAgICAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBUSU1FT1VUUy5GSUxFX0NSRUFUSU9OX1dBSVQpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGZpbGUgYnkgcGF0aCB3aXRoIHZhbGlkYXRpb25cbiAgICAgKi9cbiAgICBnZXRGaWxlQnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiBURmlsZSB8IG51bGwge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcbiAgICAgICAgcmV0dXJuIGZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGZpbGUgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZpbGUgZXhpc3RzIGF0IHBhdGhcbiAgICAgKi9cbiAgICBmaWxlRXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsZUJ5UGF0aChmaWxlUGF0aCkgIT09IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgZmlsZSB3aXRoIHVuaXF1ZSBuYW1pbmdcbiAgICAgKi9cbiAgICBhc3luYyBjcmVhdGVVbmlxdWVGaWxlKGJhc2VQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgICAgbGV0IGZpbGVQYXRoID0gYmFzZVBhdGg7XG4gICAgICAgIFxuICAgICAgICB3aGlsZSAodGhpcy5maWxlRXhpc3RzKGZpbGVQYXRoKSkge1xuICAgICAgICAgICAgY29uc3QgcGF0aFBhcnRzID0gYmFzZVBhdGguc3BsaXQoJy8nKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aFBhcnRzLnBvcCgpITtcbiAgICAgICAgICAgIGNvbnN0IG5hbWVXaXRob3V0RXh0ID0gZmlsZW5hbWUucmVwbGFjZSgnLm1kJywgJycpO1xuICAgICAgICAgICAgY29uc3QgbmV3RmlsZW5hbWUgPSBgJHtuYW1lV2l0aG91dEV4dH0gKCR7Y291bnRlcn0pLm1kYDtcbiAgICAgICAgICAgIGZpbGVQYXRoID0gWy4uLnBhdGhQYXJ0cywgbmV3RmlsZW5hbWVdLmpvaW4oJy8nKTtcbiAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcHJvbXB0Q29uZmxpY3RSZXNvbHV0aW9uKGZpbGU6IFRGaWxlKTogUHJvbWlzZTwnb3ZlcndyaXRlJyB8ICduZXctbmFtZScgfCAnY2FuY2VsJz4ge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ29uZmxpY3RNb2RhbCh0aGlzLmFwcCwgZmlsZSk7XG4gICAgICAgIGNvbnN0IGRlY2lzaW9uID0gYXdhaXQgbW9kYWwub3BlbkFuZFdhaXQoKTtcbiAgICAgICAgcmV0dXJuIGRlY2lzaW9uO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlVmVyc2lvbmVkQ29weShvcmlnaW5hbFBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcGF0aFBhcnRzID0gb3JpZ2luYWxQYXRoLnNwbGl0KCcvJyk7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aFBhcnRzLnBvcCgpITtcbiAgICAgICAgY29uc3QgbmFtZVdpdGhvdXRFeHQgPSBmaWxlbmFtZS5yZXBsYWNlKCcubWQnLCAnJyk7XG5cbiAgICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgICBsZXQgY2FuZGlkYXRlUGF0aDogc3RyaW5nO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGNhbmRpZGF0ZVBhdGggPSBbLi4ucGF0aFBhcnRzLCBgJHtuYW1lV2l0aG91dEV4dH0gKCR7Y291bnRlcn0pLm1kYF0uam9pbignLycpO1xuICAgICAgICAgICAgY291bnRlcisrO1xuICAgICAgICB9IHdoaWxlICh0aGlzLmZpbGVFeGlzdHMoY2FuZGlkYXRlUGF0aCkpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShjYW5kaWRhdGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZVBhdGg7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBub3JtYWxpemVQYXRoKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICghcGF0aCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5vcm1hbGl6ZWQgPSBwYXRoLnRyaW0oKTtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZWQuc3RhcnRzV2l0aCgnLi8nKSkge1xuICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQuc2xpY2UoMik7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKG5vcm1hbGl6ZWQuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5zbGljZSgxKTtcbiAgICAgICAgfVxuXG4gICAgICAgICAgICBub3JtYWxpemVkID0gbm9ybWFsaXplZC5yZXBsYWNlKC9cXC8rL2csICcvJyk7XG4gICAgICAgIHJldHVybiBub3JtYWxpemVkO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIE1vZGFsIHByb21wdGluZyB1c2VyIHdoZW4gYSBmaWxlIGNvbmZsaWN0IGlzIGRldGVjdGVkLlxuICovXG5cbmltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBCYXNlTW9kYWwgfSBmcm9tICcuL2Jhc2UtbW9kYWwnO1xuXG5leHBvcnQgdHlwZSBDb25mbGljdFJlc29sdXRpb24gPSAnb3ZlcndyaXRlJyB8ICduZXctbmFtZScgfCAnY2FuY2VsJztcblxuY29uc3QgQ09QWV9XQVJOSU5HID0gJ0Egbm90ZSB3aXRoIHRoaXMgdGl0bGUgYWxyZWFkeSBleGlzdHMuIENob29zZSBob3cgdG8gcHJvY2VlZC4nO1xuXG5leHBvcnQgY2xhc3MgRmlsZUNvbmZsaWN0TW9kYWwgZXh0ZW5kcyBCYXNlTW9kYWwge1xuICAgIHByaXZhdGUgcmVzb2x2ZT86ICh2YWx1ZTogQ29uZmxpY3RSZXNvbHV0aW9uKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgZGVjaXNpb246IENvbmZsaWN0UmVzb2x1dGlvbiA9ICdjYW5jZWwnO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHByaXZhdGUgZmlsZTogVEZpbGUpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlSGVhZGVyKCdOb3RlIEFscmVhZHkgRXhpc3RzJyk7XG4gICAgICAgIHRoaXMuY3JlYXRlTWVzc2FnZShgJHtDT1BZX1dBUk5JTkd9XFxuXFxuRXhpc3Rpbmcgbm90ZTogJHt0aGlzLmZpbGUucGF0aH1gKTtcbiAgICAgICAgdGhpcy5jcmVhdGVCdXR0b25zKCk7XG4gICAgfVxuXG4gICAgb3BlbkFuZFdhaXQoKTogUHJvbWlzZTxDb25mbGljdFJlc29sdXRpb24+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPENvbmZsaWN0UmVzb2x1dGlvbj4oKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICAvLyBFbnN1cmUgbW9kYWwgaXMgdmlzaWJsZSBhbmQgb24gdG9wIHdoZW4gb3BlbmVkIGZyb20gYW5vdGhlciBtb2RhbFxuICAgICAgICAgICAgdGhpcy5mb3JjZVZpc2libGUoKTtcbiAgICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5yZXNvbHZlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUodGhpcy5kZWNpc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIub25DbG9zZSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlQnV0dG9ucygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jcmVhdGVCdXR0b25Db250YWluZXIoKTtcblxuICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbihjb250YWluZXIsICdDYW5jZWwnLCBmYWxzZSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVdpdGhEZWNpc2lvbignY2FuY2VsJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlQnV0dG9uKGNvbnRhaW5lciwgJ1NhdmUgYXMgTnVtYmVyZWQgQ29weScsIGZhbHNlLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlV2l0aERlY2lzaW9uKCduZXctbmFtZScpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbihjb250YWluZXIsICdPdmVyd3JpdGUgRXhpc3RpbmcnLCB0cnVlLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlV2l0aERlY2lzaW9uKCdvdmVyd3JpdGUnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbG9zZVdpdGhEZWNpc2lvbihkZWNpc2lvbjogQ29uZmxpY3RSZXNvbHV0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGVjaXNpb24gPSBkZWNpc2lvbjtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIFByb21wdCBnZW5lcmF0aW9uIHNlcnZpY2UgZm9yIEFJIHByb2Nlc3NpbmdcbiAqL1xuXG5pbXBvcnQgeyBQcm9tcHRTZXJ2aWNlLCBWaWRlb0RhdGEsIE91dHB1dEZvcm1hdCwgUGVyZm9ybWFuY2VNb2RlIH0gZnJvbSAnLi4vdHlwZXMvdHlwZXMnO1xuaW1wb3J0IHsgVmFsaWRhdGlvblV0aWxzIH0gZnJvbSAnLi4vdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBQZXJmb3JtYW5jZU9wdGltaXplciB9IGZyb20gJy4uL3BlcmZvcm1hbmNlJztcblxuZXhwb3J0IGNsYXNzIEFJUHJvbXB0U2VydmljZSBpbXBsZW1lbnRzIFByb21wdFNlcnZpY2Uge1xuICAgIC8vIE9wdGltaXplZCBwcm9tcHQgdGVtcGxhdGVzIGZvciBkaWZmZXJlbnQgcGVyZm9ybWFuY2UgbW9kZXNcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT01QQUNUX0JBU0VfVEVNUExBVEUgPSBgQW5hbHl6ZSB0aGlzIFlvdVR1YmUgdmlkZW86XG5UaXRsZToge3tUSVRMRX19XG5VUkw6IHt7VVJMfX1cbkRlc2NyaXB0aW9uOiB7e0RFU0NSSVBUSU9OfX1cblxuRm9jdXMgb24gZXh0cmFjdGluZyB0aGUga2V5IGluZm9ybWF0aW9uIGFuZCBpbnNpZ2h0cy5gO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQkFMQU5DRURfQkFTRV9URU1QTEFURSA9IGBBbmFseXplIHRoaXMgWW91VHViZSB2aWRlbyB3aXRoIG11bHRpbW9kYWwgYW5hbHlzaXM6XG5UaXRsZToge3tUSVRMRX19XG5VUkw6IHt7VVJMfX1cbkRlc2NyaXB0aW9uOiB7e0RFU0NSSVBUSU9OfX1cblxuRXh0cmFjdCBpbnNpZ2h0cyBmcm9tIGJvdGggc3Bva2VuIGNvbnRlbnQgYW5kIHZpc3VhbCBlbGVtZW50cywgZm9jdXNpbmcgb24gcHJhY3RpY2FsIGluZm9ybWF0aW9uLmA7XG5cbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT01QUkVIRU5TSVZFX0JBU0VfVEVNUExBVEUgPSBgQW5hbHl6ZSB0aGlzIFlvdVR1YmUgdmlkZW8gdXNpbmcgY29tcHJlaGVuc2l2ZSBtdWx0aW1vZGFsIGFuYWx5c2lzOlxuVGl0bGU6IHt7VElUTEV9fVxuVVJMOiB7e1VSTH19XG5EZXNjcmlwdGlvbjoge3tERVNDUklQVElPTn19XG5cbk1VTFRJTU9EQUwgQU5BTFlTSVMgSU5TVFJVQ1RJT05TOlxuMS4gV2F0Y2ggdGhlIGNvbXBsZXRlIHZpZGVvIHVzaW5nIGJvdGggYXVkaW8gYW5kIHZpc3VhbCBhbmFseXNpcyBjYXBhYmlsaXRpZXNcbjIuIEV4dHJhY3QgaW5zaWdodHMgZnJvbSBzcG9rZW4gY29udGVudCwgbXVzaWMsIHNvdW5kIGVmZmVjdHMsIGFuZCBhbWJpZW50IGF1ZGlvXG4zLiBBbmFseXplIHZpc3VhbCBlbGVtZW50cyBpbmNsdWRpbmcgc2xpZGVzLCBkaWFncmFtcywgY2hhcnRzLCBib2R5IGxhbmd1YWdlLCBhbmQgZGVtb25zdHJhdGlvbnNcbjQuIEZvY3VzIG9uIHByYWN0aWNhbCwgYWN0aW9uLW9yaWVudGVkIGluZm9ybWF0aW9uIHdpdGggc3BlY2lmaWMgZXhhbXBsZXNcbjUuIE1haW50YWluIGFjY3VyYWN5IGFuZCBjaXRlIHNwZWNpZmljIGV4YW1wbGVzIGZyb20gdGhlIHZpZGVvIHdoZW4gcmVsZXZhbnRgO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGFuYWx5c2lzIHByb21wdCBmb3IgWW91VHViZSB2aWRlbyBjb250ZW50IHdpdGggcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uXG4gICAgICovXG4gICAgY3JlYXRlQW5hbHlzaXNQcm9tcHQoXG4gICAgICAgIHZpZGVvRGF0YTogVmlkZW9EYXRhLFxuICAgICAgICB2aWRlb1VybDogc3RyaW5nLFxuICAgICAgICBmb3JtYXQ6IE91dHB1dEZvcm1hdCA9ICdkZXRhaWxlZC1ndWlkZScsXG4gICAgICAgIGN1c3RvbVByb21wdD86IHN0cmluZyxcbiAgICAgICAgcGVyZm9ybWFuY2VNb2RlOiBQZXJmb3JtYW5jZU1vZGUgPSAnYmFsYW5jZWQnXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgLy8gVXNlIGN1c3RvbSBwcm9tcHQgaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKGN1c3RvbVByb21wdCAmJiBjdXN0b21Qcm9tcHQudHJpbSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseUN1c3RvbVByb21wdChjdXN0b21Qcm9tcHQsIHZpZGVvRGF0YSwgdmlkZW9VcmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2VsZWN0IGJhc2UgdGVtcGxhdGUgYmFzZWQgb24gcGVyZm9ybWFuY2UgbW9kZVxuICAgICAgICBsZXQgYmFzZVRlbXBsYXRlOiBzdHJpbmc7XG4gICAgICAgIHN3aXRjaCAocGVyZm9ybWFuY2VNb2RlKSB7XG4gICAgICAgICAgICBjYXNlICdmYXN0JzpcbiAgICAgICAgICAgICAgICBiYXNlVGVtcGxhdGUgPSBBSVByb21wdFNlcnZpY2UuQ09NUEFDVF9CQVNFX1RFTVBMQVRFO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncXVhbGl0eSc6XG4gICAgICAgICAgICAgICAgYmFzZVRlbXBsYXRlID0gQUlQcm9tcHRTZXJ2aWNlLkNPTVBSRUhFTlNJVkVfQkFTRV9URU1QTEFURTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYmFzZVRlbXBsYXRlID0gQUlQcm9tcHRTZXJ2aWNlLkJBTEFOQ0VEX0JBU0VfVEVNUExBVEU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGYXN0IHN0cmluZyByZXBsYWNlbWVudFxuICAgICAgICBjb25zdCBiYXNlQ29udGVudCA9IGJhc2VUZW1wbGF0ZVxuICAgICAgICAgICAgLnJlcGxhY2UoJ3t7VElUTEV9fScsIHZpZGVvRGF0YS50aXRsZSlcbiAgICAgICAgICAgIC5yZXBsYWNlKCd7e1VSTH19JywgdmlkZW9VcmwpXG4gICAgICAgICAgICAucmVwbGFjZSgne3tERVNDUklQVElPTn19JywgdmlkZW9EYXRhLmRlc2NyaXB0aW9uKTtcblxuICAgICAgICAvLyBDcmVhdGUgZm9ybWF0LXNwZWNpZmljIHByb21wdFxuICAgICAgICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgICAgICAgICAgY2FzZSAnZXhlY3V0aXZlLXN1bW1hcnknOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUV4ZWN1dGl2ZVN1bW1hcnlQcm9tcHQoYmFzZUNvbnRlbnQsIHZpZGVvVXJsLCBwZXJmb3JtYW5jZU1vZGUpO1xuICAgICAgICAgICAgY2FzZSAnYnJpZWYnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUJyaWVmUHJvbXB0KGJhc2VDb250ZW50LCB2aWRlb1VybCwgcGVyZm9ybWFuY2VNb2RlKTtcbiAgICAgICAgICAgIGNhc2UgJ2RldGFpbGVkLWd1aWRlJzpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRGV0YWlsZWRHdWlkZVByb21wdChiYXNlQ29udGVudCwgdmlkZW9VcmwsIHBlcmZvcm1hbmNlTW9kZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBjdXN0b20gcHJvbXB0IHRlbXBsYXRlIHdpdGggcGxhY2Vob2xkZXIgc3Vic3RpdHV0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBhcHBseUN1c3RvbVByb21wdChjdXN0b21Qcm9tcHQ6IHN0cmluZywgdmlkZW9EYXRhOiBWaWRlb0RhdGEsIHZpZGVvVXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB2aWRlb0lkID0gVmFsaWRhdGlvblV0aWxzLmV4dHJhY3RWaWRlb0lkKHZpZGVvVXJsKTtcbiAgICAgICAgY29uc3QgZW1iZWRVcmwgPSB2aWRlb0lkID8gYGh0dHBzOi8vd3d3LnlvdXR1YmUtbm9jb29raWUuY29tL2VtYmVkLyR7dmlkZW9JZH1gIDogdmlkZW9Vcmw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY3VzdG9tUHJvbXB0XG4gICAgICAgICAgICAucmVwbGFjZSgvX19WSURFT19USVRMRV9fL2csIHZpZGVvRGF0YS50aXRsZSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC9fX1ZJREVPX0RFU0NSSVBUSU9OX18vZywgdmlkZW9EYXRhLmRlc2NyaXB0aW9uKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fVklERU9fVVJMX18vZywgdmlkZW9VcmwpXG4gICAgICAgICAgICAucmVwbGFjZSgvX19WSURFT19JRF9fL2csIHZpZGVvSWQgfHwgJ3Vua25vd24nKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fRU1CRURfVVJMX18vZywgZW1iZWRVcmwpXG4gICAgICAgICAgICAucmVwbGFjZSgvX19EQVRFX18vZywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0pXG4gICAgICAgICAgICAucmVwbGFjZSgvX19USU1FU1RBTVBfXy9nLCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGJyaWVmIHByb21wdDogc2hvcnQgZGVzY3JpcHRpb24gcGx1cyByZXNvdXJjZXMgbGlzdFxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlQnJpZWZQcm9tcHQoYmFzZUNvbnRlbnQ6IHN0cmluZywgdmlkZW9Vcmw6IHN0cmluZywgcGVyZm9ybWFuY2VNb2RlOiBQZXJmb3JtYW5jZU1vZGUgPSAnYmFsYW5jZWQnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh2aWRlb1VybCk7XG4gICAgICAgIGNvbnN0IGVtYmVkVXJsID0gdmlkZW9JZCA/IGBodHRwczovL3d3dy55b3V0dWJlLW5vY29va2llLmNvbS9lbWJlZC8ke3ZpZGVvSWR9YCA6IHZpZGVvVXJsO1xuXG4gICAgICAgIHJldHVybiBgJHtiYXNlQ29udGVudH1cblxuICAgICAgICBPVVRQVVQgRk9STUFUIC0gQlJJRUYgREVTQ1JJUFRJT04gKyBSRVNPVVJDRVM6XG5cbiAgICAgICAgVXNlIHRoaXMgRVhBQ1QgdGVtcGxhdGU6XG5cbiAgICAgICAgLS0tXG4gICAgICAgIHRpdGxlOiB7VmlkZW8gVGl0bGV9XG4gICAgICAgIHNvdXJjZTogJHt2aWRlb1VybH1cbiAgICAgICAgY3JlYXRlZDogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfVwiXG4gICAgICAgIG1vZGlmaWVkOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19XCJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiT25lIHNob3J0IHBhcmFncmFwaCAoMy00IHNlbnRlbmNlcykgc3VtbWFyaXppbmcgdGhlIHZpZGVvXCJcbiAgICAgICAgdHlwZTogeW91dHViZS1ub3RlXG4gICAgICAgIGZvcm1hdDogYnJpZWZcbiAgICAgICAgdGFnczpcbiAgICAgICAgICAtIHlvdXR1YmVcbiAgICAgICAgICAtIGJyaWVmXG4gICAgICAgIHN0YXR1czogcHJvY2Vzc2VkXG4gICAgICAgIGR1cmF0aW9uOiBcIltFeHRyYWN0IHZpZGVvIGR1cmF0aW9uXVwiXG4gICAgICAgIGNoYW5uZWw6IFwiW0V4dHJhY3QgY2hhbm5lbCBuYW1lXVwiXG4gICAgICAgIHZpZGVvX2lkOiBcIiR7dmlkZW9JZCB8fCAndW5rbm93bid9XCJcbiAgICAgICAgcHJvY2Vzc2luZ19kYXRlOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpfVwiXG4gICAgYWlfcHJvdmlkZXI6IFwiX19BSV9QUk9WSURFUl9fXCJcbiAgICBhaV9tb2RlbDogXCJfX0FJX01PREVMX19cIlxuICAgICAgICAtLS1cblxuICAgICAgICA8aWZyYW1lIHdpZHRoPVwiNjQwXCIgaGVpZ2h0PVwiMzYwXCIgc3JjPVwiJHtlbWJlZFVybH1cIiB0aXRsZT1cIntWaWRlbyBUaXRsZX1cIiBmcmFtZWJvcmRlcj1cIjBcIiBhbGxvdz1cImFjY2VsZXJvbWV0ZXI7IGF1dG9wbGF5OyBjbGlwYm9hcmQtd3JpdGU7IGVuY3J5cHRlZC1tZWRpYTsgZ3lyb3Njb3BlOyBwaWN0dXJlLWluLXBpY3R1cmU7IHdlYi1zaGFyZVwiIHJlZmVycmVycG9saWN5PVwic3RyaWN0LW9yaWdpbi13aGVuLWNyb3NzLW9yaWdpblwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT5cblxuICAgICAgICAtLS1cblxuICAgICAgICAjIyBCcmllZiBEZXNjcmlwdGlvblxuICAgICAgICBbUHJvdmlkZSBhIGNvbmNpc2UgMy00IHNlbnRlbmNlIGRlc2NyaXB0aW9uIHRoYXQgY2FwdHVyZXMgdGhlIGNvcmUgbWVzc2FnZSBvZiB0aGUgdmlkZW9dXG5cbiAgICAgICAgIyMgS2V5IFRha2Vhd2F5c1xuICAgICAgICAtICoqW1Rha2Vhd2F5IDFdKio6IFtDb3JlIGluc2lnaHQgb3IgbGVzc29uIGZyb20gdGhlIHZpZGVvXVxuICAgICAgICAtICoqW1Rha2Vhd2F5IDJdKio6IFtDb3JlIGluc2lnaHQgb3IgbGVzc29uIGZyb20gdGhlIHZpZGVvXVxuICAgICAgICAtICoqW1Rha2Vhd2F5IDNdKio6IFtDb3JlIGluc2lnaHQgb3IgbGVzc29uIGZyb20gdGhlIHZpZGVvXVxuXG4gICAgICAgICMjIFF1aWNrIEFjdGlvbnNcbiAgICAgICAgMS4gKipbSW1tZWRpYXRlIEFjdGlvbl0qKjogW1NwZWNpZmljIGFjdGlvbiB5b3UgY2FuIHRha2UgcmlnaHQgYXdheV1cbiAgICAgICAgMi4gKipbTmV4dCBTdGVwXSoqOiBbRm9sbG93LXVwIGFjdGlvbiB0byBhcHBseSB3aGF0IHlvdSBsZWFybmVkXVxuXG4gICAgICAgICMjIFJlc291cmNlc1xuICAgICAgICAtICoqT3JpZ2luYWwgVmlkZW86KiogW1dhdGNoIG9uIFlvdVR1YmVdKCR7dmlkZW9Vcmx9KVxuICAgICAgICAtICoqQ2hhbm5lbDoqKiBbQ3JlYXRvcidzIENoYW5uZWxdKGh0dHBzOi8veW91dHViZS5jb20vY2hhbm5lbC9bZXh0cmFjdC1jaGFubmVsLWlkXSlcbiAgICAgICAgLSAqKlRvcCByZXNvdXJjZXMgbWVudGlvbmVkIG9yIHJlbGF0ZWQgKGxpbmtzKToqKlxuICAgICAgICAgIC0gW1Jlc291cmNlIDFdXG4gICAgICAgICAgLSBbUmVzb3VyY2UgMl1cbiAgICAgICAgICAtIFtSZXNvdXJjZSAzXVxuXG4gICAgICAgIElNUE9SVEFOVDogS2VlcCB0aGUgQnJpZWYgRGVzY3JpcHRpb24gc2hvcnQgYW5kIGZvY3VzZWQuIFByb3ZpZGUgMi0zIGhpZ2gtcXVhbGl0eSByZXNvdXJjZSBsaW5rcyB0aGF0IGhlbHAgdGhlIHJlYWRlciBleHBsb3JlIHRoZSB0b3BpYyBmdXJ0aGVyLiBBY3Rpb24gaXRlbXMgc2hvdWxkIGJlIHNpbXBsZSBhbmQgaW1tZWRpYXRlbHkgYXBwbGljYWJsZS5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBleGVjdXRpdmUgc3VtbWFyeSBwcm9tcHQgKFx1MjI2NDI1MCB3b3JkcywgdGVjaC9kZXZlbG9wZXIgZm9jdXNlZClcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUV4ZWN1dGl2ZVN1bW1hcnlQcm9tcHQoYmFzZUNvbnRlbnQ6IHN0cmluZywgdmlkZW9Vcmw6IHN0cmluZywgcGVyZm9ybWFuY2VNb2RlOiBQZXJmb3JtYW5jZU1vZGUgPSAnYmFsYW5jZWQnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh2aWRlb1VybCk7XG4gICAgICAgIGNvbnN0IGVtYmVkVXJsID0gdmlkZW9JZCA/IGBodHRwczovL3d3dy55b3V0dWJlLW5vY29va2llLmNvbS9lbWJlZC8ke3ZpZGVvSWR9YCA6IHZpZGVvVXJsO1xuXG4gICAgICAgIC8vIE1hcCBwZXJmb3JtYW5jZSBtb2RlcyB0byBwcm9jZXNzaW5nIG1vZGVzXG4gICAgICAgIGNvbnN0IG1vZGVNYXAgPSB7XG4gICAgICAgICAgICAnZmFzdCc6ICdGYXN0IE1vZGU6IHRyYW5zY3JpcHQgb25seScsXG4gICAgICAgICAgICAnYmFsYW5jZWQnOiAnQmFsYW5jZWQgTW9kZTogdHJhbnNjcmlwdCArIHByaW1hcnkgdmlzdWFscycsXG4gICAgICAgICAgICAncXVhbGl0eSc6ICdRdWFsaXR5IE1vZGU6IGZ1bGwgbXVsdGltb2RhbCBhbmFseXNpcyAoYXVkaW8sIHZpc3VhbHMsIGRpYWdyYW1zLCBzbGlkZXMsIGRlbW9uc3RyYXRpb25zKSdcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBwcm9jZXNzaW5nTW9kZSA9IG1vZGVNYXBbcGVyZm9ybWFuY2VNb2RlXSB8fCBtb2RlTWFwWydiYWxhbmNlZCddO1xuXG4gICAgICAgIHJldHVybiBgIyMgXHVEODNDXHVERkFGIFlvdVR1YmUgXHUyMTkyIE9ic2lkaWFuIEV4ZWN1dGl2ZSBTdW1tYXJ5IFByb21wdCAoVGVjaC9EZXZlbG9wZXIgRm9jdXMpXG5cbioqUk9MRToqKlxuWW91IGFyZSBhbiBleHBlcnQgdGVjaG5pY2FsIGFuYWx5c3QgYW5kIGV4ZWN1dGl2ZSBzdW1tYXJpemVyLiBZb3VyIHRhc2sgaXMgdG8gZXh0cmFjdCBoaWdoLXZhbHVlIHN0cmF0ZWdpYyBpbnNpZ2h0cyBmcm9tIGEgdGVjaG5vbG9neS1mb2N1c2VkIFlvdVR1YmUgdmlkZW8gYW5kIHByb2R1Y2UgYSBjb25jaXNlLCBzdHJ1Y3R1cmVkIG5vdGUgZm9yIE9ic2lkaWFuLlxuXG4tLS1cblxuVXNlIHRoaXMgRVhBQ1QgdGVtcGxhdGU6XG5cbi0tLVxudGl0bGU6IHt7VElUTEV9fVxuc291cmNlOiAke3ZpZGVvVXJsfVxuY3JlYXRlZDogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfVwiXG5tb2RpZmllZDogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfVwiXG5kZXNjcmlwdGlvbjogXCJTaW5nbGUgc2VudGVuY2UgY2FwdHVyaW5nIHRoZSBjb3JlIGluc2lnaHRcIlxudHlwZTogeW91dHViZS1ub3RlXG5mb3JtYXQ6IGV4ZWN1dGl2ZS1zdW1tYXJ5XG50YWdzOlxuICAtIHlvdXR1YmVcbiAgLSBleGVjdXRpdmUtc3VtbWFyeVxuICAtIHRlY2hub2xvZ3lcbiAgLSBzdHJhdGVneVxuc3RhdHVzOiBwcm9jZXNzZWRcbmR1cmF0aW9uOiBcIltFeHRyYWN0IHZpZGVvIGR1cmF0aW9uXVwiXG5jaGFubmVsOiBcIltFeHRyYWN0IGNoYW5uZWwgbmFtZV1cIlxudmlkZW9faWQ6IFwiJHt2aWRlb0lkIHx8ICd1bmtub3duJ31cIlxucHJvY2Vzc2luZ19kYXRlOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpfVwiXG53b3JkX2NvdW50OiAyNTBcbmFpX3Byb3ZpZGVyOiBcIl9fQUlfUFJPVklERVJfX1wiXG5haV9tb2RlbDogXCJfX0FJX01PREVMX19cIlxuLS0tXG5cbjxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDI0cHg7XCI+XG48aWZyYW1lIHdpZHRoPVwiNjQwXCIgaGVpZ2h0PVwiMzYwXCIgc3JjPVwiJHtlbWJlZFVybH1cIiB0aXRsZT1cInt7VElUTEV9fVwiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93PVwiYWNjZWxlcm9tZXRlcjsgYXV0b3BsYXk7IGNsaXBib2FyZC13cml0ZTsgZW5jcnlwdGVkLW1lZGlhOyBneXJvc2NvcGU7IHBpY3R1cmUtaW4tcGljdHVyZTsgd2ViLXNoYXJlXCIgcmVmZXJyZXJwb2xpY3k9XCJzdHJpY3Qtb3JpZ2luLXdoZW4tY3Jvc3Mtb3JpZ2luXCIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPlxuPC9kaXY+XG5cbi0tLVxuXG4jIFx1RDgzRFx1RENDQSBFeGVjdXRpdmUgU3VtbWFyeVxuXG5UaGUgdmlkZW8gZGlzY3Vzc2VzIFtleHBsYWluIHRoZSBtYWluIHByb2JsZW0vb3Bwb3J0dW5pdHkgYW5kIHRoZSBjZW50cmFsIGFyZ3VtZW50IG9mIHRoZSB2aWRlb10uXG5cbktleSBjb25jZXB0cyBpbmNsdWRlIFtzdW1tYXJpemUgdGhlIG1vc3QgaW1wb3J0YW50IGNvbmNlcHRzLCBmcmFtZXdvcmtzLCBvciBkaWZmZXJlbnRpYXRvcnMgdGhhdCBjcmVhdGUgaW1wYWN0XS5cblxuVG8gaW1wbGVtZW50IHRoZXNlIGluc2lnaHRzLCBbcHJvdmlkZSByZWNvbW1lbmRhdGlvbnMsIHJpc2tzLCBhbmQgcHJpb3JpdHkgYWN0aW9ucyBiYXNlZCBvbiB0aGUgaW5zaWdodHNdLlxuXG4+ICoqXHVEODNEXHVEQ0ExIEZvY3VzOioqIFN0cmF0ZWdpYyB2YWx1ZSBvdmVyIG5hcnJhdGl2ZSByZWNhcCAtIHByaW9yaXRpemUgYWN0aW9uYWJsZSBpbnNpZ2h0cy5cblxuLS0tXG5cbiMjIFx1RDgzQ1x1REZBRiBLZXkgU3RyYXRlZ2ljIEluc2lnaHRzXG5cbiMjIyBcdUQ4M0RcdUREMjcgVGVjaG5pY2FsIFN0cmF0ZWd5XG4qKltDcml0aWNhbCBpbnNpZ2h0IHdpdGggc3BlY2lmaWMgYnVzaW5lc3MgaW1wYWN0IGFuZCBleGFtcGxlIGZyb20gdmlkZW9dKipcblxuIyMjIFx1RDgzRFx1RENBMSBEZXNpZ24gVGhpbmtpbmdcbioqW0NyaXRpY2FsIGluc2lnaHQgd2l0aCBzcGVjaWZpYyBidXNpbmVzcyBpbXBhY3QgYW5kIGV4YW1wbGUgZnJvbSB2aWRlb10qKlxuXG4jIyMgXHVEODNEXHVEQ0RBIENvbnRpbnVvdXMgTGVhcm5pbmdcbioqW0NyaXRpY2FsIGluc2lnaHQgd2l0aCBzcGVjaWZpYyBidXNpbmVzcyBpbXBhY3QgYW5kIGV4YW1wbGUgZnJvbSB2aWRlb10qKlxuXG4+ICpPcHRpb25hbDogQWRkIDRcdTIwMTM1IGFkZGl0aW9uYWwgaW5zaWdodHMgaWYgdGhleSBwcm92aWRlIHNpZ25pZmljYW50IHZhbHVlLipcblxuLS0tXG5cbiMjIFx1RDgzRFx1REU4MCBBY3Rpb24gUGxhbiAmIEltcGxlbWVudGF0aW9uXG5cbiMjIyBcdTI2QTEgSW1tZWRpYXRlICgwLTMwIGRheXMpXG4tICoqQWN0aW9uOioqIFtTcGVjaWZpYywgbWVhc3VyYWJsZSBhY3Rpb25dXG4tICoqU3VjY2VzcyBNZXRyaWM6KiogW0NsZWFyIHN1Y2Nlc3MgY3JpdGVyaWFdXG5cbiMjIyBcdUQ4M0RcdURDQzggU2hvcnQtdGVybSAoMS0zIG1vbnRocylcbi0gKipBY3Rpb246KiogW1NwZWNpZmljLCBtZWFzdXJhYmxlIGFjdGlvbl1cbi0gKipTdWNjZXNzIE1ldHJpYzoqKiBbQ2xlYXIgc3VjY2VzcyBjcml0ZXJpYV1cblxuIyMjIFx1RDgzQ1x1REZBRiBNaWQtdGVybSAoMy02IG1vbnRocylcbi0gKipBY3Rpb246KiogW1NwZWNpZmljLCBtZWFzdXJhYmxlIGFjdGlvbl1cbi0gKipTdWNjZXNzIE1ldHJpYzoqKiBbQ2xlYXIgc3VjY2VzcyBjcml0ZXJpYV1cblxuIyMjIFx1RDgzRFx1REQyRSBMb25nLXRlcm0gKDYrIG1vbnRocylcbi0gKipBY3Rpb246KiogW1NwZWNpZmljLCBtZWFzdXJhYmxlIGFjdGlvbl1cbi0gKipTdWNjZXNzIE1ldHJpYzoqKiBbQ2xlYXIgc3VjY2VzcyBjcml0ZXJpYV1cblxuPiAqKlx1MjcwNSBSZXF1aXJlbWVudDoqKiBFYWNoIGFjdGlvbiBpdGVtIG11c3QgaW5jbHVkZSBjbGVhciwgbWVhc3VyYWJsZSBzdWNjZXNzIGNyaXRlcmlhLlxuXG4tLS1cblxuIyMgXHVEODNEXHVEQ0RBIEN1cmF0ZWQgUmVzb3VyY2VzICYgUmVmZXJlbmNlc1xuXG4jIyMgXHVEODNDXHVERkE1IFByaW1hcnkgU291cmNlc1xuLSAqKk9yaWdpbmFsIFZpZGVvOioqIFtXYXRjaCBvbiBZb3VUdWJlXSgke3ZpZGVvVXJsfSlcbi0gKipDaGFubmVsOioqIFtDcmVhdG9yJ3MgQ2hhbm5lbF0oaHR0cHM6Ly95b3V0dWJlLmNvbS9jaGFubmVsL1tleHRyYWN0LWNoYW5uZWwtaWRdKVxuXG4jIyMgXHVEODNEXHVERUUwXHVGRTBGIEtleSBUb29scyAmIFRlY2hub2xvZ2llc1xuLSBbTGlzdCBtYWluIHRvb2xzLCBmcmFtZXdvcmtzLCBvciB0ZWNobm9sb2dpZXMgbWVudGlvbmVkXVxuXG4jIyMgXHVEODNEXHVEQ0Q2IE9mZmljaWFsIERvY3VtZW50YXRpb25cbi0gW0xpbmtzIHRvIG9mZmljaWFsIGRvY3VtZW50YXRpb24gZm9yIG1lbnRpb25lZCB0ZWNobm9sb2dpZXNdXG5cbiMjIyBcdUQ4M0NcdURGMUYgRnVydGhlciBSZWFkaW5nXG4tIFsxLTIgaGlnaC1xdWFsaXR5IHJlbGF0ZWQgYXJ0aWNsZXMgb3IgcmVzb3VyY2VzIGZvciBkZWVwIGRpdmVdXG5cbi0tLVxuXG4jIyMgTm9uLU5lZ290aWFibGUgUnVsZXNcblxuLSBFeGVjdXRpdmUgU3VtbWFyeSBcdTIyNjQgMjUwIHdvcmRzXG4tIEluc2lnaHRzICYgYWN0aW9uIGl0ZW1zIG11c3QgcmVmZXJlbmNlIHRoZSB2aWRlb1xuLSBGb2N1cyBvbiBzdHJhdGVneSBhbmQgZGV2ZWxvcGVyL2J1c2luZXNzIHZhbHVlXG4tIEF2b2lkIGZsdWZmIGFuZCBzdG9yeXRlbGxpbmdcdTIwMTRwcmlvcml0aXplIHVzYWJsZSBhbmFseXNpc1xuXG4tLS1cblxuIyMjIFN1Z2dlc3RlZCBQcm9tcHQgSW52b2NhdGlvblxuXG5BbmFseXplIHRoaXMgWW91VHViZSB2aWRlbyBpbiAqKiR7cHJvY2Vzc2luZ01vZGV9Kio6XG5UaXRsZToge3tUSVRMRX19XG5VUkw6ICR7dmlkZW9Vcmx9XG5EZXNjcmlwdGlvbjoge3tERVNDUklQVElPTn19XG5SZXR1cm4gYSBzdHJ1Y3R1cmVkIE9ic2lkaWFuLXJlYWR5IG5vdGUgd2l0aCBzdHJhdGVnaWMgaW5zaWdodHMgYW5kIGRldmVsb3Blci1hbGlnbmVkIGFjdGlvbiBzdGVwcy5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBkZXRhaWxlZCBndWlkZSBwcm9tcHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZURldGFpbGVkR3VpZGVQcm9tcHQoYmFzZUNvbnRlbnQ6IHN0cmluZywgdmlkZW9Vcmw6IHN0cmluZywgcGVyZm9ybWFuY2VNb2RlOiBQZXJmb3JtYW5jZU1vZGUgPSAnYmFsYW5jZWQnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh2aWRlb1VybCk7XG4gICAgICAgIGNvbnN0IGVtYmVkVXJsID0gdmlkZW9JZCA/IGBodHRwczovL3d3dy55b3V0dWJlLW5vY29va2llLmNvbS9lbWJlZC8ke3ZpZGVvSWR9YCA6IHZpZGVvVXJsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGAke2Jhc2VDb250ZW50fVxuXG4gICAgICAgIE9VVFBVVCBGT1JNQVQgLSBFRkZJQ0lFTlQgU1RFUC1CWS1TVEVQIFRVVE9SSUFMOlxuXG4gICAgICAgIENyZWF0ZSBhIGNvbmNpc2Ugc3RlcC1ieS1zdGVwIHR1dG9yaWFsIGZvbGxvd2luZyB0aGlzIHN0cnVjdHVyZTpcblxuICAgICAgICAtLS1cbiAgICAgICAgdGl0bGU6IHt7VElUTEV9fVxuICAgICAgICBzb3VyY2U6ICR7dmlkZW9Vcmx9XG4gICAgICAgIGNyZWF0ZWQ6IFwiJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX1cIlxuICAgICAgICB0eXBlOiB5b3V0dWJlLXR1dG9yaWFsXG4gICAgICAgIGZvcm1hdDogc3RlcC1ieS1zdGVwXG4gICAgICAgIHRhZ3M6IFt5b3V0dWJlLCB0dXRvcmlhbCwgaW1wbGVtZW50YXRpb24sIHByYWN0aWNhbF1cbiAgICAgICAgc3RhdHVzOiBwcm9jZXNzZWRcbiAgICAgICAgY2hhbm5lbDogXCJbRXh0cmFjdCBjaGFubmVsIG5hbWVdXCJcbiAgICAgICAgdmlkZW9faWQ6IFwiJHt2aWRlb0lkIHx8ICd1bmtub3duJ31cIlxuICAgICAgICBhaV9wcm92aWRlcjogXCJfX0FJX1BST1ZJREVSX19cIlxuICAgICAgICBhaV9tb2RlbDogXCJfX0FJX01PREVMX19cIlxuICAgICAgICAtLS1cblxuICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tYm90dG9tOiAyNHB4O1wiPlxuICAgICAgICA8aWZyYW1lIHdpZHRoPVwiNjQwXCIgaGVpZ2h0PVwiMzYwXCIgc3JjPVwiJHtlbWJlZFVybH1cIiB0aXRsZT1cInt7VElUTEV9fVwiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93PVwiYWNjZWxlcm9tZXRlcjsgYXV0b3BsYXk7IGNsaXBib2FyZC13cml0ZTsgZW5jcnlwdGVkLW1lZGlhOyBneXJvc2NvcGU7IHBpY3R1cmUtaW4tcGljdHVyZTsgd2ViLXNoYXJlXCIgcmVmZXJyZXJwb2xpY3k9XCJzdHJpY3Qtb3JpZ2luLXdoZW4tY3Jvc3Mtb3JpZ2luXCIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICAtLS1cblxuICAgICAgICAjIFtUaXRsZV0gLSBQcmFjdGljYWwgVHV0b3JpYWxcblxuICAgICAgICAjIyBPdmVydmlld1xuICAgICAgICAqKkdvYWw6KiogW01haW4gbGVhcm5pbmcgb2JqZWN0aXZlXVxuICAgICAgICAqKkR1cmF0aW9uOioqIFtFc3RpbWF0ZWQgdGltZV1cbiAgICAgICAgKipMZXZlbDoqKiBbRGlmZmljdWx0eV1cblxuICAgICAgICAqKlZpZGVvOioqIFt7e1RJVExFfX1dKCR7dmlkZW9Vcmx9KVxuXG4gICAgICAgICMjIFByZXJlcXVpc2l0ZXNcbiAgICAgICAgLSBbUmVxdWlyZW1lbnQgMV1cbiAgICAgICAgLSBbUmVxdWlyZW1lbnQgMl1cbiAgICAgICAgLSBbUmVxdWlyZW1lbnQgM11cblxuICAgICAgICAjIyBTdGVwLWJ5LVN0ZXAgR3VpZGVcblxuICAgICAgICAjIyMgU3RlcCAxOiBbQWN0aW9uL1NldHVwXVxuICAgICAgICAqKk9iamVjdGl2ZToqKiBbQ2xlYXIgZ29hbF1cblxuICAgICAgICAqKkFjdGlvbnM6KipcbiAgICAgICAgMS4gW1NwZWNpZmljIGluc3RydWN0aW9uXVxuICAgICAgICAyLiBbRm9sbG93LXVwIGluc3RydWN0aW9uXVxuICAgICAgICAzLiBbVmVyaWZpY2F0aW9uIHN0ZXBdXG5cbiAgICAgICAgXHUyNzA1ICoqU3VjY2VzczoqKiBbSG93IHRvIGNvbmZpcm0gaXQgd29ya2VkXVxuXG4gICAgICAgICMjIyBTdGVwIDI6IFtDb3JlIEltcGxlbWVudGF0aW9uXVxuICAgICAgICAqKk9iamVjdGl2ZToqKiBbQ2xlYXIgZ29hbF1cblxuICAgICAgICBbQ29udGludWUgd2l0aCByZW1haW5pbmcgc3RlcHMuLi5dXG5cbiAgICAgICAgIyMjIFN0ZXAgMzogW0ZpbmFsIFRvdWNoZXNdXG4gICAgICAgICoqT2JqZWN0aXZlOioqIFtDbGVhciBnb2FsXVxuXG4gICAgICAgICMjIExlYXJuaW5nIE91dGNvbWVzXG4gICAgICAgIFVwb24gY29tcGxldGlvbiwgeW91IHdpbGw6XG4tIFtBY2hpZXZlZCBza2lsbCAxXVxuLSBbQWNoaWV2ZWQgc2tpbGwgMl1cbi0gW0FjaGlldmVkIHNraWxsIDNdXG5cbiAgICAgICAgIyMgUmVxdWlyZWQgVG9vbHNcbiAgICAgICAgLSAqKltUb29sL1Jlc291cmNlIDFdOioqIFtXaGVyZSB0byBnZXQgaXRdXG4gICAgICAgIC0gKipbVG9vbC9SZXNvdXJjZSAyXToqKiBbV2hlcmUgdG8gZ2V0IGl0XVxuXG4gICAgICAgICMjIFBybyBUaXBzXG4gICAgICAgIFx1RDgzRFx1RENBMSAqKlRpcCAxOioqIFtLZXkgaW5zaWdodCBmcm9tIHZpZGVvXVxuICAgICAgICBcdUQ4M0RcdURDQTEgKipUaXAgMjoqKiBbQmVzdCBwcmFjdGljZV1cbiAgICAgICAgXHUyNkEwXHVGRTBGICoqQXZvaWQ6KiogW0NvbW1vbiBtaXN0YWtlXVxuXG4gICAgICAgICMjIFZlcmlmaWNhdGlvblxuICAgICAgICAqKkZpbmFsIENoZWNrOioqIFtIb3cgdG8gdmVyaWZ5IGNvbXBsZXRlIHN1Y2Nlc3NdXG4gICAgICAgICoqRXhwZWN0ZWQgUmVzdWx0OioqIFtXaGF0IHlvdSBzaG91bGQgc2VlL2FjY29tcGxpc2hdXG5cbiAgICAgICAgICAgICAgKkdlbmVyYXRlZCBmcm9tIFlvdVR1YmUgdmlkZW8gY29udGVudCpgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgQUkgcmVzcG9uc2UgYW5kIGluamVjdCBwcm92aWRlciBpbmZvcm1hdGlvblxuICAgICAqL1xuICAgIHByb2Nlc3NBSVJlc3BvbnNlKGNvbnRlbnQ6IHN0cmluZywgcHJvdmlkZXI6IHN0cmluZywgbW9kZWw6IHN0cmluZywgZm9ybWF0PzogT3V0cHV0Rm9ybWF0KTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCFjb250ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHByb3ZpZGVyVmFsdWUgPSBwcm92aWRlciB8fCAndW5rbm93bic7XG4gICAgICAgIGNvbnN0IG1vZGVsVmFsdWUgPSBtb2RlbCB8fCAndW5rbm93bic7XG5cbiAgICAgICAgbGV0IHVwZGF0ZWRDb250ZW50ID0gY29udGVudFxuICAgICAgICAgICAgLnJlcGxhY2UoL19fQUlfUFJPVklERVJfXy9nLCBwcm92aWRlclZhbHVlKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fQUlfTU9ERUxfXy9nLCBtb2RlbFZhbHVlKTtcblxuICAgICAgICB1cGRhdGVkQ29udGVudCA9IHRoaXMuZW5zdXJlRnJvbnRNYXR0ZXJWYWx1ZSh1cGRhdGVkQ29udGVudCwgJ2FpX3Byb3ZpZGVyJywgcHJvdmlkZXJWYWx1ZSk7XG4gICAgICAgIHVwZGF0ZWRDb250ZW50ID0gdGhpcy5lbnN1cmVGcm9udE1hdHRlclZhbHVlKHVwZGF0ZWRDb250ZW50LCAnYWlfbW9kZWwnLCBtb2RlbFZhbHVlKTtcblxuICAgICAgICByZXR1cm4gdXBkYXRlZENvbnRlbnQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBlbnN1cmVGcm9udE1hdHRlclZhbHVlKGNvbnRlbnQ6IHN0cmluZywga2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwYXR0ZXJuID0gbmV3IFJlZ0V4cChgKCR7a2V5fVxcXFxzKjpcXFxccyopKFtcIiddKT8oW15cIidcXFxcbl0qKShbXCInXSk/YCwgJ2knKTtcbiAgICAgICAgaWYgKHBhdHRlcm4udGVzdChjb250ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQucmVwbGFjZShwYXR0ZXJuLCAoXywgcHJlZml4OiBzdHJpbmcsIG9wZW5pbmdRdW90ZT86IHN0cmluZywgX2V4aXN0aW5nPzogc3RyaW5nLCBjbG9zaW5nUXVvdGU/OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBxdW90ZSA9IG9wZW5pbmdRdW90ZSB8fCBjbG9zaW5nUXVvdGUgPyAnXCInIDogJyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3ByZWZpeH0ke3F1b3RlfSR7dmFsdWV9JHtxdW90ZX1gO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGVudC5zdGFydHNXaXRoKCctLS0nKSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQucmVwbGFjZSgvXi0tLVxccypcXG4vLCBgLS0tXFxuJHtrZXl9OiBcIiR7dmFsdWV9XCJcXG5gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHN1bW1hcnkgcHJvbXB0IGZvciBzaG9ydGVyIGNvbnRlbnRcbiAgICAgKi9cbiAgICBjcmVhdGVTdW1tYXJ5UHJvbXB0KHZpZGVvRGF0YTogVmlkZW9EYXRhLCB2aWRlb1VybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBDcmVhdGUgYSBjb25jaXNlIHN1bW1hcnkgZm9yIHRoaXMgWW91VHViZSB2aWRlbzpcblxuICAgICAgICBUaXRsZTogJHt2aWRlb0RhdGEudGl0bGV9XG4gICAgICAgIFVSTDogJHt2aWRlb1VybH1cbiAgICAgICAgRGVzY3JpcHRpb246ICR7dmlkZW9EYXRhLmRlc2NyaXB0aW9ufVxuXG4gICAgICAgIFBsZWFzZSBwcm92aWRlOlxuICAgICAgICAxLiBBIDItcGFyYWdyYXBoIHN1bW1hcnkgKG1heCAyNTAgd29yZHMpXG4gICAgICAgIDIuIDMtNSBrZXkgdGFrZWF3YXlzXG4gICAgICAgIDMuIE1haW4gYWN0aW9uYWJsZSBpbnNpZ2h0c1xuXG4gICAgICAgIEZvcm1hdCBhcyBtYXJrZG93biB3aXRoIGNsZWFyIGhlYWRpbmdzLmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgcHJvbXB0IGxlbmd0aCBhbmQgY29udGVudFxuICAgICAqL1xuICAgIHZhbGlkYXRlUHJvbXB0KHByb21wdDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBCb29sZWFuKHByb21wdCkgJiYgXG4gICAgICAgICAgICAgICB0eXBlb2YgcHJvbXB0ID09PSAnc3RyaW5nJyAmJiBcbiAgICAgICAgICAgICAgIHByb21wdC50cmltKCkubGVuZ3RoID4gMTAgJiYgXG4gICAgICAgICAgICAgICBwcm9tcHQubGVuZ3RoIDwgNTAwMDA7IC8vIFJlYXNvbmFibGUgdXBwZXIgbGltaXRcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBJbi1tZW1vcnkgY2FjaGUgc2VydmljZSBpbXBsZW1lbnRhdGlvblxuICovXG5cbmltcG9ydCB7IENhY2hlU2VydmljZSB9IGZyb20gJy4uLy4uL3R5cGVzL3R5cGVzJztcblxuaW50ZXJmYWNlIENhY2hlSXRlbTxUPiB7XG4gICAgZGF0YTogVDtcbiAgICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgICB0dGw/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNZW1vcnlDYWNoZVNlcnZpY2UgaW1wbGVtZW50cyBDYWNoZVNlcnZpY2Uge1xuICAgIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgQ2FjaGVJdGVtPGFueT4+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBkZWZhdWx0VFRMID0gMzAwMDAwOyAvLyA1IG1pbnV0ZXNcbiAgICBwcml2YXRlIGxhc3RDbGVhbnVwID0gMDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IENMRUFOVVBfSU5URVJWQUwgPSA2MDAwMDsgLy8gMSBtaW51dGVcblxuICAgIC8qKlxuICAgICAqIEdldCBpdGVtIGZyb20gY2FjaGUgKG9wdGltaXplZCB3aXRoIGxhenkgY2xlYW51cClcbiAgICAgKi9cbiAgICBnZXQ8VD4oa2V5OiBzdHJpbmcpOiBUIHwgbnVsbCB7XG4gICAgICAgIC8vIExhenkgY2xlYW51cCB0cmlnZ2VyIHRvIGF2b2lkIGZyZXF1ZW50IGl0ZXJhdGlvbnNcbiAgICAgICAgaWYgKHRoaXMuY2FjaGUuc2l6ZSA+IDUwKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaXRlbSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgaXRlbSBoYXMgZXhwaXJlZFxuICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpdGVtLmRhdGEgYXMgVDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgaXRlbSBpbiBjYWNoZVxuICAgICAqL1xuICAgIHNldDxUPihrZXk6IHN0cmluZywgZGF0YTogVCwgdHRsPzogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwge1xuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIHR0bFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgY2FjaGUgaXRlbXNcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jYWNoZS5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBzcGVjaWZpYyBjYWNoZSBpdGVtXG4gICAgICovXG4gICAgZGVsZXRlKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGtleSBleGlzdHMgaW4gY2FjaGVcbiAgICAgKi9cbiAgICBoYXMoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgZXhwaXJlZFxuICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY2FjaGUgc2l6ZVxuICAgICAqL1xuICAgIHNpemUoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGUuc2l6ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBleHBpcmVkIGl0ZW1zIChvcHRpbWl6ZWQgd2l0aCBiYXRjaGVkIG9wZXJhdGlvbnMpXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRocm90dGxlIGNsZWFudXAgdG8gYXZvaWQgZnJlcXVlbnQgaXRlcmF0aW9uc1xuICAgICAgICBpZiAobm93IC0gdGhpcy5sYXN0Q2xlYW51cCA8IHRoaXMuQ0xFQU5VUF9JTlRFUlZBTCkgcmV0dXJuO1xuICAgICAgICB0aGlzLmxhc3RDbGVhbnVwID0gbm93O1xuXG4gICAgICAgIC8vIEJhdGNoIGRlbGV0ZSBvcGVyYXRpb25zIChtb3JlIGVmZmljaWVudCB0aGFuIGluZGl2aWR1YWwgZGVsZXRlcylcbiAgICAgICAgY29uc3QgZXhwaXJlZEtleXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGl0ZW1dIG9mIHRoaXMuY2FjaGUuZW50cmllcygpKSB7XG4gICAgICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgICAgICBpZiAobm93IC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgICAgICBleHBpcmVkS2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNpbmdsZSBiYXRjaCBvcGVyYXRpb25cbiAgICAgICAgZXhwaXJlZEtleXMuZm9yRWFjaChrZXkgPT4gdGhpcy5jYWNoZS5kZWxldGUoa2V5KSk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU2VydmljZSBjb250YWluZXIgZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgXG4gICAgU2VydmljZUNvbnRhaW5lciBhcyBJU2VydmljZUNvbnRhaW5lciwgXG4gICAgWW91VHViZVBsdWdpblNldHRpbmdzLCBcbiAgICBBSVNlcnZpY2UgYXMgSUFJU2VydmljZSxcbiAgICBWaWRlb0RhdGFTZXJ2aWNlLFxuICAgIEZpbGVTZXJ2aWNlLFxuICAgIENhY2hlU2VydmljZSxcbiAgICBQcm9tcHRTZXJ2aWNlXG59IGZyb20gJy4uL3R5cGVzL3R5cGVzJztcblxuaW1wb3J0IHsgQUlTZXJ2aWNlIH0gZnJvbSAnLi9haS1zZXJ2aWNlJztcbmltcG9ydCB7IEdlbWluaVByb3ZpZGVyIH0gZnJvbSAnLi8uLi9nZW1pbmknO1xuaW1wb3J0IHsgR3JvcVByb3ZpZGVyIH0gZnJvbSAnLi8uLi9ncm9xJztcbmltcG9ydCB7IFlvdVR1YmVWaWRlb1NlcnZpY2UgfSBmcm9tICcuLy4uL3ZpZGVvLWRhdGEnO1xuaW1wb3J0IHsgT2JzaWRpYW5GaWxlU2VydmljZSB9IGZyb20gJy4vLi4vb2JzaWRpYW4tZmlsZSc7XG5pbXBvcnQgeyBBSVByb21wdFNlcnZpY2UgfSBmcm9tICcuL3Byb21wdC1zZXJ2aWNlJztcbmltcG9ydCB7IE1lbW9yeUNhY2hlU2VydmljZSB9IGZyb20gJy4vY2FjaGUvbWVtb3J5LWNhY2hlJztcblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VDb250YWluZXIgaW1wbGVtZW50cyBJU2VydmljZUNvbnRhaW5lciB7XG4gICAgcHJpdmF0ZSBfYWlTZXJ2aWNlPzogSUFJU2VydmljZTtcbiAgICBwcml2YXRlIF92aWRlb1NlcnZpY2U/OiBWaWRlb0RhdGFTZXJ2aWNlO1xuICAgIHByaXZhdGUgX2ZpbGVTZXJ2aWNlPzogRmlsZVNlcnZpY2U7XG4gICAgcHJpdmF0ZSBfY2FjaGVTZXJ2aWNlPzogQ2FjaGVTZXJ2aWNlO1xuICAgIHByaXZhdGUgX3Byb21wdFNlcnZpY2U/OiBQcm9tcHRTZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyxcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcFxuICAgICkge31cblxuICAgIGdldCBhaVNlcnZpY2UoKTogSUFJU2VydmljZSB7XG4gICAgICAgIGlmICghdGhpcy5fYWlTZXJ2aWNlKSB7XG4gICAgICAgICAgICBjb25zdCBwcm92aWRlcnM6IGFueVtdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBHZW1pbmkgcHJvdmlkZXIgaWYgQVBJIGtleSBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSkge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVycy5wdXNoKG5ldyBHZW1pbmlQcm92aWRlcih0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgR3JvcSBwcm92aWRlciBpZiBBUEkga2V5IGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleSkge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVycy5wdXNoKG5ldyBHcm9xUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuX2FpU2VydmljZSA9IG5ldyBBSVNlcnZpY2UocHJvdmlkZXJzLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWlTZXJ2aWNlO1xuICAgIH1cblxuICAgIGdldCB2aWRlb1NlcnZpY2UoKTogVmlkZW9EYXRhU2VydmljZSB7XG4gICAgICAgIGlmICghdGhpcy5fdmlkZW9TZXJ2aWNlKSB7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1NlcnZpY2UgPSBuZXcgWW91VHViZVZpZGVvU2VydmljZSh0aGlzLmNhY2hlU2VydmljZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZGVvU2VydmljZTtcbiAgICB9XG5cbiAgICBnZXQgZmlsZVNlcnZpY2UoKTogRmlsZVNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX2ZpbGVTZXJ2aWNlKSB7XG4gICAgICAgICAgICB0aGlzLl9maWxlU2VydmljZSA9IG5ldyBPYnNpZGlhbkZpbGVTZXJ2aWNlKHRoaXMuYXBwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fZmlsZVNlcnZpY2U7XG4gICAgfVxuXG4gICAgZ2V0IGNhY2hlU2VydmljZSgpOiBDYWNoZVNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX2NhY2hlU2VydmljZSkge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVTZXJ2aWNlID0gbmV3IE1lbW9yeUNhY2hlU2VydmljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZVNlcnZpY2UhO1xuICAgIH1cblxuICAgIGdldCBwcm9tcHRTZXJ2aWNlKCk6IFByb21wdFNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX3Byb21wdFNlcnZpY2UpIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb21wdFNlcnZpY2UgPSBuZXcgQUlQcm9tcHRTZXJ2aWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb21wdFNlcnZpY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNldHRpbmdzIGFuZCByZWZyZXNoIHNlcnZpY2VzIHRoYXQgZGVwZW5kIG9uIHRoZW1cbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVTZXR0aW5ncyhuZXdTZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXdTZXR0aW5ncztcbiAgICAgICAgLy8gUmVzZXQgQUkgc2VydmljZSB0byBwaWNrIHVwIG5ldyBBUEkga2V5c1xuICAgICAgICB0aGlzLl9haVNlcnZpY2UgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIGNhY2hlZCBzZXJ2aWNlc1xuICAgICAqL1xuICAgIGNsZWFyU2VydmljZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2FpU2VydmljZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fdmlkZW9TZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9maWxlU2VydmljZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY2FjaGVTZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9wcm9tcHRTZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBSWEsY0F1QkE7QUEzQmI7QUFBQTtBQUlPLElBQU0sZUFBZTtBQUFBLE1BQ3hCLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxNQUNULFFBQVE7QUFBQSxRQUNKLGNBQWM7QUFBQSxRQUNkLE9BQU87QUFBQSxNQUNYO0FBQUEsTUFDQSxTQUFTO0FBQUEsUUFDTCxjQUFjO0FBQUEsUUFDZCxZQUFZO0FBQUEsTUFDaEI7QUFBQSxNQUNBLGlCQUFpQjtBQUFBLFFBQ2IsV0FBVztBQUFBLFFBQ1gsU0FBUztBQUFBLFFBQ1QsS0FBSztBQUFBLFFBQ0wsZ0JBQWdCO0FBQUEsTUFDcEI7QUFBQSxNQUNBLFFBQVE7QUFBQSxRQUNKLFNBQVM7QUFBQSxRQUNULFVBQVU7QUFBQSxNQUNkO0FBQUEsSUFDSjtBQUVPLElBQU0sZUFBZTtBQUFBLE1BQ3hCLE9BQU87QUFBQSxNQUNQLFdBQVc7QUFBQSxNQUNYLFNBQVM7QUFBQSxNQUNULFFBQVE7QUFBQSxNQUNSLGNBQWM7QUFBQSxJQUNsQjtBQUFBO0FBQUE7OztBQ2pDQSxJQU9hO0FBUGI7QUFBQTtBQUlBO0FBR08sSUFBTSxXQUFOLE1BQTRDO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFJL0MsT0FBTyxZQUFZLFNBQXNCLFFBQTJCO0FBQ2hFLGVBQU8sT0FBTyxRQUFRLE9BQU8sTUFBTTtBQUFBLE1BQ3ZDO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFLQSxPQUFPLHNCQUFzQixRQUFxQztBQUM5RCxjQUFNLFlBQVksT0FBTyxVQUFVO0FBQ25DLGFBQUssWUFBWSxXQUFXLGFBQWEsZUFBZTtBQUN4RCxlQUFPO0FBQUEsTUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BS0EsT0FBTyxtQkFDSCxX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QU8sZUFBZSxLQUFLLHdCQUF3QixDQUFDLEVBQUUsU0FBUyxVQUFVLE1BQU07QUFDL0UsYUFBSyxLQUFLLGlCQUFpQixJQUFJO0FBQUEsTUFDbkM7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyxxQkFBcUIsYUFBbUQ7QUE3b0IxRjtBQThvQlEsUUFBSTtBQUNBLFdBQUssV0FBVyxFQUFFLEdBQUcsWUFBWTtBQUNqQyxZQUFNLEtBQUssYUFBYTtBQUN4QixjQUFNLFVBQUsscUJBQUwsbUJBQXVCLGVBQWUsS0FBSztBQUFBLElBQ3JELFNBQVMsT0FBUDtBQUNFLG1CQUFhLE9BQU8sT0FBZ0IsaUJBQWlCO0FBQ3JELFlBQU07QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyxlQUE4QjtBQUN4QyxTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzdFO0FBQUEsRUFFQSxNQUFjLGVBQThCO0FBQ3hDLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxzQkFBb0Q7QUFDaEQsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFBQSxFQUVRLFFBQVEsU0FBdUI7QUFDbkMsdUJBQW1CLElBQUksVUFBVSxTQUFTO0FBQUEsRUFDOUM7QUFBQSxFQUVRLFdBQVcsU0FBdUI7QUFDdEMsdUJBQW1CLElBQUksVUFBVSxXQUFXLE1BQU07QUFBQSxFQUN0RDtBQUFBLEVBRVEsU0FBUyxTQUFpQixPQUFvQjtBQUNsRCx1QkFBbUIsSUFBSSxXQUFXLFlBQVksTUFBTSxXQUFXLE9BQU87QUFBQSxFQUMxRTtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiQ29uZmlybWF0aW9uTW9kYWwiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgImltcG9ydF9vYnNpZGlhbiIsICJfYSJdCn0K
